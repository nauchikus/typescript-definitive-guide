<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="description" content="Подробная документация и книга в одном по языку TypeScript."/><meta name="og:title" content="TDG-подробное руководство по языку TypeScript"/><meta name="og:description" content="Подробная документация и книга в одном по языку TypeScript."/><meta name="og:type" content="website"/><meta name="twitter:card" content="summary"/><meta name="twitter:creator" content="nauchikus"/><meta name="twitter:title" content="TDG-подробное руководство по языку TypeScript"/><meta name="twitter:description" content="Подробная документация и книга в одном по языку TypeScript."/><meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, user-scalable=no"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><script async="" type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><title>TDG-подробное руководство по языку TypeScript</title><meta name="description" content="Типизированные хуки"/><meta name="og:title" content="TDG-подробное руководство по языку TypeScript"/><meta name="og:description" content="Типизированные хуки"/><meta name="og:type" content="website"/><meta name="twitter:card" content="summary"/><meta name="twitter:creator" content="nauchikus"/><meta name="twitter:title" content="TDG-подробное руководство по языку TypeScript"/><meta name="twitter:description" content="Типизированные хуки"/><meta name="next-head-count" content="7"/><link rel="preload" href="/_next/static/css/48b3a72d7930fb66ae91.css" as="style"/><link rel="stylesheet" href="/_next/static/css/48b3a72d7930fb66ae91.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-0e3c274fd8419109d37b.js" defer=""></script><script src="/_next/static/chunks/framework-2f612445bd50b211f15a.js" defer=""></script><script src="/_next/static/chunks/main-7096870a72703e216a95.js" defer=""></script><script src="/_next/static/chunks/pages/_app-cc0eb0c7583520f375a7.js" defer=""></script><script src="/_next/static/chunks/452-2343a28788c03f958a4e.js" defer=""></script><script src="/_next/static/chunks/950-86a83352b01b7466f89f.js" defer=""></script><script src="/_next/static/chunks/222-f79b6bb9bf6211af52b8.js" defer=""></script><script src="/_next/static/chunks/460-cf93e771b3da01004124.js" defer=""></script><script src="/_next/static/chunks/763-b007244d3307e1e9232d.js" defer=""></script><script src="/_next/static/chunks/211-d4969ecab0eef9742617.js" defer=""></script><script src="/_next/static/chunks/292-c1729ae84d688b6cecb9.js" defer=""></script><script src="/_next/static/chunks/pages/book/chapters/%5BchapterId%5D-4d0f190399df2fda59ad.js" defer=""></script><script src="/_next/static/LQJahi8Ij0C55Zfw8IHrX/_buildManifest.js" defer=""></script><script src="/_next/static/LQJahi8Ij0C55Zfw8IHrX/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="base-layout"><div></div><header class="app-header app-header-grid"><div class="app-header-grid-item__driver-toggle"><button class="app-driver-toggle-btn"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="svg-icon"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M3 21h18v-2H3v2zM3 8v8l4-4-4-4zm8 9h10v-2H11v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z"></path></svg></button></div><div class="app-header-grid-item__logo"><span role="img" tabindex="-1" class="anticon app-logo"><svg id="logo_app_svg__Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 118.08 43.32" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><defs><style>.logo_app_svg__cls-2{fill:#1d1d1b}</style></defs><path d="M38.56 3.3v8H26v33.6h-9.34V11.28H4.12v-8z" transform="translate(-4.12 -2.34)" fill="#3273b9"></path><path class="logo_app_svg__cls-2" d="M81 24.06a24.31 24.31 0 01-1.68 9.42 17.45 17.45 0 01-4.77 6.66 20.38 20.38 0 01-7.52 4 35 35 0 01-10 1.32q-2.53 0-5.88-.21a48 48 0 01-6.61-.87V3.84A55.14 55.14 0 0151.3 3c2.34-.14 4.36-.21 6-.21A36.41 36.41 0 0167 4a19.87 19.87 0 017.5 3.8 16.88 16.88 0 014.79 6.6A25 25 0 0181 24.06zm-27 13.2q.64.06 1.53.09h2.06q7 0 10.41-3.54t3.39-9.78q0-6.54-3.23-9.9T57.81 10.8h-2a18.29 18.29 0 00-1.91.15zM109.05 10.5q-6.54 0-9.45 3.63t-2.91 9.93a19.58 19.58 0 00.73 5.55 12 12 0 002.15 4.29 9.73 9.73 0 003.6 2.79 12 12 0 005 1q1.56 0 2.67-.06a12.66 12.66 0 002-.24V22.92h9.36V43.5a35.26 35.26 0 01-5.4 1.41 47.42 47.42 0 01-9.18.75 23.76 23.76 0 01-8.48-1.44A17.79 17.79 0 0192.61 40a18.75 18.75 0 01-4.17-6.78A26.63 26.63 0 0187 24.06a24.58 24.58 0 011.62-9.24A19.9 19.9 0 0193 8a18.67 18.67 0 016.64-4.23 22.75 22.75 0 018.12-1.44 32.88 32.88 0 015.31.39 33.5 33.5 0 014.08.9 18.93 18.93 0 012.82 1q1.11.54 1.59.84l-2.7 7.5a24.4 24.4 0 00-4.41-1.77 18.76 18.76 0 00-5.4-.69z" transform="translate(-4.12 -2.34)"></path></svg></span></div><div class="app-header-grid-item__search"><form class="search" autoComplete="off" action="#"><button class="search__submit-button-placeholder button-with-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="svg-icon search__search-svg-icon"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></button><input type="search" class="search__query-input" id="algolia-search" name="app-search-query" placeholder="search..." required=""/></form></div><div class="app-header-grid-item__secondary-bar"><nav class="app-link-bar"><ul class="menu app-link-bar__menu"><li><a class="link svg-link-btn app-link-bar__icon-btn" href="https://t.me/nauchikus" title="Следить за выходом новых версий в Telegram" target="_blank"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414" class="svg-icon"><path d="M18.384 22.779a1.19 1.19 0 001.107.145 1.16 1.16 0 00.724-.84C21.084 18 23.192 7.663 23.983 3.948a.78.78 0 00-.26-.758.8.8 0 00-.797-.14C18.733 4.602 5.82 9.447.542 11.4a.827.827 0 00-.542.799c.012.354.25.661.593.764 2.367.708 5.474 1.693 5.474 1.693s1.452 4.385 2.209 6.615c.095.28.314.5.603.576a.866.866 0 00.811-.207l3.096-2.923s3.572 2.619 5.598 4.062zm-11.01-8.677l1.679 5.538.373-3.507 10.185-9.186a.277.277 0 00.033-.377.284.284 0 00-.376-.064L7.374 14.102z"></path></svg></a></li><li><a class="link svg-link-btn app-link-bar__icon-btn" href="https://github.com/nauchikus/typescript-definitive-guide" title="Посетить Github" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="svg-icon app-link-bar__github-svg-icon"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"></path></svg></a></li></ul></nav></div><div class="app-header-grid-item__primary-bar"><div class="dropdown app-nav__dropdown"><button class="dropdown__toggle app-nav__dropdown-toggle_adaptive"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="svg-icon"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg></button><div class="dropdown__menu app-nav__dropdown-menu_adaptive"><div class="flat-panel"><div class="app-nav__link-bar app-nav__link-bar_adaptive"><nav class="app-link-bar"><ul class="menu app-link-bar__menu"><li><a class="link svg-link-btn app-link-bar__icon-btn" href="https://t.me/nauchikus" title="Следить за выходом новых версий в Telegram" target="_blank"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414" class="svg-icon"><path d="M18.384 22.779a1.19 1.19 0 001.107.145 1.16 1.16 0 00.724-.84C21.084 18 23.192 7.663 23.983 3.948a.78.78 0 00-.26-.758.8.8 0 00-.797-.14C18.733 4.602 5.82 9.447.542 11.4a.827.827 0 00-.542.799c.012.354.25.661.593.764 2.367.708 5.474 1.693 5.474 1.693s1.452 4.385 2.209 6.615c.095.28.314.5.603.576a.866.866 0 00.811-.207l3.096-2.923s3.572 2.619 5.598 4.062zm-11.01-8.677l1.679 5.538.373-3.507 10.185-9.186a.277.277 0 00.033-.377.284.284 0 00-.376-.064L7.374 14.102z"></path></svg></a></li><li><a class="link svg-link-btn app-link-bar__icon-btn" href="https://github.com/nauchikus/typescript-definitive-guide" title="Посетить Github" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="svg-icon app-link-bar__github-svg-icon"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"></path></svg></a></li></ul></nav></div><div class="divide-full_x app-nav__divide_adaptive"></div><div class="app-nav__nav"><nav class="app-nav"><ul class="menu app-nav__menu_adaptive"><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/">Главная</a></li><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/book/chapters/">Оглавление</a></li><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/what-is-new/">Что нового?</a></li><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/pdf/">Скачать Pdf</a></li></ul></nav></div></div></div></div></div></header><div class="layer slide-layer" toggle="false"><div class="slide-layer__driver"><div class="slide-layer__fixed-driver"><div class="driver"><div class="layer driver-content-nav"><ul class="ant-menu ant-menu-root ant-menu-inline ant-menu-light driver-content-nav__menu" role="menu" tabindex="0" data-menu-list="true"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="none"><div role="menuitem" style="padding-left:24px" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="true" aria-haspopup="true"><span class="ant-menu-title-content">Содержание</span><i class="ant-menu-submenu-arrow"></i></div><ul class="ant-menu ant-menu-sub ant-menu-inline" data-menu-list="true"><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Tipizirovannye_huki/#Predopredelennye_huki_-_useState%3CT%3E()">Предопределенные хуки - useState&lt;T&gt;()</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Tipizirovannye_huki/#Predopredelennye_huki_-_useEffect()_i_useLayoutEffect()">Предопределенные хуки - useEffect() и useLayoutEffect()</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Tipizirovannye_huki/#Predopredelennye_huki_-_useContext%3CT%3E()">Предопределенные хуки - useContext&lt;T&gt;()</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Tipizirovannye_huki/#Predopredelennye_huki_-_useReducer%3CR%3E()">Предопределенные хуки - useReducer&lt;R&gt;()</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Tipizirovannye_huki/#Predopredelennye_huki_-_useCallback%3CT%3E()">Предопределенные хуки - useCallback&lt;T&gt;()</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Tipizirovannye_huki/#Predopredelennye_huki_-_useRef%3CT%3E()">Предопределенные хуки - useRef&lt;T&gt;()</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Tipizirovannye_huki/#Predopredelennye_huki_-_useImperativeHandle%3CT,R%3E()">Предопределенные хуки - useImperativeHandle&lt;T, R&gt;()</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Tipizirovannye_huki/#Predopredelennye_huki_-_useMemo%3CT%3E()">Предопределенные хуки - useMemo&lt;T&gt;()</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Tipizirovannye_huki/#Predopredelennye_huki_-_useDebugValue%3CT%3E()">Предопределенные хуки - useDebugValue&lt;T&gt;()</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Tipizirovannye_huki/#Polzovatelskii_huk">Пользовательский хук</a></span></li></ul></li></ul><div style="display:none" aria-hidden="true"></div></div></div></div></div><div class="slide-layer__first-empty"></div><div class="slide-layer__content"><div class="content-box"><div class="content-box__page-nav content-box__page-nav_left"><div class="page-nav__bar page-nav__bar_left"><button type="button" class="ant-btn ant-btn-primary ant-btn-icon-only page-nav__btn"><span role="img" aria-label="left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></span></button></div></div><main id="content" class="content-box__html"><aside><div class="github-file-info-bar"><div class="github-file-info-bar__section github-file-info-bar__section_contributors"><span class="github-file-info-bar__label">Контрибьютеры</span><div class="ant-avatar-group"><a href="https://github.com/nauchikus" target="_blank" class="ant-btn ant-btn-circle github-file-info-bar__avatar-btn"><span class="ant-avatar ant-avatar-circle ant-avatar-image"><img src="https://avatars.githubusercontent.com/u/31518738?v=4"/></span></a></div></div><div class="github-file-info-bar__section github-file-info-bar__section_update-info"><span class="github-file-info-bar__label">Обновлено</span><span class="github-file-info-bar__label_date">4/6/2021</span></div></div></aside><section id="Tipizirovannye_huki" class="content__section"><h1 class="content__heading">Типизированные хуки</h1>
<p><em>React</em> <em>api</em> насчитывает десять предопределенных хуков большинство которых являются универсальными. Каждый из них будет рассмотрен по отдельности. Кроме того, данная глава будет посвящена определению пользовательских хуков с учетом последних возможностей <em>TypeScript</em>.</p></section><section id="Predopredelennye_huki_-_useState&lt;T&gt;()" class="content__section"><h2 class="content__heading">Предопределенные хуки - useState<!-- -->&lt;T&gt;<!-- -->()</h2>
<p>Рассмотрение данной темы стоит начать с самого часто применяемого универсального хука <code class="content__code_inline">useState&lt;T&gt;(initialState): [state, dispatch]</code> параметр типа которого представляет определяемое им состояние. В случаях когда при вызове универсальной функции <code class="content__code_inline">useState&lt;T&gt;(initialState)</code> аргумент типа не устанавливается, тип значения будет выведен на основе аргумента функции обозначаемого <code class="content__code_inline">initialState</code>. Это в свою очередь означает, что при отсутствии инициализационного значения (вызов функции <code class="content__code_inline">useState</code> без значения) или его временном замещении значением принадлежащим к другому типу (например объектный тип замещается значением <code class="content__code_inline">null</code>), или частичном значении (объектный тип определяющий лишь часть своих членов), изменить его в будущем с помощью функции обозначаемой <code class="content__code_inline">dispatch</code> будет невозможно, поскольку она при определении также ассоциируется с выведенным на основе <code class="content__code_inline">initialState</code> типом.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                              </span><span class="token doc-comment" style="color:slategray">/**[0][1] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error -&gt; type 0 is not type undefined</span><span>
</span>
<span>    </span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray">     * Поскольку отсутствие initialState [1] не было
</span><span class="token doc-comment" style="color:slategray">     * компенсировано аргументом типа [0] невозможно
</span><span class="token doc-comment" style="color:slategray">     * установит новое значение с помощью функции dispatch
</span><span class="token doc-comment" style="color:slategray">     * если оно принадлежит к типу отличному от выведенного
</span><span class="token doc-comment" style="color:slategray">     * в момент определения.
</span><span class="token doc-comment" style="color:slategray">     */</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">B</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                               </span><span class="token doc-comment" style="color:slategray">/**[0][1] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span> a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error -&gt; type {a: number} is not type null</span><span>
</span>
<span>    </span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray">    * Поскольку initialState [1] принадлежит к типу null
</span><span class="token doc-comment" style="color:slategray">    * и отсутствует уточнение типа состояния при помощи
</span><span class="token doc-comment" style="color:slategray">    * аргумента типа [0], то будет невозможно установить новое
</span><span class="token doc-comment" style="color:slategray">    * значение с помощью функции dispatch если оно принадлежит
</span><span class="token doc-comment" style="color:slategray">    * к типу отличному от выведенного в момент определения.
</span><span class="token doc-comment" style="color:slategray">    */</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> С</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                               </span><span class="token doc-comment" style="color:slategray">/**[0] [1] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span> a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error -&gt; type {a: number, b: string} is not type {a: number}</span><span>
</span>
<span>    </span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray">    * Поскольку initialState [1] представляет из себя лишь 
</span><span class="token doc-comment" style="color:slategray">    * часть от предполагаемого типа и при этом отсутствует
</span><span class="token doc-comment" style="color:slategray">    * уточнение типа состояния при помощи
</span><span class="token doc-comment" style="color:slategray">    * аргумента типа [0], то будет невозможно установить новое
</span><span class="token doc-comment" style="color:slategray">    * значение с помощью функции dispatch если оно принадлежит
</span><span class="token doc-comment" style="color:slategray">    * к типу отличному от выведенного в момент определения.
</span><span class="token doc-comment" style="color:slategray">    */</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>В подобных случаях необходимо уточнить тип к которому принадлежит состояние при помощи аргумента типа. Единственное нужно помнить, что несмотря на уточнение типа, при отсутствии <code class="content__code_inline">initialState</code>, состояние будет принадлежать к объединению <code class="content__code_inline">T | undefined</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token generic-function" style="color:#DD4A68">useState</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic" style="color:#690">number</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span>    state</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// number | undefined</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">B</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                                              </span><span class="token doc-comment" style="color:slategray">/**[*] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token generic-function" style="color:#DD4A68">useState</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic" style="color:#999">{</span><span class="token generic-function generic" style="color:#DD4A68">a</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic" style="color:#690">number</span><span class="token generic-function generic" style="color:#999">}</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic null nil" style="color:#07a">null</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span> a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span>    state</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// {a: number} | null</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> С</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                                             </span><span class="token doc-comment" style="color:slategray">/**[*] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token generic-function" style="color:#DD4A68">useState</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic" style="color:#999">{</span><span class="token generic-function generic" style="color:#DD4A68">a</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic" style="color:#690">number</span><span class="token generic-function generic" style="color:#999">;</span><span class="token generic-function generic" style="color:#DD4A68"> b</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic" style="color:#690">string</span><span class="token generic-function generic" style="color:#999">;</span><span class="token generic-function generic" style="color:#999">}</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span> a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span>    state</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// {a: number; b?: string | undefined}</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [*] конкретизация типа
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Все описанные случаи так или иначе предполагают дополнительные проверки на существование значения, которые на практике отягощают код. Поэтому при отсутствии конкретного состояния выступающего в роли аргумента универсальной функции, всегда лучше устанавливать значение по умолчанию в полной мере соответствующего типу, нежели допускать его отсутствие, замещение или частичную установку.</p>
<p>При условии, что <code class="content__code_inline">initialState</code> представлен значением в полной мере соответствующим требуемому типу, необходимость в уточнении с помощью аргумента типа пропадает, поскольку выводу типов не составит особого труда справиться самостоятельно. Простыми словами, если аргумент типа не устанавливается, его тип выводится на основе типа к которому принадлежит аргумент вызываемой функции. В случае, когда состояние в полной мере устанавливается в качестве единственного аргумента хука <code class="content__code_inline">useState&lt;T&gt;()</code> необходимости в уточнении типа, при помощи аргумента функционального типа, не требуется. Если в качестве значения выступает примитив или объект, все члены которого инициализированны, вывод типов будет только рад взять работу по установлению типа на себя.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span>    state</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// number</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">B</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span> a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span>    state</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// {a: number}</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> С</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span> a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span>    state</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// {a: number; b: string;}</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><section id="Predopredelennye_huki_-_useEffect()_i_useLayoutEffect()" class="content__section"><h2 class="content__heading">Предопределенные хуки - useEffect() и useLayoutEffect()</h2>
<p>Следующими на очереди расположились сразу два идентичных с точки зрения типизации хука <code class="content__code_inline">useEffect(effect, deps?): void</code> и <code class="content__code_inline">useLayoutEffect(effect, deps?): void</code>, ожидающие в качестве первого параметра функцию, а в качестве второго необязательного параметра, массив, изменение элементов которого приводит к повторному вызову первого аргумента. Поскольку у данных хуков отсутствует возвращаемое значение, сложно представить сценарий в котором возникает ошибка связанная с передачей аргументов. Поэтому подробное рассмотрение и пояснение будет опущено.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">useEffect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#DD4A68">useLayoutEffect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><section id="Predopredelennye_huki_-_useContext&lt;T&gt;()" class="content__section"><h2 class="content__heading">Предопределенные хуки - useContext<!-- -->&lt;T&gt;<!-- -->()</h2>
<p>Следующий претендент на рассмотрение предназначен для работы с контекстом и является универсальной функцией <code class="content__code_inline">useContext&lt;T&gt;(context)</code> принимающей в качестве аргумента объект контекста, который при необходимости можно уточнить с помощью аргумента типа. Поскольку вывод типов в состоянии самостоятельно вывести тип опираясь на обязательный параметр <code class="content__code_inline">context</code>, то уточнение типа с помощью аргумента типа не требуется.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>createContext</span><span class="token" style="color:#999">,</span><span> useContext</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">StringContext</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">createContext</span><span class="token" style="color:#999">(</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">Is Context Value!</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> context </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useContext</span><span class="token" style="color:#999">(</span><span class="token maybe-class-name">StringContext</span><span> </span><span class="token" style="color:slategray">// let context: string</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Уточнение с помощью аргумента типа может потребоваться только при необходимости приведения более общего типа к более конкретному. Но в реальности универсальная функция этого не позволяет сделать.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>createContext</span><span class="token" style="color:#999">,</span><span> useContext</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token" style="color:#905">T0</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token" style="color:#905">T1</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span>       </span><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token" style="color:#905">T2</span><span> </span><span class="token" style="color:#07a">extends</span><span> </span><span class="token" style="color:#905">T0</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">T1</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [0] более общий тип
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">let</span><span> contextDefaultValue</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">T2</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span>
</span><span>    b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">StringContext</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">createContext</span><span class="token" style="color:#999">(</span><span>contextDefaultValue</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// const StringContext: React.Context&lt;T2&gt;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> c0 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useContext</span><span class="token" style="color:#999">(</span><span class="token maybe-class-name">StringContext</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// let c0: T2</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> c1 </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token generic-function" style="color:#DD4A68">useContext</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic" style="color:#905">T0</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span class="token maybe-class-name">StringContext</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error -&gt; [1]</span><span>
</span>
<span>    </span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray">     * [1] при попытке приведения более общего типа
</span><span class="token doc-comment" style="color:slategray">     * T2 к более конкретному типу T0 возникает ошибка -&gt;
</span><span class="token doc-comment" style="color:slategray">     * Argument of type &#x27;Context&lt;T2&gt;&#x27; is not assignable
</span><span class="token doc-comment" style="color:slategray">     * to parameter of type &#x27;Context&lt;T0&gt;&#x27;.
</span><span class="token doc-comment" style="color:slategray">     */</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>При возникновении потребности в подобном приведении конкретизировать необходимо идентификатор ассоциированный со значением, то есть переменную.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> c2</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">T0</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useContext</span><span class="token" style="color:#999">(</span><span class="token maybe-class-name">StringContext</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok -&gt; let c2: T0</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><section id="Predopredelennye_huki_-_useReducer&lt;R&gt;()" class="content__section"><h2 class="content__heading">Предопределенные хуки - useReducer<!-- -->&lt;R&gt;<!-- -->()</h2>
<p>Следующий в списке предопределенных хуков расположился <code class="content__code_inline">useReducer&lt;R&gt;(reducer, initialState, stateInit):[state, dispatch]</code> представленный универсальной функцией имеющей множество перегрузок. Чтобы познакомится с каждым из параметров данной функции, для начала, нам потребуется объявить два типа описывающих состояние (<code class="content__code_inline">state</code>) и инициализационное состояние (<code class="content__code_inline">initialState</code>), которое специально будет отличаться от обычного, что бы преобразовать его при помощи функции обозначенной как <code class="content__code_inline">stateInit</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">InitialState</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>    age</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>    gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">female</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">notSpecified</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token doc-comment" style="color:slategray">/**[1] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">State</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>    gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">female</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">notSpecified</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * Объявление интерфейсов описывающих
</span><span class="token doc-comment" style="color:slategray"> * состояние [1] и инициализационное состояние [0].
</span><span class="token doc-comment" style="color:slategray"> * 
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Затем определим функцию <code class="content__code_inline">reducer</code> для описания сигнатуры которой воспользуемся импортированным их пространства имен <em>React</em> обобщенным типом <code class="content__code_inline">Reducer&lt;S, A&gt;</code> ожидающего в качестве первого аргумента типа тип описывающий <code class="content__code_inline">state</code>, а в качестве второго тип описывающий действие <code class="content__code_inline">Action</code>. В нашем примере второй аргумент типа <code class="content__code_inline">Reducer&lt;S, A&gt;</code> будет представлен псевдонимом для двух конкретных типов действий, перед объявлением которых стоит обратить внимание на один относящийся к ним тонкий момент. Тонкость заключается в том, что функция-редюсер, в качестве второго параметра, может, и в большинстве случаев будет принимать объекты действий принадлежащих к разным типам. Для их конкретизации выводу типов потребуется помощь в виде дискриминантных полей.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>useReducer</span><span class="token" style="color:#999">,</span><span> </span><span class="token maybe-class-name">Reducer</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">InitialState</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>    gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>    gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">female</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">notSpecified</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">State</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>    gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">female</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">notSpecified</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span></span><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span></span><span class="token" style="color:#07a">enum</span><span> </span><span class="token maybe-class-name">ActionType</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token maybe-class-name">Name</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">name</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token maybe-class-name">Gender</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">gender</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [0] определение перечисления содержащего
</span><span class="token doc-comment" style="color:slategray"> * константы необходимые для конкретизации типа
</span><span class="token doc-comment" style="color:slategray"> * Action.
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<!-- -->
<span>            </span><span class="token doc-comment" style="color:slategray">/**[1] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">NameAction</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Name</span><span class="token" style="color:#999">;</span><span> </span><span class="token doc-comment" style="color:slategray">/**[2] */</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span> </span><span class="token doc-comment" style="color:slategray">/**[3] */</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span>            </span><span class="token doc-comment" style="color:slategray">/**[1] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">GenderAction</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Gender</span><span class="token" style="color:#999">;</span><span> </span><span class="token doc-comment" style="color:slategray">/**[2] */</span><span>
</span><span>    gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">female</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">notSpecified</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span> </span><span class="token doc-comment" style="color:slategray">/**[3] */</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [1] объявление более конкретных типов действий
</span><span class="token doc-comment" style="color:slategray"> * объявляющий поля name и gender [3] и дискриминантное
</span><span class="token doc-comment" style="color:slategray"> * поле type [2] в качестве типа которого указан элемент
</span><span class="token doc-comment" style="color:slategray"> * перечисления.
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<!-- -->
<span></span><span class="token doc-comment" style="color:slategray">/**[4] */</span><span>
</span><span></span><span class="token" style="color:#07a">type</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Actions</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token maybe-class-name">NameAction</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token maybe-class-name">GenderAction</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [4] объявление псевдонима ссылающегося на
</span><span class="token doc-comment" style="color:slategray"> * тип объединение представленный типами Action.
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<!-- -->
<span>     </span><span class="token doc-comment" style="color:slategray">/**[5]      [6]    [7]     [8]            [9]     [10] */</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> reducer</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">Reducer</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">State</span><span class="token" style="color:#999">,</span><span> </span><span class="token maybe-class-name">Actions</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>state</span><span class="token" style="color:#999">,</span><span> action</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                </span><span class="token doc-comment" style="color:slategray">/**[11] */</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">if</span><span class="token" style="color:#999">(</span><span>action</span><span class="token" style="color:#999">.</span><span class="token property-access">type</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">===</span><span> </span><span class="token maybe-class-name">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Name</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span>
</span><span>                                </span><span class="token doc-comment" style="color:slategray">/**[12] */</span><span>
</span><span>        </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">{</span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>state</span><span class="token" style="color:#999">,</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> action</span><span class="token" style="color:#999">.</span><span class="token property-access">name</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>                      </span><span class="token doc-comment" style="color:slategray">/**[11] */</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token control-flow" style="color:#07a">else</span><span> </span><span class="token control-flow" style="color:#07a">if</span><span class="token" style="color:#999">(</span><span>action</span><span class="token" style="color:#999">.</span><span class="token property-access">type</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">===</span><span> </span><span class="token maybe-class-name">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Gender</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span>
</span><span>                                </span><span class="token doc-comment" style="color:slategray">/**[12] */</span><span>
</span><span>        </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">{</span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>state</span><span class="token" style="color:#999">,</span><span> gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> action</span><span class="token" style="color:#999">.</span><span class="token property-access">gender</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> state</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [5] определение функции редюсера сигнатура
</span><span class="token doc-comment" style="color:slategray"> * которой уточняется при помощи импортированного
</span><span class="token doc-comment" style="color:slategray"> * из пространства имен React обобщенного типа Reducer&lt;S, A&gt; [6]
</span><span class="token doc-comment" style="color:slategray"> * в качестве первого параметра который получает тип представляющей
</span><span class="token doc-comment" style="color:slategray"> * State [7], а в качестве второго тип объединение Actions [8].
</span><span class="token doc-comment" style="color:slategray"> * При таком сценарии сигнатура функции в явном указании типов не нуждается [9] [10]
</span><span class="token doc-comment" style="color:slategray"> * 
</span><span class="token doc-comment" style="color:slategray"> * Блок кода, вхождение в который возможно в результате положительного
</span><span class="token doc-comment" style="color:slategray"> * результата выполнения условия на принадлежность дискриминантного поля type
</span><span class="token doc-comment" style="color:slategray"> * элементу перечисления [11], подразумевает, что объект action принадлежит
</span><span class="token doc-comment" style="color:slategray"> * к соответствующему типу, что позволяет обращаться к присущим только ему членам [12]
</span><span class="token doc-comment" style="color:slategray"> * 
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Как было сказано ранее, сигнатура редюсера не нуждается в аннотации если его тип конкретизирован с помощью <code class="content__code_inline">Reducer&lt;S, A&gt;</code>. За этим скрывается один коварный момент. Представьте ситуацию при которой некоторое время приложение работало с состоянием определяющим <code class="content__code_inline">name</code>, а затем было принято решение изменить его на <code class="content__code_inline">fullName</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// было</span><span>
</span>
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">State</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>    age</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">NameAction</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">name</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> reducer</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">Reducer</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">State</span><span class="token" style="color:#999">,</span><span> </span><span class="token maybe-class-name">NameAction</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>state</span><span class="token" style="color:#999">,</span><span> action</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">if</span><span class="token" style="color:#999">(</span><span>action</span><span class="token" style="color:#999">.</span><span class="token property-access">type</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">===</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">name</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">{</span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>state</span><span class="token" style="color:#999">,</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> action</span><span class="token" style="color:#999">.</span><span class="token property-access">name</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>    
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> state</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>После того как тип описывающий состояние и действие претерпят изменения, неминуемо возникнет ошибка указывающая, что в действии больше нет поля <code class="content__code_inline">name</code>. Если впопыхах изменить лишь старый идентификатор <code class="content__code_inline">name</code> на новый <code class="content__code_inline">fullName</code>, то можно не заметить как значение ассоциированное с новым идентификатором определенным в объекте действия присваивается старому идентификатору определяемому в объекте нового состояния. К ошибке это не приведет, поскольку механизм распространения старого состояния <code class="content__code_inline">...state</code> наделяет новое всеми признаками необходимыми для совместимости с типом <code class="content__code_inline">State</code>. Старый идентификатор <code class="content__code_inline">name</code> в новом состоянии делает его принадлежащим к более общему типу который совместим с объектом <code class="content__code_inline">State</code>. Это неминуемо приводит к трудновыявляемому багу, поскольку значение поля <code class="content__code_inline">fullName</code> всегда будет старым.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">State</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    fullName</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span> </span><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span>    age</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">NameAction</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">name</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span>    fullName</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span> </span><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> reducer</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">Reducer</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">State</span><span class="token" style="color:#999">,</span><span> </span><span class="token maybe-class-name">NameAction</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>state</span><span class="token" style="color:#999">,</span><span> action</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">if</span><span class="token" style="color:#999">(</span><span>action</span><span class="token" style="color:#999">.</span><span class="token property-access">type</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">===</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">name</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span>
</span><span>                        </span><span class="token doc-comment" style="color:slategray">/**[1]        [2] */</span><span>
</span><span>        </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">{</span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>state</span><span class="token" style="color:#999">,</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> action</span><span class="token" style="color:#999">.</span><span class="token property-access">fullName</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> state</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * При изменении State и NameAction [0] ошибка
</span><span class="token doc-comment" style="color:slategray"> * укажет на отсутствие поля name  в объекте
</span><span class="token doc-comment" style="color:slategray"> * принадлежащего к типу NameAction [2]. Интуитивное
</span><span class="token doc-comment" style="color:slategray"> * исправление лишь этой ошибки приведет к трудновыявляемому
</span><span class="token doc-comment" style="color:slategray"> * багу, поскольку новое поле действия присваивается старому идентификатору [1].
</span><span class="token doc-comment" style="color:slategray"> * Нужно быть внимательным, поскольку ошибки не возникнет. Причина заключается в том
</span><span class="token doc-comment" style="color:slategray"> *, что распространение старой версии ...state наделяет новый объект всеми необходимыми
</span><span class="token doc-comment" style="color:slategray"> * характеристиками, что бы быть совместимым с типом State. Старое поле делает из нового объекта
</span><span class="token doc-comment" style="color:slategray"> * значение принадлежащие к более общему типу который совместим с типом State. Поэтому
</span><span class="token doc-comment" style="color:slategray"> * ошибки связанной с неверным возвращающимся значением не возникает. Тем не менее редюсер
</span><span class="token doc-comment" style="color:slategray"> * никогда не изменит значение на новое. Оно всегда будет браться из предыдущего объекта состояния.
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Возвращаясь к основному примеру осталось определить компонент в котором и будет происходить определение элементов <em>Redux</em>. Первым делом в теле компонента определим инициализационное состояние которое с помощью функции обозначенной ранее как <code class="content__code_inline">stateInit</code> будет преобразовано в значение соответствующее типу необходимого редюсеру. Стоит заметить, что поскольку инициализационное значение в полной мере соответствует типу <code class="content__code_inline">InitialState</code> аннотация типа является излишней. При определении с помощью универсальной функции <code class="content__code_inline">useReducer()</code> элементов редакса стоит сделать акцент на отсутствии необходимости в указании аргументов типа, поскольку вывод типов будет опираться на аннотации типов параметров данного хука.</p>
<p>Осталось последовательно изменить состояние с помощью функции <code class="content__code_inline">dispatch</code> вызов которой с объектами в точносте соответствующих типам <code class="content__code_inline">*Action</code> не вызывает никаких нареканий. Вызов с аргументом не надлежащего типа приводит к возникновению ошибки, что в свою очередь подтверждает надежность описанной логики сопряженной с хуком <code class="content__code_inline">useReducer()</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>        </span><span class="token doc-comment" style="color:slategray">/**[13]               [14] */</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">initState</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>initialState</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">InitialState</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">{</span><span>gender</span><span class="token" style="color:#999">,</span><span> </span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>reducerState</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> initialState</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> reducerState</span><span class="token" style="color:#999">;</span><span> </span><span class="token doc-comment" style="color:slategray">/**[15] */</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token doc-comment" style="color:slategray">/** [16]       [17] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> initialState</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">InitialState</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">noname</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>        age</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">NaN</span><span class="token" style="color:#999">,</span><span>
</span><span>        gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span>  </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">notSpecified</span><span class="token template-string template-punctuation" style="color:#690">`</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span>                        </span><span class="token doc-comment" style="color:slategray">/**[18] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useReducer</span><span class="token" style="color:#999">(</span><span>reducer</span><span class="token" style="color:#999">,</span><span> initialState</span><span class="token" style="color:#999">,</span><span> initState</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token doc-comment" style="color:slategray">/**[19] */</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span>        type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Name</span><span class="token" style="color:#999">,</span><span>
</span><span>        name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">superuser</span><span class="token template-string template-punctuation" style="color:#690">`</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token doc-comment" style="color:slategray">/**[19] */</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span>        type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Gender</span><span class="token" style="color:#999">,</span><span>
</span><span>        gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token doc-comment" style="color:slategray">/**[20] */</span><span>
</span><span>    </span><span class="token" style="color:#DD4A68">dispatch</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span>        type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Gender</span><span class="token" style="color:#999">,</span><span>
</span><span>        gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>        age</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">100</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error -&gt; Object literal may only specify known properties, and &#x27;age&#x27; does not exist in type &#x27;GenderAction&#x27;.</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [14] определение инициализационного состояния которое будет
</span><span class="token doc-comment" style="color:slategray"> * передано в качестве единственного аргумента [14] функции initState [13]
</span><span class="token doc-comment" style="color:slategray"> * предназначенной для его трансформации в состояние пригодное редюсеру [15].
</span><span class="token doc-comment" style="color:slategray"> * Данная функция вместе с редюсером и инициализационным состоянием передается
</span><span class="token doc-comment" style="color:slategray"> * в универсальную функцию useReducer в качестве аргументов. Стоит заметить, что 
</span><span class="token doc-comment" style="color:slategray"> * универсальная функция useReducer определяющая элементы redux [18] 
</span><span class="token doc-comment" style="color:slategray"> * в указании аргументов типа не нуждается так как вывод типов отталкивается от
</span><span class="token doc-comment" style="color:slategray"> * типов указанных в аннотациях элементов ожидаемых в качестве параметров.
</span><span class="token doc-comment" style="color:slategray"> * 
</span><span class="token doc-comment" style="color:slategray"> * [19] успешное изменение состояния.
</span><span class="token doc-comment" style="color:slategray"> * [20] попытка изменить состояние с помощью объекта тип которого не совместим
</span><span class="token doc-comment" style="color:slategray"> * с типом State приводит к ошибке.
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Не будет лишним пролить свет на подход объявления типов действий в основе которых лежит базовый тип. Подобное часто требуется для так называемых <code class="content__code_inline">DataAction</code>, действий которые помимо поля <code class="content__code_inline">type</code> определяют ещё и поле <code class="content__code_inline">data</code> с типом <code class="content__code_inline">T</code>.</p>
<p>Для этого потребуется объявить два обобщенных типа. Первым объявим обобщенный тип <code class="content__code_inline">Action&lt;T&gt;</code>, единственный параметр типа которого будет указан в аннотации типа дискриминантного поля <code class="content__code_inline">type</code>. Вторым тип <code class="content__code_inline">DataAction&lt;T, D&gt;</code>, первый параметр типа которого будет передан при расширении в качестве аргумента типу <code class="content__code_inline">Action&lt;T&gt;</code>, а второй параметр типа будет указан в аннотации типа единственного поля <code class="content__code_inline">data</code>. Такой подход часто применяется на практике и значительно упрощает объявление типов представляющих действия предназначенных исключительно для транспортировки данных.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Action</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#905">T</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">T</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token doc-comment" style="color:slategray">/**[1] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">DataAction</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#905">T</span><span class="token" style="color:#999">,</span><span class="token" style="color:#DD4A68"> </span><span class="token" style="color:#905">D</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#07a">extends</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Action</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#905">T</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">readonly</span><span> data</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">D</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * Объявление обобщенных типов действий первый из которых
</span><span class="token doc-comment" style="color:slategray"> * описывает обычное действие с единственным полем
</span><span class="token doc-comment" style="color:slategray"> * type: T [0], а другой расширяет первый и определяет
</span><span class="token doc-comment" style="color:slategray"> * поле data: D.
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<!-- -->
<!-- -->
<span></span><span class="token" style="color:#07a">enum</span><span> </span><span class="token maybe-class-name">ActionType</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token maybe-class-name">Name</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">name</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token maybe-class-name">Gender</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">gender</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">NameData</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">GenderData</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">female</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">notSpecified</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span>          </span><span class="token doc-comment" style="color:slategray">/**[2]                [3]            [4]          [5] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">NameAction</span><span> </span><span class="token" style="color:#07a">extends</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">DataAction</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name" style="color:#DD4A68">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name" style="color:#DD4A68">Name</span><span class="token" style="color:#999">,</span><span class="token" style="color:#DD4A68"> </span><span class="token maybe-class-name" style="color:#DD4A68">NameData</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span>          </span><span class="token doc-comment" style="color:slategray">/**[2]                [3]            [4]               [5] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">GenderAction</span><span> </span><span class="token" style="color:#07a">extends</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">DataAction</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name" style="color:#DD4A68">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name" style="color:#DD4A68">Gender</span><span class="token" style="color:#999">,</span><span class="token" style="color:#DD4A68"> </span><span class="token maybe-class-name" style="color:#DD4A68">GenderData</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [2] определение конкретных действий в основе
</span><span class="token doc-comment" style="color:slategray"> * которых лежит базовый обобщенный тип DataAction&lt;T, D&gt; [3]
</span><span class="token doc-comment" style="color:slategray"> * которому при расширении в качестве первого аргумента типа
</span><span class="token doc-comment" style="color:slategray"> * устанавливается тип дискриминантного поля [4], а в качестве
</span><span class="token doc-comment" style="color:slategray"> * второго тип представляющий данные [5].
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<span></span><span class="token" style="color:#07a">type</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Actions</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token maybe-class-name">NameAction</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token maybe-class-name">GenderAction</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Осталось рассмотреть только случай предполагающий указания аргументов типа универсальной функции острая необходимость в которых возникнет при определении аргументов в момент вызова. В таком случае в качестве первого аргумента типа универсальная функция ожидает тип описывающий функцию редюсер, вторым инициализационное состояние. Кроме того, прибегнуть к помощи аргументов типа может потребоваться и при других сценариях рассматриваемых на всем протяжении темы посвященной хукам. Также не стоит забывать, что универсальная функция <code class="content__code_inline">useReducer</code> имеет множество перегрузок, что на практике допускает сценарии отличные от данного примера.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>useReducer</span><span class="token" style="color:#999">,</span><span> </span><span class="token maybe-class-name">Reducer</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#999">,</span><span> useRef</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">InitialState</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>    age</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>    gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">female</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">notSpecified</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">State</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>    gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">female</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">notSpecified</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">enum</span><span> </span><span class="token maybe-class-name">ActionType</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token maybe-class-name">Name</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">name</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token maybe-class-name">Gender</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">gender</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">enum</span><span> </span><span class="token maybe-class-name">Genders</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token maybe-class-name">Male</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">male</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token maybe-class-name">Female</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">female</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token maybe-class-name">NotSpecified</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">notSpecified</span><span class="token template-string template-punctuation" style="color:#690">`</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">NameAction</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Name</span><span class="token" style="color:#999">;</span><span>
</span><span>    name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">GenderAction</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ActionType</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Gender</span><span class="token" style="color:#999">;</span><span>
</span><span>    gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">Genders</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">type</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Actions</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token maybe-class-name">NameAction</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token maybe-class-name">GenderAction</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">App</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                                            </span><span class="token doc-comment" style="color:slategray">/**[0]                  [1] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>state</span><span class="token" style="color:#999">,</span><span> dispatch</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token generic-function" style="color:#DD4A68">useReducer</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">Reducer</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">State</span><span class="token generic-function generic" style="color:#999">,</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">Actions</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token generic-function generic" style="color:#999">,</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">InitialState</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span>
</span><span>        </span><span class="token" style="color:#999">(</span><span>state</span><span class="token" style="color:#999">,</span><span> action</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> state</span><span class="token" style="color:#999">,</span><span> </span><span class="token doc-comment" style="color:slategray">/**[2] */</span><span>
</span><span>        </span><span class="token" style="color:#999">{</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span> age</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">Genders</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">NotSpecified</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token doc-comment" style="color:slategray">/**[3] */</span><span>
</span><span>        </span><span class="token" style="color:#999">(</span><span>initialState</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> initialState</span><span class="token" style="color:#999">.</span><span class="token property-access">name</span><span class="token" style="color:#999">,</span><span> gender</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> initialState</span><span class="token" style="color:#999">.</span><span class="token property-access">gender</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span>
</span><span>    </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * Указание аргументов типа универсальной функции
</span><span class="token doc-comment" style="color:slategray"> * требуется тогда, когда её аргументы определяются
</span><span class="token doc-comment" style="color:slategray"> * при вызове. В таком случае первый аргумент типа
</span><span class="token doc-comment" style="color:slategray"> * будет представлять описание [0] функции редюсера [02],
</span><span class="token doc-comment" style="color:slategray"> * второй инициализационного состояния [1] [3]. Также возможны
</span><span class="token doc-comment" style="color:slategray"> * и другие сценарии требующий указания аргументов типа которые 
</span><span class="token doc-comment" style="color:slategray"> * были затронуты ранее в теме. Кроме того, универсальная функция
</span><span class="token doc-comment" style="color:slategray"> * имеет множество перегрузок допускающих отличие от данного примера. 
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><section id="Predopredelennye_huki_-_useCallback&lt;T&gt;()" class="content__section"><h2 class="content__heading">Предопределенные хуки - useCallback<!-- -->&lt;T&gt;<!-- -->()</h2>
<p>Следующий на очереди универсальный хук <code class="content__code_inline">useCallback&lt;T&gt;(callback: T, deps): T</code> рассмотрение которого можно ограничить иллюстрацией его применения, поскольку с ним не связанно ничего, что к данному моменту могло бы вызвать хоть какой-то вопрос. Другими словами, как и в остальных рассмотренных ранее случаях прибегать к помощи аргументов типа следует только тогда, когда сигнатура функции обозначенной как <code class="content__code_inline">callback</code> частично или вовсе не имеет указания типов.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>useCallback</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> greeter </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useCallback</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span>userName</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">Hello </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">${</span><span class="token template-string interpolation">userName</span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">}</span><span class="token template-string" style="color:#690">!</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray">     * [0] вывод типов -&gt;
</span><span class="token doc-comment" style="color:slategray">     * 
</span><span class="token doc-comment" style="color:slategray">     * const greeter: (userName: string) =&gt; string
</span><span class="token doc-comment" style="color:slategray">     */</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<!-- -->
<span></span><span class="token" style="color:#07a">type</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Decorate</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>username</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">B</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> greeter </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token generic-function" style="color:#DD4A68">useCallback</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">Decorate</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span> userName </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">Hello </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">${</span><span class="token template-string interpolation">userName</span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">}</span><span class="token template-string" style="color:#690">!</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray">     * [0] аргумент типа -&gt;
</span><span class="token doc-comment" style="color:slategray">     * 
</span><span class="token doc-comment" style="color:slategray">     * const greeter: Decorate
</span><span class="token doc-comment" style="color:slategray">     */</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><section id="Predopredelennye_huki_-_useRef&lt;T&gt;()" class="content__section"><h2 class="content__heading">Предопределенные хуки - useRef<!-- -->&lt;T&gt;<!-- -->()</h2>
<p>Следующий хук <code class="content__code_inline">useRef&lt;T&gt;(initialValue)</code> является универсальной функцией предназначенной для создания объекта рефы. Поскольку объект рефы возвращаемый из данного хука может служить не только для хранения ссылок на <em>React элементы</em> и <em>React компоненты</em>, но и на любые другие значения, которые к тому же могут выступать в качестве единственного аргумента, данная функция имеет множество перегрузок. И кроме этого на текущий момент с ней связан один нюанс. Но обо всем по порядку.</p>
<p>В тех случаях когда объект рефы выполняет роль хранилища для не относящихся к <em>React</em> значений, в его определении нет ничего необычного. Простыми словами, если инициализационное значение устанавливается частично или не устанавливается вовсе, то его тип необходимо конкретизировать с помощью аргумента типа. В противном случае переложить эту работу на вывод типов.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>useRef</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Data</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>    b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                        </span><span class="token doc-comment" style="color:slategray">/**[0]   [1]      [2] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> dataRef </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token generic-function" style="color:#DD4A68">useRef</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">Partial</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">Data</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;&gt;</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// let dataRef: React.MutableRefObject&lt;Partial&lt;Data&gt;&gt;</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> a </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> dataRef</span><span class="token" style="color:#999">.</span><span class="token property-access">current</span><span class="token" style="color:#999">.</span><span class="token property-access">a</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// let a: number | undefined</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * Поскольку значение [1] установлено частично [2]
</span><span class="token doc-comment" style="color:slategray"> * возникла необходимость прибегнуть к помощи типа
</span><span class="token doc-comment" style="color:slategray"> * Partial&lt;T&gt; [0].
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">B</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                            </span><span class="token doc-comment" style="color:slategray">/**[0]        [1] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> dataRef </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token generic-function" style="color:#DD4A68">useRef</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">Data</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic nil" style="color:#07a">undefined</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// let dataRef: React.MutableRefObject&lt;Data | undefined&gt;</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> a </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> dataRef</span><span class="token" style="color:#999">.</span><span class="token property-access">current</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?.</span><span>a</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// let a: number | undefined</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * Поскольку значение [1] вовсе не было установлено
</span><span class="token doc-comment" style="color:slategray"> * аргумент типа указан как объединение включающего
</span><span class="token doc-comment" style="color:slategray"> * тип undefined [0].
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">C</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>           </span><span class="token doc-comment" style="color:slategray">/**[0]      [1]   [2] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> dataRef </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useRef</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// let dataRef: React.MutableRefObject&lt;{a: number;b: string;}&gt;</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> a </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> dataRef</span><span class="token" style="color:#999">.</span><span class="token property-access">current</span><span class="token" style="color:#999">.</span><span class="token property-access">a</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// let a: number</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * Поскольку значение [2] в полной мере соответствует
</span><span class="token doc-comment" style="color:slategray"> * предполагаемому типу необходимости в конкретизации
</span><span class="token doc-comment" style="color:slategray"> * типа отпадает [0] [1].
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Также стоит обратить внимание, что идентификатор которому в момент определения присваивается результат вызова функции <code class="content__code_inline">useRef()</code> в явной аннотации не нуждается.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">C</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> dataRef </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useRef</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">,</span><span> b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [0] ссылка на возвращаемый хуком useRef объект
</span><span class="token doc-comment" style="color:slategray"> * в аннотации типа не нуждается. Указание аннотаций
</span><span class="token doc-comment" style="color:slategray"> * типа в подобных случаях лишь отнимают время и
</span><span class="token doc-comment" style="color:slategray"> * затрудняют чтение кода.
</span><span class="token doc-comment" style="color:slategray"> * 
</span><span class="token doc-comment" style="color:slategray"> * let dataRef: React.MutableRefObject&lt;</span><span class="token doc-comment" style="color:#999">{</span><span class="token doc-comment" style="color:slategray">a: number;b: string;</span><span class="token doc-comment" style="color:#999">}</span><span class="token doc-comment" style="color:slategray">&gt;
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Осталось оговорить упомянутый в самом начале нюанс который связан с объектом рефы устанавливаемого <em>React элементу</em>. Дело в том, что декларация <em>React элементов</em>, в частности поля <code class="content__code_inline">ref</code>, аннотирована устаревшим типом, который не совместим с типом значения получаемого в результате вызова хука <code class="content__code_inline">useRef()</code>. К тому же уточнение типа в аннотации идентификатора или с помощью аргументов типа универсальной функции с данной проблемой справится не помогут. Единственное решение явное приведение к типу <code class="content__code_inline">RefObject&lt;T&gt;</code> возвращаемое хуком значение с помощью оператора <code class="content__code_inline">as</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>useRef</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#999">,</span><span> </span><span class="token maybe-class-name">RefObject</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:slategray">// let formRef: RefObject&lt;HTMLFormElement&gt; | null = useRef(); // Error</span><span>
</span><span>    </span><span class="token" style="color:slategray">// let formRef = useRef&lt;RefObject&lt;HTMLFormElement&gt; | null&gt;(); // Error</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> formRef </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useRef</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token maybe-class-name">RefObject</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">HTMLFormElement</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>form ref</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span>formRef</span><span class="token" style="color:#999">}</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>form</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Более подробно с данным хуком можно познакомиться в главе посвященной рефам.</p></section><section id="Predopredelennye_huki_-_useImperativeHandle&lt;T,R&gt;()" class="content__section"><h2 class="content__heading">Предопределенные хуки - useImperativeHandle&lt;T, R&gt;()</h2>
<p>Следующий на очереди хук <code class="content__code_inline">useImperativeHandle&lt;T, R&gt;(ref: Ref&lt;T&gt;, apiFactory() =&gt; R): void</code> предназначенный для присваивания объекта выступающего в роли открытой части <em>api</em> функционального компонента. В тех случаях когда открытая часть <em>api</em> отличается от закрытой, универсальная функция нуждается в уточнении при помощи аргументов типа. В остальных случах всегда рекомендуется поручить эту работу выводу типов.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span class="token maybe-class-name">ForwardRefRenderFunction</span><span class="token" style="color:#999">,</span><span> </span><span class="token maybe-class-name">RefObject</span><span class="token" style="color:#999">,</span><span> useRef</span><span class="token" style="color:#999">,</span><span> useImperativeHandle</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#999">,</span><span> forwardRef</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">FormProps</span><span> </span><span class="token" style="color:#999">{</span><span>
</span>
<span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**[0] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">PublicFormApi</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token function-variable" style="color:#DD4A68">a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token doc-comment" style="color:slategray">/**[1] */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">PrivateFormApi</span><span> </span><span class="token" style="color:#07a">extends</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">PublicFormApi</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token function-variable" style="color:#DD4A68">b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [0] объявление типа представляющего открытую часть
</span><span class="token doc-comment" style="color:slategray"> * api компонента, которую будет расширять объявленный
</span><span class="token doc-comment" style="color:slategray"> * позже тип описывающий его закрытую часть [1].
</span><span class="token doc-comment" style="color:slategray"> */</span><span>
</span>
<!-- -->
<span> </span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray">  * 
</span><span class="token doc-comment" style="color:slategray">  * [!] не обращать внимание на код
</span><span class="token doc-comment" style="color:slategray">  * помеченный восклицательным знаком,
</span><span class="token doc-comment" style="color:slategray">  * поскольку данные участи кода будут
</span><span class="token doc-comment" style="color:slategray">  * подробно рассмотрены в свое время.
</span><span class="token doc-comment" style="color:slategray">  */</span><span>
</span>
<span>                    </span><span class="token doc-comment" style="color:slategray">/**[!] */</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">Form</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ForwardRefRenderFunction</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">PublicFormApi</span><span class="token" style="color:#999">,</span><span> </span><span class="token maybe-class-name">FormProps</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>props</span><span class="token" style="color:#999">,</span><span> ref</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                         </span><span class="token doc-comment" style="color:slategray">/**[2]             [3] */</span><span>
</span><span>    </span><span class="token generic-function" style="color:#DD4A68">useImperativeHandle</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">PublicFormApi</span><span class="token generic-function generic" style="color:#999">,</span><span class="token generic-function generic" style="color:#DD4A68"> </span><span class="token generic-function generic maybe-class-name" style="color:#DD4A68">PrivateFormApi</span><span class="token generic-function generic" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">(</span><span>ref</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token function-variable" style="color:#DD4A68">a</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>        </span><span class="token function-variable" style="color:#DD4A68">b</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray">     * С помощью аргументов типа указываем тип
</span><span class="token doc-comment" style="color:slategray">     * открытой [2] и закрытой [3] части api компонента.
</span><span class="token doc-comment" style="color:slategray">     */</span><span> 
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span>        </span><span class="token doc-comment" style="color:slategray">/**[!]            [!] */</span><span>
</span><span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">FormWithRef</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">forwardRef</span><span class="token" style="color:#999">(</span><span class="token maybe-class-name">Form</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token maybe-class-name">App</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                        </span><span class="token doc-comment" style="color:slategray">/**[!] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> formRef </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useRef</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token maybe-class-name">RefObject</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">PublicFormApi</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    formRef</span><span class="token" style="color:#999">.</span><span class="token property-access">current</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?.</span><span class="token method property-access" style="color:#DD4A68">a</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span>    </span><span class="token" style="color:slategray">// formRef.current?.b(); // Error</span><span>
</span>
<span>                     </span><span class="token doc-comment" style="color:slategray">/**[6] */</span><span>
</span><span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">FormWithRef</span><span> ref</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span>formRef</span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><section id="Predopredelennye_huki_-_useMemo&lt;T&gt;()" class="content__section"><h2 class="content__heading">Предопределенные хуки - useMemo<!-- -->&lt;T&gt;<!-- -->()</h2>
<p>Следующим на очереди хук <code class="content__code_inline">useMemo&lt;T&gt;(factory): T</code> является универсальной функцией ожидающей в качестве первого параметра фабричную функцию вычисляющую возвращаемое хуком значение тип которого, при необходимости, можно указать с помощью аргумента типа. Второй обязательный параметр принадлежит к типу массива, при наличии и изменении элементов которого происходит повторный вызов фабричной функции. Как всегда, стоит упомянуть, что явное указание аргумента типа универсальной функции необходимо в очень редких случаях, каждый из которых был рассмотрен на протяжении всей темы посвященной хукам. Кроме того, переменная которой присваивается возвращаемое из хука значение, в аннотации типа и вовсе не нуждается.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>useMemo</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>            </span><span class="token doc-comment" style="color:slategray">/**[0]           [1] */</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> memoizedValue </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useMemo</span><span class="token" style="color:#999">(</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#905">2</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">+</span><span> </span><span class="token" style="color:#905">2</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// let memoizedValue: number</span><span>
</span>
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * Нет необходимости указывать аннотацию
</span><span class="token doc-comment" style="color:slategray"> * типа переменной [0] и передавать аргументы
</span><span class="token doc-comment" style="color:slategray"> * типа [1] универсальной функции поскольку
</span><span class="token doc-comment" style="color:slategray"> * вывод типов самостоятельно справится с этой работой.
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><section id="Predopredelennye_huki_-_useDebugValue&lt;T&gt;()" class="content__section"><h2 class="content__heading">Предопределенные хуки - useDebugValue<!-- -->&lt;T&gt;<!-- -->()</h2>
<p>Следующий и последний на очереди хук <code class="content__code_inline">useDebugValue&lt;T&gt;(data: T, format(data: T) =&gt; any): void</code> предназначенный для вывода логов в <em>devtools</em> является универсальной функцией первый параметр которой ожидает выводимое в консоль значение, чьё форматирование может быть осуществлено при помощи функции выступающей в роли второго необязательного параметра. Вся информация имеющаяся к этому моменту и касающаяся явного указания типов в полной мере справедлива и для текущего хука.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token maybe-class-name">React</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">{</span><span>useDebugValue</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#905">FC</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token" style="color:#905">A</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">FC</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>                   </span><span class="token doc-comment" style="color:slategray">/**[0]    [1]           [2] */</span><span>
</span><span>   </span><span class="token" style="color:#DD4A68">useDebugValue</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">new</span><span> </span><span class="token known-class-name" style="color:#DD4A68">Date</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> date </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> date</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">getMilliseconds</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>   </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token null nil" style="color:#07a">null</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray">* Хук принимает значение тпа Date [0]
</span><span class="token doc-comment" style="color:slategray">* и затем передает его в функцию форматирования [1]
</span><span class="token doc-comment" style="color:slategray">* из которой возвращается значение принадлежащее к
</span><span class="token doc-comment" style="color:slategray">* типу number [2].
</span><span class="token doc-comment" style="color:slategray">*/
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><section id="Polzovatelskii_huk" class="content__section"><h2 class="content__heading">Пользовательский хук</h2>
<p>Помимо предопределенных хуков рассмотренных ранее, <em>React</em> также позволяет определять пользовательские хуки, которым будет посвящен остаток текущей главы.</p>
<p>Чтобы стразу перейти к делу представьте, что перед разработчиком встала задача реализовать эффект печатающегося текста с возможностью его запускать, останавливать и ставить на паузу при необходимости. Для этого потребуется реализовать пользовательский хук <code class="content__code_inline">usePrintText(text, interval)</code>, который на вход будет принимать исходный текс и значение скорости печати. Поскольку печатающийся текст будет реализован за счет постепенного изменения состояния определенного внутри хука и выдаваемого наружу, начать стоит именно с описания его типа.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token doc-comment" style="color:slategray">/**описание объекта состояния */</span><span>
</span><span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">TextPrintInfo</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    isDone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">boolean</span><span class="token" style="color:#999">;</span><span>
</span><span>    status</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">;</span><span>
</span><span>    currentText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>    sourceText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Кроме состояния, хук должен предоставлять функции выступающие в роли контролов предназначенных для управления анимацией печатанья. Поэтому вторым шагом потребуется описать тип представляющих контролы, что совершенно не составит никакого труда, так как старт\пауза\стоп являются обычными функциями которые ничего не возвращают.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token doc-comment" style="color:slategray">/**описание типа контролов старт\пауза\стоп */</span><span>
</span><span></span><span class="token" style="color:#07a">type</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">ControlCallback</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Осталось описать тип представляющий сам хук или если быть точнее, сигнатуры функции, которой по сути он является. Особое внимание стоит обратить на возвращаемый тип представленный размеченным кортежем, для которого несмотря на большое количество кода не был создан псевдоним. Такое решение было принято из-за того, что автокомплит <em>ide</em> указал бы возвращаемый тип как псевдоним, сделав тем самым подсказку малоинформативной, лишив её информации, доступной благодаря меткам.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>        </span><span class="token doc-comment" style="color:slategray">/**[0]                                               [1] */</span><span>
</span><span></span><span class="token" style="color:#07a">type</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">UsePrintText</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>sourceText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">,</span><span> interval</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">[</span><span>
</span><span>    textInfo</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintInfo</span><span class="token" style="color:#999">,</span><span>
</span><span>    start</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ControlCallback</span><span class="token" style="color:#999">,</span><span>
</span><span>    pause</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ControlCallback</span><span class="token" style="color:#999">,</span><span>
</span><span>    stop</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ControlCallback</span><span>
</span><span></span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray"> * [0] тип представляющий пользовательский хук,
</span><span class="token doc-comment" style="color:slategray"> * тип возвращаемого значения представлен размеченным кортежем [1]
</span><span class="token doc-comment" style="color:slategray"> */
</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Осталось лишь определить сам хук.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">TextPrintInfo</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    isDone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">boolean</span><span class="token" style="color:#999">;</span><span>
</span><span>    status</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">;</span><span>
</span><span>    currentText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>    sourceText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">type</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">ControlCallback</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">type</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">UsePrintText</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>sourceText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">,</span><span> interval</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">[</span><span>
</span><span>    textInfo</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintInfo</span><span class="token" style="color:#999">,</span><span>
</span><span>    start</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ControlCallback</span><span class="token" style="color:#999">,</span><span>
</span><span>    pause</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ControlCallback</span><span class="token" style="color:#999">,</span><span>
</span><span>    stop</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ControlCallback</span><span>
</span><span></span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<!-- -->
<span></span><span class="token" style="color:#07a">const</span><span> usePrintText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">UsePrintText</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>sourceText</span><span class="token" style="color:#999">,</span><span> interval </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">200</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:slategray">// определение состояния</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>textInfo</span><span class="token" style="color:#999">,</span><span> setTextInfo</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span>        isDone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">false</span><span class="token" style="color:#999">,</span><span>
</span><span>        status</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Waiting</span><span class="token" style="color:#999">,</span><span>
</span><span>        currentText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>        sourceText</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span>    </span><span class="token" style="color:slategray">// определение контролов</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">start</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">pause</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">stop</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">[</span><span>textInfo</span><span class="token" style="color:#999">,</span><span> start</span><span class="token" style="color:#999">,</span><span> pause</span><span class="token" style="color:#999">,</span><span> stop</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Поскольку логика работы хука не имеет никакого отношения к <em>TypeScript</em>, её детального разбора не будет. Тем не менее полный код представлен и при желании испытать свои знания, предлагается самостоятельно устно его прокомментировать.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">React</span><span class="token imports" style="color:#999">,</span><span class="token imports"> </span><span class="token imports" style="color:#999">{</span><span class="token imports"> useState</span><span class="token imports" style="color:#999">,</span><span class="token imports"> useEffect </span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;react&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">enum</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token maybe-class-name">Print</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">print</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token maybe-class-name">Waiting</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">waiting</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token maybe-class-name">Pause</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">pause</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token maybe-class-name">Done</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">done</span><span class="token template-string template-punctuation" style="color:#690">`</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">TextPrintInfo</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    isDone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">boolean</span><span class="token" style="color:#999">;</span><span>
</span><span>    status</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">;</span><span>
</span><span>    currentText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>    sourceText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<span></span><span class="token" style="color:#07a">type</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">ControlCallback</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#07a">type</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">UsePrintText</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>sourceText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">,</span><span> interval</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">[</span><span>
</span><span>    textInfo</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintInfo</span><span class="token" style="color:#999">,</span><span>
</span><span>    start</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ControlCallback</span><span class="token" style="color:#999">,</span><span>
</span><span>    pause</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ControlCallback</span><span class="token" style="color:#999">,</span><span>
</span><span>    stop</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">ControlCallback</span><span>
</span><span></span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:#07a">const</span><span> usePrintText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">UsePrintText</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span>sourceText</span><span class="token" style="color:#999">,</span><span> interval </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">200</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>timeoutId</span><span class="token" style="color:#999">,</span><span> setTimeoutId</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">NaN</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span>textInfo</span><span class="token" style="color:#999">,</span><span> setTextInfo</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">useState</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span>        isDone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">false</span><span class="token" style="color:#999">,</span><span>
</span><span>        status</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Waiting</span><span class="token" style="color:#999">,</span><span>
</span><span>        currentText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span><span>        sourceText</span><span class="token" style="color:#999">,</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">isDone</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> textInfo</span><span class="token" style="color:#999">.</span><span class="token property-access">currentText</span><span class="token" style="color:#999">.</span><span class="token property-access">length</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">===</span><span> sourceText</span><span class="token" style="color:#999">.</span><span class="token property-access">length</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">getNextText</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> textInfo</span><span class="token" style="color:#999">.</span><span class="token property-access">currentText</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">concat</span><span class="token" style="color:#999">(</span><span>sourceText</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">charAt</span><span class="token" style="color:#999">(</span><span>textInfo</span><span class="token" style="color:#999">.</span><span class="token property-access">currentText</span><span class="token" style="color:#999">.</span><span class="token property-access">length</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#DD4A68">useEffect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token control-flow" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span>textInfo</span><span class="token" style="color:#999">.</span><span class="token property-access">status</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">===</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Print</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">!</span><span>textInfo</span><span class="token" style="color:#999">.</span><span class="token property-access">isDone</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>            </span><span class="token" style="color:#DD4A68">print</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#999">}</span><span>
</span>
<span>    </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span>textInfo</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>    </span><span class="token" style="color:#DD4A68">useEffect</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#DD4A68">cancel</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">print</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#07a">let</span><span> timeoutId </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">setTimeout</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>            </span><span class="token" style="color:#DD4A68">setTextInfo</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span>                status</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#DD4A68">isDone</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Done</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Print</span><span class="token" style="color:#999">,</span><span>
</span><span>                isDone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#DD4A68">isDone</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span>
</span><span>                currentText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#DD4A68">getNextText</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">,</span><span>
</span>                sourceText
<span>            </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> interval</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>        </span><span class="token" style="color:#DD4A68">setTimeoutId</span><span class="token" style="color:#999">(</span><span>timeoutId</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>
<span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">cancel</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token control-flow" style="color:#07a">if</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">!</span><span class="token known-class-name" style="color:#DD4A68">Number</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">isNaN</span><span class="token" style="color:#999">(</span><span>timeoutId</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>            </span><span class="token" style="color:#DD4A68">clearTimeout</span><span class="token" style="color:#999">(</span><span>timeoutId</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">start</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">setTextInfo</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span>            </span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>textInfo</span><span class="token" style="color:#999">,</span><span>
</span><span>            status</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Print</span><span class="token" style="color:#999">,</span><span>
</span><span>        </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">pause</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">cancel</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">setTextInfo</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span>            </span><span class="token spread" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">...</span><span>textInfo</span><span class="token" style="color:#999">,</span><span>
</span><span>            status</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Pause</span><span class="token" style="color:#999">,</span><span>
</span><span>            isDone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">false</span><span class="token" style="color:#999">,</span><span>
</span><span>        </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">setTimeoutId</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">NaN</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span><span>    </span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable" style="color:#DD4A68">stop</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">cancel</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">setTextInfo</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">{</span><span>
</span><span>            isDone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">false</span><span class="token" style="color:#999">,</span><span>
</span><span>            status</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">TextPrintStatus</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">Waiting</span><span class="token" style="color:#999">,</span><span>
</span><span>            currentText</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">,</span><span>
</span>            sourceText
<span>        </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>        </span><span class="token" style="color:#DD4A68">setTimeoutId</span><span class="token" style="color:#999">(</span><span class="token" style="color:#905">NaN</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>    </span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">[</span><span>textInfo</span><span class="token" style="color:#999">,</span><span> start</span><span class="token" style="color:#999">,</span><span> pause</span><span class="token" style="color:#999">,</span><span> stop</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span>
<!-- -->
<!-- -->
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">App</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>    </span><span class="token" style="color:#07a">let</span><span> </span><span class="token" style="color:#999">[</span><span class="token" style="color:#999">{</span><span>currentText</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span> start</span><span class="token" style="color:#999">,</span><span> pause</span><span class="token" style="color:#999">,</span><span> stop</span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#DD4A68">usePrintText</span><span class="token" style="color:#999">(</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">React + TypeScript = ♥</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span>    </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#999">(</span><span>
</span><span>        </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>            </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>p</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">{</span><span>currentText</span><span class="token" style="color:#999">}</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>p</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>            </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>button onClick</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#DD4A68">start</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">}</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>start</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>button</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>            </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>button onClick</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#DD4A68">pause</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">}</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>pause</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>button</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>            </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>button onClick</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#DD4A68">stop</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">}</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>stop</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>button</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>        </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span><span>    </span><span class="token" style="color:#999">)</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><aside class="content-box__page__content-bar_post"><nav class="post-content-bar__nav"><a href="Universalnye_komponenty" class="ant-btn ant-btn-lg ant-btn-block post-content-bar__nav__btn post-content-bar__nav__btn_prev"><div class="post-content-bar__nav__btn_padding-fix"><span role="img" aria-label="arrow-left" class="anticon anticon-arrow-left post-content-bar__nav__btn__icon_prev"><svg viewBox="64 64 896 896" focusable="false" data-icon="arrow-left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"></path></svg></span><span class="post-content-bar__nav__btn__label">Универсальные компоненты</span></div></a><a href="Kontekst_(Context)" class="ant-btn ant-btn-lg ant-btn-block post-content-bar__nav__btn post-content-bar__nav__btn_next"><div class="post-content-bar__nav__btn_padding-fix"><span class="post-content-bar__nav__btn__label">Контекст (Context)</span><span role="img" aria-label="arrow-right" class="anticon anticon-arrow-right post-content-bar__nav__btn__icon_next"><svg viewBox="64 64 896 896" focusable="false" data-icon="arrow-right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"></path></svg></span></div></a></nav></aside></main><div class="content-box__page-nav content-box__page-nav_right"><div class="page-nav__bar page-nav__bar_right"><span style="display:inline-block;cursor:not-allowed" class="page-nav__btn ant-tooltip-disabled-compatible-wrapper"><button disabled="" style="pointer-events:none" type="button" class="ant-btn ant-btn-primary ant-btn-icon-only"><span role="img" aria-label="up" class="anticon anticon-up"><svg viewBox="64 64 896 896" focusable="false" data-icon="up" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"></path></svg></span></button></span><button type="button" class="ant-btn ant-btn-primary ant-btn-icon-only page-nav__btn page-nav__btn_next-page"><span role="img" aria-label="right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"></path></svg></span></button><span style="display:inline-block;cursor:not-allowed" class="page-nav__btn ant-tooltip-disabled-compatible-wrapper"><button disabled="" style="pointer-events:none" type="button" class="ant-btn ant-btn-primary ant-btn-icon-only"><span role="img" aria-label="down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></span></button></span></div></div></div></div><div class="slide-layer__last-empty"></div></div><footer class="app-footer"><div class="app-footer__empty"></div><div class="app-footer_contacts app-footer__section"></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"urlResolver":{"image":"https://raw.githubusercontent.com/nauchikus/typescript-definitive-guide/master/book/ru/chapters/054.(React) Типизированные хуки/images/"},"sectionInfoAll":[{"key":"Типизированные хуки","elementId":"Tipizirovannye_huki","markdown":"# Типизированные хуки\n\n_React_ _api_ насчитывает десять предопределенных хуков большинство которых являются универсальными. Каждый из них будет рассмотрен по отдельности. Кроме того, данная глава будет посвящена определению пользовательских хуков с учетом последних возможностей _TypeScript_."},{"key":"Типизированные хуки_0","elementId":"Predopredelennye_huki_-_useState\u003cT\u003e()","markdown":"## Предопределенные хуки - useState\u003cT\u003e()\n\nРассмотрение данной темы стоит начать с самого часто применяемого универсального хука `useState\u003cT\u003e(initialState): [state, dispatch]` параметр типа которого представляет определяемое им состояние. В случаях когда при вызове универсальной функции `useState\u003cT\u003e(initialState)` аргумент типа не устанавливается, тип значения будет выведен на основе аргумента функции обозначаемого `initialState`. Это в свою очередь означает, что при отсутствии инициализационного значения (вызов функции `useState` без значения) или его временном замещении значением принадлежащим к другому типу (например объектный тип замещается значением `null`), или частичном значении (объектный тип определяющий лишь часть своих членов), изменить его в будущем с помощью функции обозначаемой `dispatch` будет невозможно, поскольку она при определении также ассоциируется с выведенным на основе `initialState` типом.\n\n`````ts\nconst A: FC = () =\u003e {\n                              /**[0][1] */\n    let [state, dispatch] = useState();\n    dispatch(0); // Error -\u003e type 0 is not type undefined\n\n    /**\n     * Поскольку отсутствие initialState [1] не было\n     * компенсировано аргументом типа [0] невозможно\n     * установит новое значение с помощью функции dispatch\n     * если оно принадлежит к типу отличному от выведенного\n     * в момент определения.\n     */\n\n\n    return null;\n}\n\nconst B: FC = () =\u003e {\n                               /**[0][1] */\n    let [state, dispatch] = useState(null);\n    dispatch({ a: 0 }); // Error -\u003e type {a: number} is not type null\n\n    /**\n    * Поскольку initialState [1] принадлежит к типу null\n    * и отсутствует уточнение типа состояния при помощи\n    * аргумента типа [0], то будет невозможно установить новое\n    * значение с помощью функции dispatch если оно принадлежит\n    * к типу отличному от выведенного в момент определения.\n    */\n\n\n    return null;\n}\nconst С: FC = () =\u003e {\n                               /**[0] [1] */\n    let [state, dispatch] = useState({a: 0});\n    dispatch({ a: 0, b: `` }); // Error -\u003e type {a: number, b: string} is not type {a: number}\n\n    /**\n    * Поскольку initialState [1] представляет из себя лишь \n    * часть от предполагаемого типа и при этом отсутствует\n    * уточнение типа состояния при помощи\n    * аргумента типа [0], то будет невозможно установить новое\n    * значение с помощью функции dispatch если оно принадлежит\n    * к типу отличному от выведенного в момент определения.\n    */\n\n\n    return null;\n}\n`````\n\nВ подобных случаях необходимо уточнить тип к которому принадлежит состояние при помощи аргумента типа. Единственное нужно помнить, что несмотря на уточнение типа, при отсутствии `initialState`, состояние будет принадлежать к объединению `T | undefined`.\n\n\n`````ts\nconst A: FC = () =\u003e {\n    let [state, dispatch] = useState\u003cnumber\u003e();\n    dispatch(0); // Ok\n    state; // number | undefined\n\n\n    return null;\n}\n\nconst B: FC = () =\u003e {\n                                              /**[*] */\n    let [state, dispatch] = useState\u003c{a: number} | null\u003e(null);\n    dispatch({ a: 0 }); // Ok\n    state; // {a: number} | null\n\n\n    return null;\n}\nconst С: FC = () =\u003e {\n                                             /**[*] */\n    let [state, dispatch] = useState\u003c{a: number; b?: string;}\u003e({a: 0});\n    dispatch({ a: 0, b: `` }); // Ok\n    state; // {a: number; b?: string | undefined}\n\n\n    return null;\n}\n\n/**\n * [*] конкретизация типа\n */\n `````\n\nВсе описанные случаи так или иначе предполагают дополнительные проверки на существование значения, которые на практике отягощают код. Поэтому при отсутствии конкретного состояния выступающего в роли аргумента универсальной функции, всегда лучше устанавливать значение по умолчанию в полной мере соответствующего типу, нежели допускать его отсутствие, замещение или частичную установку.\n\nПри условии, что `initialState` представлен значением в полной мере соответствующим требуемому типу, необходимость в уточнении с помощью аргумента типа пропадает, поскольку выводу типов не составит особого труда справиться самостоятельно. Простыми словами, если аргумент типа не устанавливается, его тип выводится на основе типа к которому принадлежит аргумент вызываемой функции. В случае, когда состояние в полной мере устанавливается в качестве единственного аргумента хука `useState\u003cT\u003e()` необходимости в уточнении типа, при помощи аргумента функционального типа, не требуется. Если в качестве значения выступает примитив или объект, все члены которого инициализированны, вывод типов будет только рад взять работу по установлению типа на себя.\n\n`````ts\nconst A: FC = () =\u003e {\n    let [state, dispatch] = useState(0);\n    dispatch(0); // Ok\n    state; // number\n\n\n    return null;\n}\n\nconst B: FC = () =\u003e {\n    let [state, dispatch] = useState({a: 0});\n    dispatch({ a: 0 }); // Ok\n    state; // {a: number}\n\n\n    return null;\n}\nconst С: FC = () =\u003e {\n    let [state, dispatch] = useState({a: 0, b: ``});\n    dispatch({ a: 0, b: `` }); // Ok\n    state; // {a: number; b: string;}\n\n\n    return null;\n}\n`````"},{"key":"Типизированные хуки_1","elementId":"Predopredelennye_huki_-_useEffect()_i_useLayoutEffect()","markdown":"## Предопределенные хуки - useEffect() и useLayoutEffect()\n\nСледующими на очереди расположились сразу два идентичных с точки зрения типизации хука `useEffect(effect, deps?): void` и `useLayoutEffect(effect, deps?): void`, ожидающие в качестве первого параметра функцию, а в качестве второго необязательного параметра, массив, изменение элементов которого приводит к повторному вызову первого аргумента. Поскольку у данных хуков отсутствует возвращаемое значение, сложно представить сценарий в котором возникает ошибка связанная с передачей аргументов. Поэтому подробное рассмотрение и пояснение будет опущено.\n\n`````ts\nconst A: FC = () =\u003e {\n    useEffect(() =\u003e {\n        return () =\u003e {}\n    }, []);\n\n    useLayoutEffect(() =\u003e {\n        return () =\u003e {}\n    }, []);\n\n\n    return null;\n}\n`````"},{"key":"Типизированные хуки_2","elementId":"Predopredelennye_huki_-_useContext\u003cT\u003e()","markdown":"## Предопределенные хуки - useContext\u003cT\u003e()\n\nСледующий претендент на рассмотрение предназначен для работы с контекстом и является универсальной функцией `useContext\u003cT\u003e(context)` принимающей в качестве аргумента объект контекста, который при необходимости можно уточнить с помощью аргумента типа. Поскольку вывод типов в состоянии самостоятельно вывести тип опираясь на обязательный параметр `context`, то уточнение типа с помощью аргумента типа не требуется.\n\n\n`````ts\nimport React, {createContext, useContext, FC} from \"react\";\n\nconst StringContext = createContext(`Is Context Value!`);\n\nconst A: FC = () =\u003e {\n    let context = useContext(StringContext // let context: string\n\n\n    return null;\n}\n`````\nУточнение с помощью аргумента типа может потребоваться только при необходимости приведения более общего типа к более конкретному. Но в реальности универсальная функция этого не позволяет сделать.\n\n`````ts\nimport React, {createContext, useContext, FC} from \"react\";\n\ninterface T0 {\n    a: number;\n}\ninterface T1 {\n    b: string;\n}\n\n\n       /**[0] */\ninterface T2 extends T0, T1 {}\n\n/**\n * [0] более общий тип\n */\n\n\nlet contextDefaultValue: T2 = {\n    a: 0,\n    b: ``\n};\n\nconst StringContext = createContext(contextDefaultValue); // const StringContext: React.Context\u003cT2\u003e\n\nconst A: FC = () =\u003e {\n    let c0 = useContext(StringContext); // let c0: T2\n    let c1 = useContext\u003cT0\u003e(StringContext); // Error -\u003e [1]\n\n    /**\n     * [1] при попытке приведения более общего типа\n     * T2 к более конкретному типу T0 возникает ошибка -\u003e\n     * Argument of type 'Context\u003cT2\u003e' is not assignable\n     * to parameter of type 'Context\u003cT0\u003e'.\n     */\n\n    return null;\n}\n`````\n\nПри возникновении потребности в подобном приведении конкретизировать необходимо идентификатор ассоциированный со значением, то есть переменную.\n\n`````ts\nconst A: FC = () =\u003e {\n    let c2: T0 = useContext(StringContext); // Ok -\u003e let c2: T0\n\n    return null;\n}\n`````"},{"key":"Типизированные хуки_3","elementId":"Predopredelennye_huki_-_useReducer\u003cR\u003e()","markdown":"## Предопределенные хуки - useReducer\u003cR\u003e()\n\nСледующий в списке предопределенных хуков расположился `useReducer\u003cR\u003e(reducer, initialState, stateInit):[state, dispatch]` представленный универсальной функцией имеющей множество перегрузок. Чтобы познакомится с каждым из параметров данной функции, для начала, нам потребуется объявить два типа описывающих состояние (`state`) и инициализационное состояние (`initialState`), которое специально будет отличаться от обычного, что бы преобразовать его при помощи функции обозначенной как `stateInit`.\n\n`````ts\n/**[0] */\ninterface InitialState {\n    name: string;\n    age: number;\n    gender: `male` | `female` | `notSpecified`;\n}\n/**[1] */\ninterface State {\n    name: string;\n    gender: `male` | `female` | `notSpecified`;\n}\n\n/**\n * Объявление интерфейсов описывающих\n * состояние [1] и инициализационное состояние [0].\n * \n */\n `````\n\nЗатем определим функцию `reducer` для описания сигнатуры которой воспользуемся импортированным их пространства имен _React_ обобщенным типом `Reducer\u003cS, A\u003e` ожидающего в качестве первого аргумента типа тип описывающий `state`, а в качестве второго тип описывающий действие `Action`. В нашем примере второй аргумент типа `Reducer\u003cS, A\u003e` будет представлен псевдонимом для двух конкретных типов действий, перед объявлением которых стоит обратить внимание на один относящийся к ним тонкий момент. Тонкость заключается в том, что функция-редюсер, в качестве второго параметра, может, и в большинстве случаев будет принимать объекты действий принадлежащих к разным типам. Для их конкретизации выводу типов потребуется помощь в виде дискриминантных полей.\n\n`````ts\nimport React, {useReducer, Reducer, FC} from \"react\";\n\ninterface InitialState {\n    name: string;\n    gender: number;\n    gender: `male` | `female` | `notSpecified`;\n}\ninterface State {\n    name: string;\n    gender: `male` | `female` | `notSpecified`;\n}\n\n\n/**[0] */\nenum ActionType {\n    Name = `name`,\n    Gender = `gender`,\n}\n\n/**\n * [0] определение перечисления содержащего\n * константы необходимые для конкретизации типа\n * Action.\n */\n\n\n            /**[1] */\ninterface NameAction {\n    type: ActionType.Name; /**[2] */\n    name: string; /**[3] */\n}\n            /**[1] */\ninterface GenderAction {\n    type: ActionType.Gender; /**[2] */\n    gender: `male` | `female` | `notSpecified`; /**[3] */\n}\n\n/**\n * [1] объявление более конкретных типов действий\n * объявляющий поля name и gender [3] и дискриминантное\n * поле type [2] в качестве типа которого указан элемент\n * перечисления.\n */\n\n\n/**[4] */\ntype Actions = NameAction | GenderAction;\n\n/**\n * [4] объявление псевдонима ссылающегося на\n * тип объединение представленный типами Action.\n */\n\n\n     /**[5]      [6]    [7]     [8]            [9]     [10] */\nconst reducer: Reducer\u003cState, Actions\u003e = (state, action) =\u003e {\n                /**[11] */\n    if(action.type === ActionType.Name){\n                                /**[12] */\n        return {...state, name: action.name};\n                      /**[11] */\n    }else if(action.type === ActionType.Gender){\n                                /**[12] */\n        return {...state, gender: action.gender};\n    }\n\n\n    return state;\n}\n\n/**\n * [5] определение функции редюсера сигнатура\n * которой уточняется при помощи импортированного\n * из пространства имен React обобщенного типа Reducer\u003cS, A\u003e [6]\n * в качестве первого параметра который получает тип представляющей\n * State [7], а в качестве второго тип объединение Actions [8].\n * При таком сценарии сигнатура функции в явном указании типов не нуждается [9] [10]\n * \n * Блок кода, вхождение в который возможно в результате положительного\n * результата выполнения условия на принадлежность дискриминантного поля type\n * элементу перечисления [11], подразумевает, что объект action принадлежит\n * к соответствующему типу, что позволяет обращаться к присущим только ему членам [12]\n * \n */\n`````\n\nКак было сказано ранее, сигнатура редюсера не нуждается в аннотации если его тип конкретизирован с помощью `Reducer\u003cS, A\u003e`. За этим скрывается один коварный момент. Представьте ситуацию при которой некоторое время приложение работало с состоянием определяющим `name`, а затем было принято решение изменить его на `fullName`.\n\n`````ts\n// было\n\ninterface State {\n    name: string;\n    age: number;\n}\n\ninterface NameAction {\n    type: `name`;\n    name: string;\n}\n\nconst reducer: Reducer\u003cState, NameAction\u003e = (state, action) =\u003e {\n    if(action.type === `name`){\n        return {...state, name: action.name};\n    }\n    \n    return state;\n}\n`````\n\nПосле того как тип описывающий состояние и действие претерпят изменения, неминуемо возникнет ошибка указывающая, что в действии больше нет поля `name`. Если впопыхах изменить лишь старый идентификатор `name` на новый `fullName`, то можно не заметить как значение ассоциированное с новым идентификатором определенным в объекте действия присваивается старому идентификатору определяемому в объекте нового состояния. К ошибке это не приведет, поскольку механизм распространения старого состояния `...state` наделяет новое всеми признаками необходимыми для совместимости с типом `State`. Старый идентификатор `name` в новом состоянии делает его принадлежащим к более общему типу который совместим с объектом `State`. Это неминуемо приводит к трудновыявляемому багу, поскольку значение поля `fullName` всегда будет старым.\n\n`````ts\ninterface State {\n    fullName: string; /**[0] */\n    age: number;\n}\n\ninterface NameAction {\n    type: `name`;\n    fullName: string; /**[0] */\n}\n\nconst reducer: Reducer\u003cState, NameAction\u003e = (state, action) =\u003e {\n    if(action.type === `name`){\n                        /**[1]        [2] */\n        return {...state, name: action.fullName};\n    }\n\n    return state;\n}\n\n/**\n * При изменении State и NameAction [0] ошибка\n * укажет на отсутствие поля name  в объекте\n * принадлежащего к типу NameAction [2]. Интуитивное\n * исправление лишь этой ошибки приведет к трудновыявляемому\n * багу, поскольку новое поле действия присваивается старому идентификатору [1].\n * Нужно быть внимательным, поскольку ошибки не возникнет. Причина заключается в том\n *, что распространение старой версии ...state наделяет новый объект всеми необходимыми\n * характеристиками, что бы быть совместимым с типом State. Старое поле делает из нового объекта\n * значение принадлежащие к более общему типу который совместим с типом State. Поэтому\n * ошибки связанной с неверным возвращающимся значением не возникает. Тем не менее редюсер\n * никогда не изменит значение на новое. Оно всегда будет браться из предыдущего объекта состояния.\n */\n`````\n\nВозвращаясь к основному примеру осталось определить компонент в котором и будет происходить определение элементов _Redux_. Первым делом в теле компонента определим инициализационное состояние которое с помощью функции обозначенной ранее как `stateInit` будет преобразовано в значение соответствующее типу необходимого редюсеру. Стоит заметить, что поскольку инициализационное значение в полной мере соответствует типу `InitialState` аннотация типа является излишней. При определении с помощью универсальной функции `useReducer()` элементов редакса стоит сделать акцент на отсутствии необходимости в указании аргументов типа, поскольку вывод типов будет опираться на аннотации типов параметров данного хука.\n\nОсталось последовательно изменить состояние с помощью функции `dispatch` вызов которой с объектами в точносте соответствующих типам `*Action` не вызывает никаких нареканий. Вызов с аргументом не надлежащего типа приводит к возникновению ошибки, что в свою очередь подтверждает надежность описанной логики сопряженной с хуком `useReducer()`.\n\n\n`````ts\n        /**[13]               [14] */\nconst initState = (initialState: InitialState) =\u003e {\n    let {gender, ...reducerState} = initialState;\n\n    return reducerState; /**[15] */\n};\n\nconst A: FC = () =\u003e {\n        /** [16]       [17] */\n    let initialState: InitialState = {\n        name: `noname`,\n        age: NaN,\n        gender:  `notSpecified`\n    };\n                        /**[18] */\n    let [state, dispatch] = useReducer(reducer, initialState, initState);\n\n    /**[19] */\n    dispatch({\n        type: ActionType.Name,\n        name: `superuser`\n    });\n\n    /**[19] */\n    dispatch({\n        type: ActionType.Gender,\n        gender: `male`\n    });\n\n    /**[20] */\n    dispatch({\n        type: ActionType.Gender,\n        gender: `male`,\n        age: 100\n    }); // Error -\u003e Object literal may only specify known properties, and 'age' does not exist in type 'GenderAction'.\n\n\n    return null;\n}\n\n/**\n * [14] определение инициализационного состояния которое будет\n * передано в качестве единственного аргумента [14] функции initState [13]\n * предназначенной для его трансформации в состояние пригодное редюсеру [15].\n * Данная функция вместе с редюсером и инициализационным состоянием передается\n * в универсальную функцию useReducer в качестве аргументов. Стоит заметить, что \n * универсальная функция useReducer определяющая элементы redux [18] \n * в указании аргументов типа не нуждается так как вывод типов отталкивается от\n * типов указанных в аннотациях элементов ожидаемых в качестве параметров.\n * \n * [19] успешное изменение состояния.\n * [20] попытка изменить состояние с помощью объекта тип которого не совместим\n * с типом State приводит к ошибке.\n */\n`````\n\nНе будет лишним пролить свет на подход объявления типов действий в основе которых лежит базовый тип. Подобное часто требуется для так называемых `DataAction`, действий которые помимо поля `type` определяют ещё и поле `data` с типом `T`.\n\nДля этого потребуется объявить два обобщенных типа. Первым объявим обобщенный тип `Action\u003cT\u003e`, единственный параметр типа которого будет указан в аннотации типа дискриминантного поля `type`. Вторым тип `DataAction\u003cT, D\u003e`, первый параметр типа которого будет передан при расширении в качестве аргумента типу `Action\u003cT\u003e`, а второй параметр типа будет указан в аннотации типа единственного поля `data`. Такой подход часто применяется на практике и значительно упрощает объявление типов представляющих действия предназначенных исключительно для транспортировки данных.\n\n`````ts\n/**[0] */\ninterface Action\u003cT\u003e {\n    type: T;\n}\n/**[1] */\ninterface DataAction\u003cT, D\u003e extends Action\u003cT\u003e {\n    readonly data: D;\n}\n\n/**\n * Объявление обобщенных типов действий первый из которых\n * описывает обычное действие с единственным полем\n * type: T [0], а другой расширяет первый и определяет\n * поле data: D.\n */\n\n\n\nenum ActionType {\n    Name = `name`,\n    Gender = `gender`,\n}\n\n\ninterface NameData {\n    name: string;\n}\ninterface GenderData {\n    gender: `male` | `female` | `notSpecified`;\n}\n\n\n          /**[2]                [3]            [4]          [5] */\ninterface NameAction extends DataAction\u003cActionType.Name, NameData\u003e {\n}\n          /**[2]                [3]            [4]               [5] */\ninterface GenderAction extends DataAction\u003cActionType.Gender, GenderData\u003e {\n}\n\n/**\n * [2] определение конкретных действий в основе\n * которых лежит базовый обобщенный тип DataAction\u003cT, D\u003e [3]\n * которому при расширении в качестве первого аргумента типа\n * устанавливается тип дискриминантного поля [4], а в качестве\n * второго тип представляющий данные [5].\n */\n\ntype Actions = NameAction | GenderAction;\n`````\n\nОсталось рассмотреть только случай предполагающий указания аргументов типа универсальной функции острая необходимость в которых возникнет при определении аргументов в момент вызова. В таком случае в качестве первого аргумента типа универсальная функция ожидает тип описывающий функцию редюсер, вторым инициализационное состояние. Кроме того, прибегнуть к помощи аргументов типа может потребоваться и при других сценариях рассматриваемых на всем протяжении темы посвященной хукам. Также не стоит забывать, что универсальная функция `useReducer` имеет множество перегрузок, что на практике допускает сценарии отличные от данного примера.\n\n`````ts\nimport React, {useReducer, Reducer, FC, useRef} from \"react\";\n\ninterface InitialState {\n    name: string;\n    age: number;\n    gender: `male` | `female` | `notSpecified`;\n}\ninterface State {\n    name: string;\n    gender: `male` | `female` | `notSpecified`;\n}\n\n\nenum ActionType {\n    Name = `name`,\n    Gender = `gender`,\n}\n\nenum Genders {\n    Male = `male`,\n    Female = `female`,\n    NotSpecified = `notSpecified`\n}\n\n\ninterface NameAction {\n    type: ActionType.Name;\n    name: string;\n}\ninterface GenderAction {\n    type: ActionType.Gender;\n    gender: Genders;\n}\n\n\ntype Actions = NameAction | GenderAction;\n\nconst App: FC = () =\u003e {\n                                            /**[0]                  [1] */\n    let [state, dispatch] = useReducer\u003cReducer\u003cState, Actions\u003e, InitialState\u003e(\n        (state, action) =\u003e state, /**[2] */\n        {name: ``, age: 0, gender: Genders.NotSpecified}, /**[3] */\n        (initialState) =\u003e ({name: initialState.name, gender: initialState.gender})\n    );\n\n    return null;\n}\n\n/**\n * Указание аргументов типа универсальной функции\n * требуется тогда, когда её аргументы определяются\n * при вызове. В таком случае первый аргумент типа\n * будет представлять описание [0] функции редюсера [02],\n * второй инициализационного состояния [1] [3]. Также возможны\n * и другие сценарии требующий указания аргументов типа которые \n * были затронуты ранее в теме. Кроме того, универсальная функция\n * имеет множество перегрузок допускающих отличие от данного примера. \n */\n `````"},{"key":"Типизированные хуки_4","elementId":"Predopredelennye_huki_-_useCallback\u003cT\u003e()","markdown":"## Предопределенные хуки - useCallback\u003cT\u003e()\n\nСледующий на очереди универсальный хук `useCallback\u003cT\u003e(callback: T, deps): T` рассмотрение которого можно ограничить иллюстрацией его применения, поскольку с ним не связанно ничего, что к данному моменту могло бы вызвать хоть какой-то вопрос. Другими словами, как и в остальных рассмотренных ранее случаях прибегать к помощи аргументов типа следует только тогда, когда сигнатура функции обозначенной как `callback` частично или вовсе не имеет указания типов.\n\n`````ts\nimport React, {useCallback, FC} from \"react\";\n\n\nconst A: FC = () =\u003e {\n    /**[0] */\n    const greeter = useCallback((userName: string) =\u003e {\n        return `Hello ${userName}!`;\n    }, []);\n\n    /**\n     * [0] вывод типов -\u003e\n     * \n     * const greeter: (userName: string) =\u003e string\n     */\n\n\n    return null;\n}\n\n\n\ntype Decorate = (username: string) =\u003e string;\n\nconst B: FC = () =\u003e {\n    /**[0] */\n    const greeter = useCallback\u003cDecorate\u003e( userName =\u003e {\n        return `Hello ${userName}!`;\n    }, []);\n\n    /**\n     * [0] аргумент типа -\u003e\n     * \n     * const greeter: Decorate\n     */\n\n\n    return null;\n}\n`````"},{"key":"Типизированные хуки_5","elementId":"Predopredelennye_huki_-_useRef\u003cT\u003e()","markdown":"## Предопределенные хуки - useRef\u003cT\u003e()\n\nСледующий хук `useRef\u003cT\u003e(initialValue)` является универсальной функцией предназначенной для создания объекта рефы. Поскольку объект рефы возвращаемый из данного хука может служить не только для хранения ссылок на _React элементы_ и _React компоненты_, но и на любые другие значения, которые к тому же могут выступать в качестве единственного аргумента, данная функция имеет множество перегрузок. И кроме этого на текущий момент с ней связан один нюанс. Но обо всем по порядку.\n\nВ тех случаях когда объект рефы выполняет роль хранилища для не относящихся к _React_ значений, в его определении нет ничего необычного. Простыми словами, если инициализационное значение устанавливается частично или не устанавливается вовсе, то его тип необходимо конкретизировать с помощью аргумента типа. В противном случае переложить эту работу на вывод типов.\n\n`````ts\nimport React, {useRef, FC} from \"react\";\n\ninterface Data {\n    a: number;\n    b: string;\n}\n\nconst A: FC = () =\u003e {\n                        /**[0]   [1]      [2] */\n    let dataRef = useRef\u003cPartial\u003cData\u003e\u003e({a: 0}); // let dataRef: React.MutableRefObject\u003cPartial\u003cData\u003e\u003e\n    let a = dataRef.current.a; // let a: number | undefined\n\n    return null;\n}\n\n/**\n * Поскольку значение [1] установлено частично [2]\n * возникла необходимость прибегнуть к помощи типа\n * Partial\u003cT\u003e [0].\n */\n\nconst B: FC = () =\u003e {\n                            /**[0]        [1] */\n    let dataRef = useRef\u003cData | undefined\u003e(); // let dataRef: React.MutableRefObject\u003cData | undefined\u003e\n    let a = dataRef.current?.a; // let a: number | undefined\n\n    return null;\n}\n\n/**\n * Поскольку значение [1] вовсе не было установлено\n * аргумент типа указан как объединение включающего\n * тип undefined [0].\n */\n\nconst C: FC = () =\u003e {\n           /**[0]      [1]   [2] */\n    let dataRef = useRef({a: 0, b: ``}); // let dataRef: React.MutableRefObject\u003c{a: number;b: string;}\u003e\n    let a = dataRef.current.a; // let a: number\n\n    return null;\n}\n\n/**\n * Поскольку значение [2] в полной мере соответствует\n * предполагаемому типу необходимости в конкретизации\n * типа отпадает [0] [1].\n */\n `````\n\nТакже стоит обратить внимание, что идентификатор которому в момент определения присваивается результат вызова функции `useRef()` в явной аннотации не нуждается.\n\n`````ts\nconst C: FC = () =\u003e {\n        /**[0] */\n    let dataRef = useRef({a: 0, b: ``});\n\n    return null;\n}\n\n/**\n * [0] ссылка на возвращаемый хуком useRef объект\n * в аннотации типа не нуждается. Указание аннотаций\n * типа в подобных случаях лишь отнимают время и\n * затрудняют чтение кода.\n * \n * let dataRef: React.MutableRefObject\u003c{a: number;b: string;}\u003e\n */\n`````\n\nОсталось оговорить упомянутый в самом начале нюанс который связан с объектом рефы устанавливаемого _React элементу_. Дело в том, что декларация _React элементов_, в частности поля `ref`, аннотирована устаревшим типом, который не совместим с типом значения получаемого в результате вызова хука `useRef()`. К тому же уточнение типа в аннотации идентификатора или с помощью аргументов типа универсальной функции с данной проблемой справится не помогут. Единственное решение явное приведение к типу `RefObject\u003cT\u003e` возвращаемое хуком значение с помощью оператора `as`.\n \n`````ts\nimport React, {useRef, FC, RefObject} from \"react\";\n\nconst A: FC = () =\u003e {\n    // let formRef: RefObject\u003cHTMLFormElement\u003e | null = useRef(); // Error\n    // let formRef = useRef\u003cRefObject\u003cHTMLFormElement\u003e | null\u003e(); // Error\n    let formRef = useRef() as RefObject\u003cHTMLFormElement\u003e | null; // Ok\n\n\n    return \u003cform ref={formRef}\u003e\u003c/form\u003e\n}\n`````\n\nБолее подробно с данным хуком можно познакомиться в главе посвященной рефам."},{"key":"Типизированные хуки_6","elementId":"Predopredelennye_huki_-_useImperativeHandle\u003cT,R\u003e()","markdown":"## Предопределенные хуки - useImperativeHandle\u003cT, R\u003e()\n\nСледующий на очереди хук `useImperativeHandle\u003cT, R\u003e(ref: Ref\u003cT\u003e, apiFactory() =\u003e R): void` предназначенный для присваивания объекта выступающего в роли открытой части _api_ функционального компонента. В тех случаях когда открытая часть _api_ отличается от закрытой, универсальная функция нуждается в уточнении при помощи аргументов типа. В остальных случах всегда рекомендуется поручить эту работу выводу типов. \n\n\n`````ts\nimport React, {ForwardRefRenderFunction, RefObject, useRef, useImperativeHandle, FC, forwardRef} from \"react\";\n\ninterface FormProps {\n\n}\n\n/**[0] */\ninterface PublicFormApi {\n    a: () =\u003e void;\n}\n/**[1] */\ninterface PrivateFormApi extends PublicFormApi {\n    b: () =\u003e void;\n}\n\n/**\n * [0] объявление типа представляющего открытую часть\n * api компонента, которую будет расширять объявленный\n * позже тип описывающий его закрытую часть [1].\n */\n\n\n /**\n  * \n  * [!] не обращать внимание на код\n  * помеченный восклицательным знаком,\n  * поскольку данные участи кода будут\n  * подробно рассмотрены в свое время.\n  */\n\n                    /**[!] */\nconst Form: ForwardRefRenderFunction\u003cPublicFormApi, FormProps\u003e = (props, ref) =\u003e {\n                         /**[2]             [3] */\n    useImperativeHandle\u003cPublicFormApi, PrivateFormApi\u003e(ref, () =\u003e ({\n        a: () =\u003e {},\n        b: () =\u003e {},\n    }), []);\n\n    /**\n     * С помощью аргументов типа указываем тип\n     * открытой [2] и закрытой [3] части api компонента.\n     */ \n\n\n    return null;\n}\n\n        /**[!]            [!] */\nconst FormWithRef = forwardRef(Form);\n\n\nconst App: FC = () =\u003e {\n                        /**[!] */\n    let formRef = useRef() as RefObject\u003cPublicFormApi\u003e;\n\n    formRef.current?.a(); // Ok\n    // formRef.current?.b(); // Error\n\n                     /**[6] */\n    return \u003cFormWithRef ref={formRef} /\u003e;\n}\n `````"},{"key":"Типизированные хуки_7","elementId":"Predopredelennye_huki_-_useMemo\u003cT\u003e()","markdown":"## Предопределенные хуки - useMemo\u003cT\u003e()\n\nСледующим на очереди хук `useMemo\u003cT\u003e(factory): T` является универсальной функцией ожидающей в качестве первого параметра фабричную функцию вычисляющую возвращаемое хуком значение тип которого, при необходимости, можно указать с помощью аргумента типа. Второй обязательный параметр принадлежит к типу массива, при наличии и изменении элементов которого происходит повторный вызов фабричной функции. Как всегда, стоит упомянуть, что явное указание аргумента типа универсальной функции необходимо в очень редких случаях, каждый из которых был рассмотрен на протяжении всей темы посвященной хукам. Кроме того, переменная которой присваивается возвращаемое из хука значение, в аннотации типа и вовсе не нуждается.\n\n`````ts\nimport React, {useMemo, FC} from \"react\";\n\nconst A: FC = () =\u003e {\n            /**[0]           [1] */\n    let memoizedValue = useMemo( () =\u003e 2 + 2, [] ); // let memoizedValue: number\n\n    return null;\n}\n\n/**\n * Нет необходимости указывать аннотацию\n * типа переменной [0] и передавать аргументы\n * типа [1] универсальной функции поскольку\n * вывод типов самостоятельно справится с этой работой.\n */\n `````"},{"key":"Типизированные хуки_8","elementId":"Predopredelennye_huki_-_useDebugValue\u003cT\u003e()","markdown":"## Предопределенные хуки - useDebugValue\u003cT\u003e()\n\nСледующий и последний на очереди хук `useDebugValue\u003cT\u003e(data: T, format(data: T) =\u003e any): void` предназначенный для вывода логов в _devtools_ является универсальной функцией первый параметр которой ожидает выводимое в консоль значение, чьё форматирование может быть осуществлено при помощи функции выступающей в роли второго необязательного параметра. Вся информация имеющаяся к этому моменту и касающаяся явного указания типов в полной мере справедлива и для текущего хука.\n\n `````ts\nimport React, {useDebugValue, FC} from \"react\";\n\nconst A: FC = () =\u003e {\n                    /**[0]    [1]           [2] */\n    useDebugValue(new Date(), date =\u003e date.getMilliseconds() );\n\n    return null;\n}\n\n/**\n * Хук принимает значение тпа Date [0]\n * и затем передает его в функцию форматирования [1]\n * из которой возвращается значение принадлежащее к\n * типу number [2].\n */\n`````"},{"key":"Типизированные хуки_9","elementId":"Polzovatelskii_huk","markdown":"## Пользовательский хук\n\nПомимо предопределенных хуков рассмотренных ранее, _React_ также позволяет определять пользовательские хуки, которым будет посвящен остаток текущей главы.\n\nЧтобы стразу перейти к делу представьте, что перед разработчиком встала задача реализовать эффект печатающегося текста с возможностью его запускать, останавливать и ставить на паузу при необходимости. Для этого потребуется реализовать пользовательский хук `usePrintText(text, interval)`, который на вход будет принимать исходный текс и значение скорости печати. Поскольку печатающийся текст будет реализован за счет постепенного изменения состояния определенного внутри хука и выдаваемого наружу, начать стоит именно с описания его типа.\n\n`````ts\n/**описание объекта состояния */\ninterface TextPrintInfo {\n    isDone: boolean;\n    status: TextPrintStatus;\n    currentText: string;\n    sourceText: string;\n}\n`````\n\nКроме состояния, хук должен предоставлять функции выступающие в роли контролов предназначенных для управления анимацией печатанья. Поэтому вторым шагом потребуется описать тип представляющих контролы, что совершенно не составит никакого труда, так как старт\\пауза\\стоп являются обычными функциями которые ничего не возвращают.\n\n`````ts\n/**описание типа контролов старт\\пауза\\стоп */\ntype ControlCallback = () =\u003e void;\n`````\n\nОсталось описать тип представляющий сам хук или если быть точнее, сигнатуры функции, которой по сути он является. Особое внимание стоит обратить на возвращаемый тип представленный размеченным кортежем, для которого несмотря на большое количество кода не был создан псевдоним. Такое решение было принято из-за того, что автокомплит _ide_ указал бы возвращаемый тип как псевдоним, сделав тем самым подсказку малоинформативной, лишив её информации, доступной благодаря меткам.\n\n`````ts\n        /**[0]                                               [1] */\ntype UsePrintText = (sourceText: string, interval?: number) =\u003e [\n    textInfo: TextPrintInfo,\n    start: ControlCallback,\n    pause: ControlCallback,\n    stop: ControlCallback\n];\n\n/**\n * [0] тип представляющий пользовательский хук,\n * тип возвращаемого значения представлен размеченным кортежем [1]\n */\n `````\n\n Осталось лишь определить сам хук. \n\n`````ts\ninterface TextPrintInfo {\n    isDone: boolean;\n    status: TextPrintStatus;\n    currentText: string;\n    sourceText: string;\n}\n\ntype ControlCallback = () =\u003e void;\n\ntype UsePrintText = (sourceText: string, interval?: number) =\u003e [\n    textInfo: TextPrintInfo,\n    start: ControlCallback,\n    pause: ControlCallback,\n    stop: ControlCallback\n];\n\n\n\nconst usePrintText: UsePrintText = (sourceText, interval = 200) =\u003e {\n    // определение состояния\n    let [textInfo, setTextInfo] = useState({\n        isDone: false,\n        status: TextPrintStatus.Waiting,\n        currentText: ``,\n        sourceText,\n    });\n\n\n    // определение контролов\n    const start = () =\u003e {\n    }\n    const pause = () =\u003e {\n    }\n    const stop = () =\u003e {\n    }\n\n\n    return [textInfo, start, pause, stop];\n}\n`````\n\nПоскольку логика работы хука не имеет никакого отношения к _TypeScript_, её детального разбора не будет. Тем не менее полный код представлен и при желании испытать свои знания, предлагается самостоятельно устно его прокомментировать. \n\n`````ts\nimport React, { useState, useEffect } from \"react\";\n\nenum TextPrintStatus {\n    Print = `print`,\n    Waiting = `waiting`,\n    Pause = `pause`,\n    Done = `done`\n}\n\ninterface TextPrintInfo {\n    isDone: boolean;\n    status: TextPrintStatus;\n    currentText: string;\n    sourceText: string;\n}\n\ntype ControlCallback = () =\u003e void;\ntype UsePrintText = (sourceText: string, interval?: number) =\u003e [\n    textInfo: TextPrintInfo,\n    start: ControlCallback,\n    pause: ControlCallback,\n    stop: ControlCallback\n];\n\nconst usePrintText: UsePrintText = (sourceText, interval = 200) =\u003e {\n    let [timeoutId, setTimeoutId] = useState(NaN);\n    let [textInfo, setTextInfo] = useState({\n        isDone: false,\n        status: TextPrintStatus.Waiting,\n        currentText: ``,\n        sourceText,\n    });\n\n\n    const isDone = () =\u003e textInfo.currentText.length === sourceText.length;\n    const getNextText = () =\u003e textInfo.currentText.concat(sourceText.charAt(textInfo.currentText.length));\n\n    useEffect(() =\u003e {\n        if (textInfo.status === TextPrintStatus.Print \u0026\u0026 !textInfo.isDone) {\n            print();\n        }\n\n    }, [textInfo]);\n\n    useEffect(() =\u003e () =\u003e cancel(), []);\n\n\n    const print = () =\u003e {\n        let timeoutId = setTimeout(() =\u003e {\n            setTextInfo({\n                status: isDone() ? TextPrintStatus.Done : TextPrintStatus.Print,\n                isDone: isDone(),\n                currentText: getNextText(),\n                sourceText\n            });\n        }, interval);\n\n        setTimeoutId(timeoutId);\n    }\n\n    const cancel = () =\u003e {\n        if (!Number.isNaN(timeoutId)) {\n            clearTimeout(timeoutId);\n        }\n    }\n    const start = () =\u003e {\n        setTextInfo({\n            ...textInfo,\n            status: TextPrintStatus.Print,\n        });\n    }\n    const pause = () =\u003e {\n        cancel();\n        setTextInfo({\n            ...textInfo,\n            status: TextPrintStatus.Pause,\n            isDone: false,\n        });\n        setTimeoutId(NaN);\n    }\n    const stop = () =\u003e {\n        cancel();\n        setTextInfo({\n            isDone: false,\n            status: TextPrintStatus.Waiting,\n            currentText: ``,\n            sourceText\n        });\n        setTimeoutId(NaN);\n    }\n\n\n    return [textInfo, start, pause, stop];\n}\n\n\n\nconst App = () =\u003e {\n    let [{currentText}, start, pause, stop] = usePrintText(`React + TypeScript = ♥`);\n\n\n    return (\n        \u003c\u003e\n            \u003cp\u003e{currentText}\u003c/p\u003e\n            \u003cbutton onClick={() =\u003e start()}\u003estart\u003c/button\u003e\n            \u003cbutton onClick={() =\u003e pause()}\u003epause\u003c/button\u003e\n            \u003cbutton onClick={() =\u003e stop()}\u003estop\u003c/button\u003e\n        \u003c/\u003e\n    )\n}\n`````"}],"githubFileInfo":{"lastUpdate":1617711223000,"contributorAll":[{"name":"nauchikus","avatar":"https://avatars.githubusercontent.com/u/31518738?v=4","bio":"@TechnoFanatic(\"🍬\")\r\n","githubUrl":"https://github.com/nauchikus"}]},"pageNav":{"isPrevPage":true,"isNextPage":true,"prevPage":{"title":"Универсальные компоненты","path":"Universalnye_komponenty"},"nextPage":{"title":"Контекст (Context)","path":"Kontekst_(Context)"}},"contentNavData":{"key":"Типизированные хуки","level":0,"index":54,"contentIndex":0,"section":"React","title":"Типизированные хуки","path":"Tipizirovannye_huki","elementId":"Tipizirovannye_huki","children":[{"key":"Типизированные хуки_0","index":0,"contentIndex":1,"level":1,"section":"React","title":"Предопределенные хуки - useState\u003cT\u003e()","path":"Predopredelennye_huki_-_useState\u003cT\u003e()","elementId":"Predopredelennye_huki_-_useState\u003cT\u003e()"},{"key":"Типизированные хуки_1","index":1,"contentIndex":2,"level":1,"section":"React","title":"Предопределенные хуки - useEffect() и useLayoutEffect()","path":"Predopredelennye_huki_-_useEffect()_i_useLayoutEffect()","elementId":"Predopredelennye_huki_-_useEffect()_i_useLayoutEffect()"},{"key":"Типизированные хуки_2","index":2,"contentIndex":3,"level":1,"section":"React","title":"Предопределенные хуки - useContext\u003cT\u003e()","path":"Predopredelennye_huki_-_useContext\u003cT\u003e()","elementId":"Predopredelennye_huki_-_useContext\u003cT\u003e()"},{"key":"Типизированные хуки_3","index":3,"contentIndex":4,"level":1,"section":"React","title":"Предопределенные хуки - useReducer\u003cR\u003e()","path":"Predopredelennye_huki_-_useReducer\u003cR\u003e()","elementId":"Predopredelennye_huki_-_useReducer\u003cR\u003e()"},{"key":"Типизированные хуки_4","index":4,"contentIndex":5,"level":1,"section":"React","title":"Предопределенные хуки - useCallback\u003cT\u003e()","path":"Predopredelennye_huki_-_useCallback\u003cT\u003e()","elementId":"Predopredelennye_huki_-_useCallback\u003cT\u003e()"},{"key":"Типизированные хуки_5","index":5,"contentIndex":6,"level":1,"section":"React","title":"Предопределенные хуки - useRef\u003cT\u003e()","path":"Predopredelennye_huki_-_useRef\u003cT\u003e()","elementId":"Predopredelennye_huki_-_useRef\u003cT\u003e()"},{"key":"Типизированные хуки_6","index":6,"contentIndex":7,"level":1,"section":"React","title":"Предопределенные хуки - useImperativeHandle\u003cT, R\u003e()","path":"Predopredelennye_huki_-_useImperativeHandle\u003cT,R\u003e()","elementId":"Predopredelennye_huki_-_useImperativeHandle\u003cT,R\u003e()"},{"key":"Типизированные хуки_7","index":7,"contentIndex":8,"level":1,"section":"React","title":"Предопределенные хуки - useMemo\u003cT\u003e()","path":"Predopredelennye_huki_-_useMemo\u003cT\u003e()","elementId":"Predopredelennye_huki_-_useMemo\u003cT\u003e()"},{"key":"Типизированные хуки_8","index":8,"contentIndex":9,"level":1,"section":"React","title":"Предопределенные хуки - useDebugValue\u003cT\u003e()","path":"Predopredelennye_huki_-_useDebugValue\u003cT\u003e()","elementId":"Predopredelennye_huki_-_useDebugValue\u003cT\u003e()"},{"key":"Типизированные хуки_9","index":9,"contentIndex":10,"level":1,"section":"React","title":"Пользовательский хук","path":"Polzovatelskii_huk","elementId":"Polzovatelskii_huk"}]},"pageDescription":"Типизированные хуки"},"__N_SSG":true},"page":"/book/chapters/[chapterId]","query":{"chapterId":"Tipizirovannye_huki"},"buildId":"LQJahi8Ij0C55Zfw8IHrX","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>