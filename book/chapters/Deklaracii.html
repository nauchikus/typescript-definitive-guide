<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><script async="" type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/be7e0732075170e4249d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/be7e0732075170e4249d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-0e3c274fd8419109d37b.js" defer=""></script><script src="/_next/static/chunks/framework-2f612445bd50b211f15a.js" defer=""></script><script src="/_next/static/chunks/main-bae6c3d363e548fddd65.js" defer=""></script><script src="/_next/static/chunks/pages/_app-7389b94ba72d4b11a409.js" defer=""></script><script src="/_next/static/chunks/698-debec62034f2b0a49149.js" defer=""></script><script src="/_next/static/chunks/950-89b787edb52e4b1eb040.js" defer=""></script><script src="/_next/static/chunks/222-403d02ae2b812f34e8e4.js" defer=""></script><script src="/_next/static/chunks/460-d0b4dd1b0673465da22c.js" defer=""></script><script src="/_next/static/chunks/763-b007244d3307e1e9232d.js" defer=""></script><script src="/_next/static/chunks/211-767912ba0b0950a1ff12.js" defer=""></script><script src="/_next/static/chunks/803-206cd39b15ff01ea9024.js" defer=""></script><script src="/_next/static/chunks/pages/book/chapters/%5BchapterId%5D-c88c0524de3ed6b9e5be.js" defer=""></script><script src="/_next/static/cbe9-89I59uFf1Y2O6Od-/_buildManifest.js" defer=""></script><script src="/_next/static/cbe9-89I59uFf1Y2O6Od-/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="base-layout"><div></div><header class="app-header app-header-grid"><div class="app-header-grid-item__driver-toggle"><button class="app-driver-toggle-btn"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="svg-icon"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M3 21h18v-2H3v2zM3 8v8l4-4-4-4zm8 9h10v-2H11v2zM3 3v2h18V3H3zm8 6h10V7H11v2zm0 4h10v-2H11v2z"></path></svg></button></div><div class="app-header-grid-item__logo"><span role="img" tabindex="-1" class="anticon app-logo"><svg id="logo_app_svg__Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 119.45 44" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><defs><style>.logo_app_svg__cls-2{fill:#1d1d1b}</style></defs><g id="logo_app_svg__logo"><path id="logo_app_svg__logo_t" d="M38.41 3v8.11H25.67v34.1h-9.5V11.08H3.43V3z" transform="translate(-3.43 -2)" fill="#3273b9"></path><path id="logo_app_svg__logo_g" class="logo_app_svg__cls-2" d="M63.7 10.29q-6.63 0-9.6 3.69c-2 2.45-3 5.82-3 10.08a20.23 20.23 0 00.73 5.64 12.6 12.6 0 002.19 4.36 10 10 0 003.66 2.83 12.18 12.18 0 005.12 1c1.06 0 2 0 2.71-.07a13.08 13.08 0 002-.24V22.9h9.51v20.91a37.27 37.27 0 01-5.48 1.43 48.07 48.07 0 01-9.33.76 24.32 24.32 0 01-8.62-1.46A18.13 18.13 0 0147 40.27a19 19 0 01-4.23-6.89 26.92 26.92 0 01-1.49-9.32 25 25 0 011.64-9.39 20.25 20.25 0 014.51-6.91 19.11 19.11 0 016.74-4.3A23.25 23.25 0 0162.42 2a34 34 0 015.4.39 34.4 34.4 0 014.18.92 18.52 18.52 0 012.87 1.07 18 18 0 011.61.85l-2.78 7.62a24.88 24.88 0 00-4.48-1.8 19 19 0 00-5.52-.76z" transform="translate(-3.43 -2)"></path><path id="logo_app_svg__logo_d" class="logo_app_svg__cls-2" d="M122.88 24.06a24.63 24.63 0 01-1.71 9.57 17.6 17.6 0 01-4.84 6.76 20.69 20.69 0 01-7.65 4 35.63 35.63 0 01-10.12 1.34q-2.55 0-6-.22a48 48 0 01-6.7-.88V3.52a56.55 56.55 0 016.85-.82q3.57-.21 6.13-.21a36.72 36.72 0 019.84 1.22 20.22 20.22 0 017.59 3.83 17.06 17.06 0 014.87 6.71 25.33 25.33 0 011.74 9.81zM95.39 37.47q.67.06 1.56.09t2.1 0q7.13 0 10.57-3.59t3.45-9.94q0-6.64-3.29-10.06t-10.43-3.38h-2a16.72 16.72 0 00-2 .16z" transform="translate(-3.43 -2)"></path></g></svg></span></div><div class="app-header-grid-item__search"><form class="search" autoComplete="off" action="#"><button class="search__submit-button-placeholder button-with-svg-icon"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="svg-icon search__search-svg-icon"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0016 9.5 6.5 6.5 0 109.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg></button><input type="search" class="search__query-input" id="algolia-search" name="app-search-query" placeholder="search..." required=""/></form></div><div class="app-header-grid-item__secondary-bar"><nav class="app-link-bar"><ul class="menu app-link-bar__menu"><li><a class="link svg-link-btn app-link-bar__icon-btn" href="" title="Следить за выходом новых версий в Telegram" target="_blank"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414" class="svg-icon"><path d="M18.384 22.779a1.19 1.19 0 001.107.145 1.16 1.16 0 00.724-.84C21.084 18 23.192 7.663 23.983 3.948a.78.78 0 00-.26-.758.8.8 0 00-.797-.14C18.733 4.602 5.82 9.447.542 11.4a.827.827 0 00-.542.799c.012.354.25.661.593.764 2.367.708 5.474 1.693 5.474 1.693s1.452 4.385 2.209 6.615c.095.28.314.5.603.576a.866.866 0 00.811-.207l3.096-2.923s3.572 2.619 5.598 4.062zm-11.01-8.677l1.679 5.538.373-3.507 10.185-9.186a.277.277 0 00.033-.377.284.284 0 00-.376-.064L7.374 14.102z"></path></svg></a></li><li><a class="link svg-link-btn app-link-bar__icon-btn" href="" title="Посетить Github" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="svg-icon app-link-bar__github-svg-icon"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"></path></svg></a></li></ul></nav></div><div class="app-header-grid-item__primary-bar"><div class="dropdown app-nav__dropdown"><button class="dropdown__toggle app-nav__dropdown-toggle_adaptive"><svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" class="svg-icon"><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"></path></svg></button><div class="dropdown__menu app-nav__dropdown-menu_adaptive"><div class="flat-panel"><div class="app-nav__link-bar app-nav__link-bar_adaptive"><nav class="app-link-bar"><ul class="menu app-link-bar__menu"><li><a class="link svg-link-btn app-link-bar__icon-btn" href="" title="Следить за выходом новых версий в Telegram" target="_blank"><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.414" class="svg-icon"><path d="M18.384 22.779a1.19 1.19 0 001.107.145 1.16 1.16 0 00.724-.84C21.084 18 23.192 7.663 23.983 3.948a.78.78 0 00-.26-.758.8.8 0 00-.797-.14C18.733 4.602 5.82 9.447.542 11.4a.827.827 0 00-.542.799c.012.354.25.661.593.764 2.367.708 5.474 1.693 5.474 1.693s1.452 4.385 2.209 6.615c.095.28.314.5.603.576a.866.866 0 00.811-.207l3.096-2.923s3.572 2.619 5.598 4.062zm-11.01-8.677l1.679 5.538.373-3.507 10.185-9.186a.277.277 0 00.033-.377.284.284 0 00-.376-.064L7.374 14.102z"></path></svg></a></li><li><a class="link svg-link-btn app-link-bar__icon-btn" href="" title="Посетить Github" target="_blank"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" class="svg-icon app-link-bar__github-svg-icon"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23A11.509 11.509 0 0112 5.803c1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"></path></svg></a></li></ul></nav></div><div class="divide-full_x app-nav__divide_adaptive"></div><div class="app-nav__nav"><nav class="app-nav"><ul class="menu app-nav__menu_adaptive"><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/">Главная</a></li><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/book/chapters">Оглавление</a></li><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/what-is-new">Что нового?</a></li><li class="menu-item app-nav__menu-item_adaptive"><a class="link" href="/pdf">Скачать Pdf</a></li></ul></nav></div></div></div></div></div></header><div class="layer slide-layer" toggle="false"><div class="slide-layer__driver"><div class="slide-layer__fixed-driver"><div class="driver"><div class="layer driver-content-nav"><ul class="ant-menu ant-menu-root ant-menu-inline ant-menu-light driver-content-nav__menu" role="menu" tabindex="0" data-menu-list="true"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="none"><div role="menuitem" style="padding-left:24px" class="ant-menu-submenu-title" tabindex="-1" aria-expanded="true" aria-haspopup="true"><span class="ant-menu-title-content">Содержание</span><i class="ant-menu-submenu-arrow"></i></div><ul class="ant-menu ant-menu-sub ant-menu-inline" data-menu-list="true"><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Deklaracii#Chto_takoe_deklaraciya_(Declaration)">Что такое декларация (Declaration)</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Deklaracii#Ustanovka_deklaracii_s_pomoshchu_@types">Установка деклараций с помощью @types</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Deklaracii#Podgotovka_k_sozdaniu_deklaracii">Подготовка к созданию декларации</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Deklaracii#Raznovidnosti_deklaracii">Разновидности деклараций</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Deklaracii#Deklaracii_i_oblast_vidimosti">Декларации и область видимости</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Deklaracii#Deklaracii_dlya_bibliotek_s_odnoi_tochkoi_vhoda">Декларации для библиотек с одной точкой входа</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Deklaracii#Deklaracii_dlya_bibliotek_s_mnojestvom_tochek_vhoda">Декларации для библиотек с множеством точек входа</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Deklaracii#Sozdanie_deklaracii_vruchnuu">Создание деклараций вручную</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Deklaracii#Direktiva_s_troinym_sleshem_(triple-slash_directives)">Директива с тройным слешем (triple-slash directives)</a></span></li><li role="menuitem" tabindex="-1" style="padding-left:48px" class="ant-menu-item ant-menu-item-only-child"><span class="ant-menu-title-content"><a href="/book/chapters/Deklaracii#Importirovanie_deklaracii_(import)">Импортирование декларации (import)</a></span></li></ul></li></ul><div style="display:none" aria-hidden="true"></div></div></div></div></div><div class="slide-layer__first-empty"></div><div class="slide-layer__content"><div class="content-box"><div class="content-box__page-nav content-box__page-nav_left"><div class="page-nav__bar page-nav__bar_left"><button type="button" class="ant-btn ant-btn-primary ant-btn-icon-only page-nav__btn"><span role="img" aria-label="left" class="anticon anticon-left"><svg viewBox="64 64 896 896" focusable="false" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></span></button></div></div><main id="content" class="content-box__html"><aside><div class="github-file-info-bar"><div class="github-file-info-bar__section github-file-info-bar__section_contributors"><span class="github-file-info-bar__label">Контрибьютеры</span><div class="ant-avatar-group"><a href="https://github.com/nauchikus" target="_blank" class="ant-btn ant-btn-circle github-file-info-bar__avatar-btn"><span class="ant-avatar ant-avatar-circle ant-avatar-image"><img src="https://avatars.githubusercontent.com/u/31518738?v=4"/></span></a></div></div><div class="github-file-info-bar__section github-file-info-bar__section_update-info"><span class="github-file-info-bar__label">Обновлено</span><span class="github-file-info-bar__label_date">10/10/2021</span></div></div></aside><section id="Deklaracii" class="content__section"><h1 class="content__heading">Декларации</h1>
<p>Декларации это очень важная часть <em>TypeScript</em> благодаря которой магия статической типизации проецируется на динамический <em>JavaScript</em>. Поэтому декларациям будет посвящена вся данная глава, рекомендуемая тем, кто только собирается писать свою первую типизированную библиотеку, которую планируется распространять с помощью <em>npm</em> репозитория.</p></section><section id="Chto_takoe_deklaraciya_(Declaration)" class="content__section"><h2 class="content__heading">Что такое декларация (Declaration)</h2>
<p>Поскольку при разработке программ на <em>TypeScript</em> используются библиотеки написанные на <em>JavaScript</em>, компилятор <em>tsc</em>, чьей главной задачей является проверка типов, чувствует себя будто у него завязаны глаза. Несмотря на то, что с каждой новой версией вывод типов все лучше и лучше учится разбирать <em>JavaScript</em>, до идеала ещё далеко. Кроме того, разбор <em>JavaScript</em> кода добавляет нагрузку на процессор, драгоценного время которого при разработке современных приложений, порой и так не достаточно.</p>
<p><em>TypeScript</em> решил эту проблему за счет подключения к проекту заранее сгенерированных им или создаваемых вручную разработчиками деклараций. Декларации размещаются в файлах с расширением <code class="content__code_inline">.d.ts</code> и состоят только из объявлений типов полностью повторяющих программу до момента компиляции при которой она была лишена всех признаков типизации.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Файл </span><span class="token maybe-class-name">Animal</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Animal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>   </span><span class="token" style="color:#07a">public</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#690">&#x27;animal&#x27;</span><span class="token" style="color:#999">;</span><span>
</span>
<span>   </span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#DD4A68">voice</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>Файл </span><span class="token maybe-class-name">Animal</span><span class="token" style="color:#999">.</span><span class="token property-access">d</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;Animal&quot;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>   </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Animal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>       name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>       </span><span class="token" style="color:#DD4A68">voice</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">;</span><span>
</span><span>   </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Еще не забыты дни, когда для часто используемых библиотек приходилось писать декларации вручную, при чем они часто содержали ошибки. Кроме этого, декларации не успевали обновляться под постоянно развивающиеся библиотеки. Сейчас такие проблемы кажутся уже нереальными, но несмотря на это, до сих пор приходится прибегать к использованию менеджера деклараций, который был создан в те самые далекие времена.</p></section><section id="Ustanovka_deklaracii_s_pomoshchu_@types" class="content__section"><h2 class="content__heading">Установка деклараций с помощью @types</h2>
<p>Если декларация распространяется отдельно от библиотеки, то она скорее всего, попадет в огромный репозиторий на <em>github</em> под названием <em>DefinitelyTyped</em> содержащий огромное количество деклараций. Чтобы было проще ориентироваться в этом множестве, помимо сайта <a href="https://microsoft.github.io/TypeSearch/">&quot;TypeSearch&quot;</a> выступающего в роли поисковика, был создан менеджер деклараций под названием <em>Typed</em>. Но о нем мы говорить не будем поскольку он применяется при работе с <em>TypeScript</em> версии меньше чем <em>v2.0</em>, поэтому речь пойдет о его развитии в образе команды пакетного менеджера <em>npm</em>, а именно <em>@types</em>.</p>
<p>Для того, что бы установить требующуюся декларацию, в терминале необходимо выполнить команду, часть которой состоит из директивы <code class="content__code_inline">@types</code>, после которой через косую черту <code class="content__code_inline">/</code> следует имя библиотеки.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_sh"><span class="content_code-label_lang">sh</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-sh" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>npm i -D @types/name</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_sh"></div></div>
<p>Для примера, воспользуемся проектом созданным в теме посвященной настройки рабочего окружения и для демонстрации работы директивы <code class="content__code_inline">@types</code> установим всем известную библиотеку <em>React</em>.</p>
<p>Первым делом установим саму библиотеку <em>React</em> выполнив в терминале, запущенным из-под директории проекта, следующую команду.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_sh"><span class="content_code-label_lang">sh</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-sh" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>npm i -D react</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_sh"></div></div>
<p>Открыв директорию <code class="content__code_inline">/node_modules/</code> можно убедиться, что библиотека <em>React</em> успешно установлена, поэтому сразу же попытаемся импортировать её в файл <code class="content__code_inline">index.js</code> расположенным в директории <em>src</em>, предварительно изменив его расширение на требуемое для работы с <em>React</em> — <code class="content__code_inline">.tsx</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// @filename: src/index.js</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">React</span><span class="token imports" style="color:#999">,</span><span class="token imports"> </span><span class="token imports" style="color:#999">{</span><span class="token imports maybe-class-name">Component</span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;react&#x27;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Несмотря на установленную на предыдущем шаге библиотеку <em>React</em>, при попытке импортировать её модули возникла ошибка. Возникла она потому, что компилятору <em>TypeScript</em> ничего не известно о библиотеке <em>React</em>, поскольку декларация описывающая типы поставляется отдельно от неё. Чтобы <em>tsc</em> понял, что от него хотят, требуется дополнительно установить декларацию при помощи команды <code class="content__code_inline">@types</code> пакетного менеджера <code class="content__code_inline">npm</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_sh"><span class="content_code-label_lang">sh</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-sh" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>npm i -D @types/react</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_sh"></div></div>
<p>Ошибка, возникающая при импорте модулей <em>React</em> исчезла, а если заглянуть в директорию <code class="content__code_inline">_/node_modules/</code>, то можно увидеть новую примечательную поддиректорию <code class="content__code_inline">/@types</code> предназначенную для хранения устанавливаемых с помощью опции <code class="content__code_inline">@types</code> декларации.</p>
<p>Но для полноты картины и этого недостаточно. Для того, что бы добавить наш компонент в dom-дерево, необходимо установить <em>ReactDOM</em>, который уже давно развивается отдельной библиотекой.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_sh"><span class="content_code-label_lang">sh</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-sh" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>npm i -D react-dom</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_sh"></div></div>
<p>Кроме того, нужно установить необходимую для работы с ним декларацию.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_sh"><span class="content_code-label_lang">sh</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-sh" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>npm i -D @types/react-dom</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_sh"></div></div>
<p>Осталось только активировать опцию <code class="content__code_inline">--jsx</code> в <code class="content__code_inline">_tsconfig.json</code> и скомпилировать проект, как это было показано ранее.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">React</span><span class="token imports" style="color:#999">,</span><span class="token imports"> </span><span class="token imports" style="color:#999">{</span><span class="token imports maybe-class-name">Component</span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;react&#x27;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span class="token imports"> </span><span class="token imports module" style="color:#07a">as</span><span class="token imports"> </span><span class="token imports maybe-class-name">ReactDOM</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;react-dom&#x27;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">const</span><span> </span><span class="token function-variable maybe-class-name" style="color:#DD4A68">HelloReact</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span> </span><span class="token arrow" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>h1</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token maybe-class-name">Hello</span><span> react</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">!</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>h1</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token maybe-class-name">ReactDOM</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">render</span><span class="token" style="color:#999">(</span><span>
</span><span>  </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token maybe-class-name">HelloReact</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token dom" style="color:#e90">document</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">querySelector</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;#root&#x27;</span><span class="token" style="color:#999">)</span><span>
</span><span></span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><section id="Podgotovka_k_sozdaniu_deklaracii" class="content__section"><h2 class="content__heading">Подготовка к созданию декларации</h2>
<p>Помимо того, что декларацию можно написать руками, её также можно сгенерировать автоматически, при условии, что код написан на <em>TypeScript</em>. Для того, что бы <em>tsc</em> при компиляции генерировал декларации, нужно активировать опцию компилятора <code class="content__code_inline">--declaration</code>.</p>
<p>Будет не лишним напомнить, что декларацию нужно генерировать только тогда, когда библиотека полностью готова. Другими словами, активировать опцию <code class="content__code_inline">--declaration</code> нужно в конфигурационном файле <em>production</em> сборки. Кроме того, в декларации нуждается только код, который будет собран в подключаемую библиотеку. Поэтому точкой входа в библиотеку должен быть файл, который содержит только импорты нужных модулей. Но разработка библиотеки невозможна без её запуска, а значит и точки входа в которой будет создан и инициализирован её экземпляр. Поэтому, что бы избежать чувства «что-то пошло не так», необходимо помнить, что при создании библиотеки требующей декларацию, в проекте может быть несколько точек входа. Точкой входа самого компилятора, служит конфигурационный файл который ему был установлен при запуске. Это означает, что если проект находится в директории <code class="content__code_inline">src</code>, то в декларации путь будет указан как <code class="content__code_inline">src/libName</code> вместо требуемого <code class="content__code_inline">lib</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Ожидается</span><span>
</span>
<span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;libName&quot;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:slategray">//...</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Есть</span><span>
</span>
<span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;src/libName&quot;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:slategray">//...</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Это в свою очередь означает, что при импорте модулей придется учитывать лишнюю директорию.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Ожидается</span><span>
</span>
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#999">{</span><span class="token imports">libName</span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;libName&#x27;</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Есть</span><span>
</span>
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#999">{</span><span class="token imports">libName</span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;src/libName&#x27;</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Это проблему можно решить, разместив конфигурационный файл в директории исходного кода, в нашем случае это директория <code class="content__code_inline">src</code>. Кто-то не придаст этому значение, кому-то это может показаться неэстетичным. Поэтому при рассмотрении генерации деклараций с помощью <em>tsc</em>, конфигурационный файл будет лежать непосредственно в директории <code class="content__code_inline">src</code>. Но при рассмотрении генерации деклараций с помощью сторонних библиотек, будет освещен альтернативный вариант.</p>
<p>Но и это ещё не все. Представьте, что Вы создаете библиотеку <em>React</em>, которая в коде представляется одноимённым классом расположенном в файле <code class="content__code_inline">React.ts</code>. При этом модуль, который будет представлять вашу библиотеку должен называться <code class="content__code_inline">react</code>, что в свою очередь обязывает задать имя файлу являющегося точкой входа как `react.js. Ну и, что спросите вы? Если вы ещё не знаете ответ на этот вопрос, то будете удивлены, узнав, что существуют операционные системы, как, например, <em>Windows</em>, которые расценивают пути до файлов <em>React.ts</em> и <em>react.ts</em> идентичными. Простыми словами если в директории присутствует файл с идентификатором <em>Identifier</em>, то ОС просто не позволит создать одноимённый файл, даже если его символы будут отличаться регистром. Именно об этом и будет сказано в ошибке, возникающей когда <em>TypeScript</em> обнаружит одноимённые файлы в одной директории. Кроме того, если ваша операционная система позволяет создавать файлы чьи идентификаторы отличаются только регистром, помните, что разработчик работающий с вами в одной команде не сможет даже установить проект себе на машину, если его операционная система работает по другим правилам.</p>
<p>Поэтому решений у этой проблемы, на самом деле, всего два. Задавать идентификаторы отличающиеся не только регистром. Или же размещать файлы таким образом, что бы их идентификаторы не пересекались в одной директории. Но при этом нужно помнить, что структура модулей также изменится.</p>
<p>И поскольку <em>TypeScript</em> является компилируемым языком, не будет лишним напомнить правила именования директории в которую будет компилироваться результат. В случае разработки приложения, директорию содержащую скомпилированный результат принято называть <em>dest</em> (сокращение от слова <em>destination</em>). При разработке внешней библиотеки или фреймворка, директорию для собранных файлов принято называть <em>dist</em> (сокращение от слова <em>distributive</em>).</p></section><section id="Raznovidnosti_deklaracii" class="content__section"><h2 class="content__heading">Разновидности деклараций</h2>
<p>На самом деле это глава должна называться «разновидности библиотек», так как именно о них и пойдет речь. Дело в том, что совсем недавно вершиной хорошего тона считалось объединение всего кода в один файл. Это же правило соблюдалось и при создании библиотек. Но сейчас все кардинально поменялось, и дело вот в чем.</p>
<p>В мире <em>JavaScript</em> существует большое количество библиотек, чей размер по меркам клиентских приложений превышает разумный. При этом отказ от них будет означать, что вам самому придется тратить драгоценное время на реализацию части их функционала. Это побудило создателей сборщиков наделять свои творения механизмом называющимся <em>Tree Shaking</em>.</p>
<p><em>Tree Shaking</em> — это механизм позволяющий включать в сборку исключительно используемый код. Простыми словами, данный механизм позволяет взять только используемую часть от всей библиотеки. В перспективе это должно быть спасением, но на деле оказалось не совсем так.</p>
<p>Дело в том, что на данный момент <em>Tree Shaking</em> работает только если библиотека разбита на множество модулей. К примеру такие именитые библиотеки, как <em>lodash</em> или <em>rxjs</em>, для каждой отдельной функции создают отдельную точку входа, что при их использовании позволят значительно сократить размер конечного кода. Обозначим подобные библиотеки, как библиотеки с множеством точек входа. Кроме того, существуют библиотеки сопоставимые с монолитом, поскольку при использовании их малой части в конечную сборку они попадают целиком. Обозначим такие библиотеки, как библиотеки с единственной точкой входа.</p></section><section id="Deklaracii_i_oblast_vidimosti" class="content__section"><h2 class="content__heading">Декларации и область видимости</h2>
<p>Важным моментом при создании деклараций для библиотек является понимание того, как их трактует компилятор. Дело в том, что все доступные компилятору декларации находятся в общей для всех области видимости. Это означает, что они так же, как переменные, функции и классы способны затенять или другими словами, перекрывать друг друга. Кроме того, идентификатор файла не играет никакой роли, поскольку компилятор рассматривает только определение деклараций с помощью ключевого слова <code class="content__code_inline">declare</code>. Проще говоря, два файла имеющие отличные идентификаторы, но идентичные объявления, будут затенять друг друга.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл ./types/petAnimal.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;Pig&quot;</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:slategray">// Error</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Pig</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;Goat&quot;</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:slategray">// Error</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Goat</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;petAnimal&quot;</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">default</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">as</span><span class="token exports"> </span><span class="token exports maybe-class-name">Pig</span><span class="token exports"> </span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;Pig&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">default</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">as</span><span class="token exports"> </span><span class="token exports maybe-class-name">Goat</span><span class="token exports"> </span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;Goat&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл ./types/wildAnimal.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;Pig&quot;</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:slategray">// Error</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Pig</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;Goat&quot;</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:slategray">// Error</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Goat</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;wildAnimal&quot;</span><span> </span><span class="token" style="color:#999">{</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">default</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">as</span><span class="token exports"> </span><span class="token exports maybe-class-name">Pig</span><span class="token exports"> </span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;Pig&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">default</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">as</span><span class="token exports"> </span><span class="token exports maybe-class-name">Goat</span><span class="token exports"> </span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;Goat&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл index.js</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">Pig</span><span> </span><span class="token module" style="color:#07a">from</span><span> ‘Pig’</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// From which library should import module?</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Погружение в область видимости стоит начать с понимания процесса компилятора стоящего за  установлением принадлежности к декларации в случаях, когда она распространяется не через менеджер <code class="content__code_inline">@types</code>. Прежде всего компилятор ищет в файле <code class="content__code_inline">package.json</code> свойство <code class="content__code_inline">types</code> и при его отсутствии или пустом значении <code class="content__code_inline">“”</code> переходит к поиску файла <code class="content__code_inline">index.d.ts</code> в корне директории. Если свойство <code class="content__code_inline">types</code> ссылается на конкретную декларацию, то точкой входа считается она. В противном случае файл <code class="content__code_inline">index.d.ts</code>. Стоит учесть, что при разработке будет возможно только взаимодействовать с модулями подключенными к точке входа. Кроме того, ограничить область видимости можно при помощи конструкций объявленных при помощи ключевых слов <code class="content__code_inline">module</code> или <code class="content__code_inline">namespace</code>. Единственное о чем сейчас стоит упомянуть, что области определяемые обеими конструкциями нужно расценивать как обычные модули, поскольку они могут включать только одно объявление экспорта по умолчанию (<code class="content__code_inline">export default</code>).</p>
<p>Если не уделить должного внимания области видимости при создании деклараций для подключаемых библиотек у разработчиков которые будут использовать подобные декларации с другими декларациями имеющими идентичное определение, могут возникнуть ошибки на этапе компиляции. Решений у этой проблемы всего два — сокрытие определений и уточнение определений. Способ к которому стоит прибегнуть зависит от вида разрабатываемой библиотеки.</p></section><section id="Deklaracii_dlya_bibliotek_s_odnoi_tochkoi_vhoda" class="content__section"><h2 class="content__heading">Декларации для библиотек с одной точкой входа</h2>
<p>В проекте созданном в теме посвященной настройке рабочего пространства, в директории <code class="content__code_inline">src</code> создайте две точки входа, одну для разработки <code class="content__code_inline">index.js</code>, а другую для <em>prod-версии</em>, имя которой должно соответствовать имени библиотеки, в нашем случае это будет <code class="content__code_inline">index.lib.ts</code>.</p>
<p>По умолчанию точкой входа, как <em>npm</em> пакета, так и декларации, является файл с именем <code class="content__code_inline">index</code>. Поэтому, если в проект библиотеки имеет несколько точек входа, то важно не забыть указать имя файла с помощью свойства <code class="content__code_inline">types</code> <code class="content__code_inline">package.json</code>. Если для сборки используется <em>webpack</em>, то будет значительно проще изменить имя на <code class="content__code_inline">index</code> во время компиляции.</p>
<p>Кроме того, создайте два файла: <code class="content__code_inline">IAnimal.ts</code> и <code class="content__code_inline">Zoo.ts</code>. Также в директории <code class="content__code_inline">/src</code> создайте директорию <code class="content__code_inline">/animal</code>, в которой будут размещены два файла: <code class="content__code_inline">Bird.ts</code> и <code class="content__code_inline">Fish.ts</code>. В итоге должна получится следующая структура:</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>
</span><span>   </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> src
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> utils
</span><span>         </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span>util</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> animal
</span><span>         </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> </span><span class="token maybe-class-name">Bird</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span><span>
</span><span>         </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> </span><span class="token maybe-class-name">Fish</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> </span><span class="token maybe-class-name">IAnimal</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> </span><span class="token maybe-class-name">Zoo</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> index</span><span class="token" style="color:#999">.</span><span class="token property-access">js</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> index</span><span class="token" style="color:#999">.</span><span class="token property-access">lib</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> tsconfig</span><span class="token" style="color:#999">.</span><span class="token property-access">prod</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл IAnimal.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл utils/string-util.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token" style="color:#DD4A68">toString</span><span class="token" style="color:#999">(</span><span> text</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">[object </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">${</span><span class="token template-string interpolation"> text </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">}</span><span class="token template-string" style="color:#690">]</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл animals/Bird.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#999">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">IAnimal</span><span class="token imports"> </span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;../IAnimal&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span class="token imports"> </span><span class="token imports module" style="color:#07a">as</span><span class="token imports"> </span><span class="token imports maybe-class-name">StringUtil</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;../utils/string-util&quot;</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Bird</span><span> </span><span class="token" style="color:#07a">implements</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#DD4A68">constructor</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">readonly</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span>  </span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#DD4A68">toString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token maybe-class-name">StringUtil</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">toString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">constructor</span><span class="token" style="color:#999">.</span><span class="token property-access">name</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл animals/Fish.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#999">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">IAnimal</span><span class="token imports"> </span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;../IAnimal&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span class="token imports"> </span><span class="token imports module" style="color:#07a">as</span><span class="token imports"> </span><span class="token imports maybe-class-name">StringUtil</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;../utils/string-util&quot;</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Fish</span><span> </span><span class="token" style="color:#07a">implements</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#DD4A68">constructor</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">readonly</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">{</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span>
<span>  </span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#DD4A68">toString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token maybe-class-name">StringUtil</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">toString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">constructor</span><span class="token" style="color:#999">.</span><span class="token property-access">name</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл Zoo.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#999">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">IAnimal</span><span class="token imports"> </span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;./IAnimal&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Zoo</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span> </span><span class="token" style="color:#07a">private</span><span> animalAll</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">IAnimal</span><span class="token" style="color:#999">[</span><span> </span><span class="token" style="color:#999">]</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">[</span><span> </span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">;</span><span>
</span>
<span> </span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#07a">get</span><span> </span><span class="token" style="color:#DD4A68">length</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>     </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">animalAll</span><span class="token" style="color:#999">.</span><span class="token property-access">length</span><span class="token" style="color:#999">;</span><span>
</span><span> </span><span class="token" style="color:#999">}</span><span>
</span>
<span> </span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#DD4A68">add</span><span class="token" style="color:#999">(</span><span>animal</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">IAnimal</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#07a">void</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>     </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">animalAll</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">push</span><span class="token" style="color:#999">(</span><span>animal</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span> </span><span class="token" style="color:#999">}</span><span>
</span><span> </span><span class="token" style="color:#07a">public</span><span> </span><span class="token" style="color:#DD4A68">getAnimalByIndex</span><span class="token" style="color:#999">(</span><span>index</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>     </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token" style="color:#07a">this</span><span class="token" style="color:#999">.</span><span class="token property-access">animalAll</span><span class="token" style="color:#999">[</span><span>index</span><span class="token" style="color:#999">]</span><span class="token" style="color:#999">;</span><span>
</span><span> </span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл index.js</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">Bird</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;./animals/Bird&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">Fish</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;./animals/Fish&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">Zoo</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./Zoo&#x27;</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">const</span><span> zoo</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">Zoo</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#07a">new</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Zoo</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span>zoo</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">add</span><span class="token" style="color:#999">(</span><span> </span><span class="token" style="color:#07a">new</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Bird</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;raven&#x27;</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>zoo</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">add</span><span class="token" style="color:#999">(</span><span> </span><span class="token" style="color:#07a">new</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Fish</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;shark&#x27;</span><span class="token" style="color:#999">)</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token control-flow" style="color:#07a">for</span><span class="token" style="color:#999">(</span><span> </span><span class="token" style="color:#07a">let</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">0</span><span class="token" style="color:#999">;</span><span> i </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span> zoo</span><span class="token" style="color:#999">.</span><span class="token property-access">length</span><span class="token" style="color:#999">;</span><span> i</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">++</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span>
</span><span> </span><span class="token console" style="color:#DD4A68">console</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">log</span><span class="token" style="color:#999">(</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">Animal name: </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">${</span><span class="token template-string interpolation"> zoo</span><span class="token template-string interpolation" style="color:#999">.</span><span class="token template-string interpolation method property-access" style="color:#DD4A68">getAnimalByIndex</span><span class="token template-string interpolation" style="color:#999">(</span><span class="token template-string interpolation">i</span><span class="token template-string interpolation" style="color:#999">)</span><span class="token template-string interpolation" style="color:#999">.</span><span class="token template-string interpolation property-access">name</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">}</span><span class="token template-string" style="color:#690">.</span><span class="token template-string template-punctuation" style="color:#690">`</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл index.lib.ts</span><span>
</span>
<!-- -->
<span></span><span class="token doc-comment" style="color:slategray">/** imports */</span><span>
</span>
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#999">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">IAnimal</span><span class="token imports"> </span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;./IAnimal&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">ZooCollection</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./Zoo&#x27;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/** re-exports */</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports maybe-class-name">IAnimal</span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./IAnimal&#x27;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// type</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#999">{</span><span class="token module" style="color:#07a">default</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token maybe-class-name">Bird</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./animals/Bird&#x27;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// type</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#999">{</span><span class="token module" style="color:#07a">default</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token maybe-class-name">Fish</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./animals/Fish&#x27;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// type</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#999">{</span><span class="token module" style="color:#07a">default</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token maybe-class-name">Zoo</span><span class="token" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./Zoo&#x27;</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// type</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">const</span><span> zoo</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">Zoo</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#07a">new</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Zoo</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// instance</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>В коде нет ничего необычного, поэтому комментариев не будет. Если кому-то содержимое файла <code class="content__code_inline">index.lib.ts</code> показалось необычным, то стоит отметить, что это обычный ре-экспорт модулей <em>JavaScript</em>, который никакого отношения к <em>TypeScript</em> не имеет. Повторю, файл <code class="content__code_inline">index.lib.ts</code> является точкой входа создаваемой библиотеки, поэтому он должен экспортировать все то, что может потребоваться при работе с ней. Конкретно в этом случае экспортировать <em>utils</em> наружу не предполагается, поэтому они не были реэкспортированы.</p>
<p>Также стоит обратить внимание на конфигурационные файлы <em>TypeScript</em>, которые взаимно добавляют точки входа друг друга в исключение. Кроме того, конфигурационный файл <em>dev-сборки</em> исключает также конфигурационный файл <em>prod-сборки</em>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл /src/tsconfig.prod.json</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#999">{</span><span>
</span><span>   </span><span class="token" style="color:#690">&quot;compilerOptions&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>     </span><span class="token" style="color:#690">&quot;target&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;es6&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>     </span><span class="token" style="color:#690">&quot;module&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;umd&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>     </span><span class="token" style="color:#690">&quot;rootDir&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;./&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>     </span><span class="token" style="color:#690">&quot;declaration&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">true</span><span>
</span><span>   </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>   </span><span class="token" style="color:#690">&quot;exclude&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">[</span><span>
</span><span>     </span><span class="token" style="color:#690">&quot;/node_modules&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>     </span><span class="token" style="color:#690">&quot;./index.js&quot;</span><span>
</span><span>   </span><span class="token" style="color:#999">]</span><span>
</span><span> </span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">//  Файл /tsconfig.json</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#999">{</span><span>
</span><span></span><span class="token" style="color:#690">&quot;compilerOptions&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;target&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;es6&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;module&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;umd&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;rootDir&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;./src&quot;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#690">&quot;exclude&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">[</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;/node_modules&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;./src/index.lib.ts&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;./src/tsconfig.prod.json&quot;</span><span>
</span><span></span><span class="token" style="color:#999">]</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл package.json</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#999">{</span><span>
</span><span></span><span class="token" style="color:#690">&quot;name&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;zoo&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#690">&quot;version&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;1.0.0&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#690">&quot;description&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#690">&quot;main&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;index.js&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#690">&quot;scripts&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;build&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;./node_modules/.bin/tsc --project ./tsconfig.json --watch&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;build:prod&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;./node_modules/.bin/tsc --project ./src/tsconfig.prod.json&quot;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#690">&quot;author&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#690">&quot;license&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;ISC&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span></span><span class="token" style="color:#690">&quot;devDependencies&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;typescript&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;^2.5.2&quot;</span><span>
</span><span></span><span class="token" style="color:#999">}</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Осталось только запустить <em>prod-сборку</em> и если все было сделано правильно, в директории <em>dist</em> появятся скомпилированные файлы с расширением <code class="content__code_inline">.js</code> (конечный код) и <code class="content__code_inline">.d.ts</code> (представляющие декларации необходимые для работы как самого компилятора <em>TypeScript</em>, так и автодополнения <em>ide</em>).</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл IAnimal.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл utils/string-util.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token" style="color:#DD4A68">toString</span><span class="token" style="color:#999">(</span><span>text</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл animals/Bird.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#999">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">IAnimal</span><span class="token imports"> </span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;../IAnimal&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Bird</span><span> </span><span class="token" style="color:#07a">implements</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">readonly</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#DD4A68">constructor</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#DD4A68">toString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл animals/Fish.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#999">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">IAnimal</span><span class="token imports"> </span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;../IAnimal&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Fish</span><span> </span><span class="token" style="color:#07a">implements</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">readonly</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#DD4A68">constructor</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#DD4A68">toString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл Zoo.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#999">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">IAnimal</span><span class="token imports"> </span><span class="token imports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;./IAnimal&quot;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Zoo</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">private</span><span> animalAll</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#07a">readonly</span><span> length</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#DD4A68">add</span><span class="token" style="color:#999">(</span><span>animal</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">IAnimal</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#DD4A68">getAnimalByIndex</span><span class="token" style="color:#999">(</span><span>index</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">IAnimal</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл index.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports maybe-class-name">Zoo</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./Zoo&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token doc-comment" style="color:slategray">/** re-exports */</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports"> </span><span class="token exports maybe-class-name">IAnimal</span><span class="token exports"> </span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./IAnimal&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">default</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">as</span><span class="token exports"> </span><span class="token exports maybe-class-name">Bird</span><span class="token exports"> </span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./animals/Bird&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">default</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">as</span><span class="token exports"> </span><span class="token exports maybe-class-name">Fish</span><span class="token exports"> </span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./animals/Fish&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">default</span><span class="token exports"> </span><span class="token exports module" style="color:#07a">as</span><span class="token exports"> </span><span class="token exports maybe-class-name">Zoo</span><span class="token exports"> </span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./Zoo&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token doc-comment" style="color:slategray">/** exports */</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">const</span><span> zoo</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">Zoo</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Также стоит сказать, что сгенерированная декларация не может рассматриваться как единоверная. Очень часто можно увидеть декларации собранные в одном файле и сгруппированные по логическим признакам с помощью <code class="content__code_inline">namespace</code> или так называемых <code class="content__code_inline">ghost module</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token doc-comment" style="color:slategray">/**ghost module */</span><span>
</span>
<span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token maybe-class-name">Zoo</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span>
<span>  </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Bird</span><span> </span><span class="token" style="color:#07a">implements</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token" style="color:#07a">readonly</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#DD4A68">constructor</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#DD4A68">toString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span><span>  </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Fish</span><span> </span><span class="token" style="color:#07a">implements</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token" style="color:#07a">readonly</span><span> name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#DD4A68">constructor</span><span class="token" style="color:#999">(</span><span>name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#DD4A68">toString</span><span class="token" style="color:#999">(</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span>
<span>  </span><span class="token" style="color:#07a">class</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">Zoo</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token" style="color:#07a">private</span><span> animalAll</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#07a">readonly</span><span> length</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#DD4A68">add</span><span class="token" style="color:#999">(</span><span>animal</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">IAnimal</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#07a">void</span><span class="token" style="color:#999">;</span><span>
</span><span>      </span><span class="token" style="color:#DD4A68">getAnimalByIndex</span><span class="token" style="color:#999">(</span><span>index</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">IAnimal</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span>
</span>
<span>  </span><span class="token" style="color:#07a">const</span><span> zoo</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token maybe-class-name">Zoo</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token doc-comment" style="color:slategray">/** module */</span><span>
</span>
<span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;zoo&quot;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token maybe-class-name">Zoo</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Судить, какой из этих вариантов лучше, я не возьмусь, так как на мой взгляд, в данный момент, они оба не являются исчерпывающими. Возможно в будущем появятся новые правила для создания деклараций или редакторы будут по другому обрабатывать эти.</p>
<p>Также стоит обратить внимание, что в случае компиляции при помощи <em>tsc</em>, если в конечной директории присутствуют файлы, чьи имена совпадают с именами генерируемых при компиляции файлов, несмотря на их замену, ошибка все равно возникнет. Другими словами, если процесс сборки запускается не в первый раз, то нужно удалить файлы оставшиеся от предыдущей компиляции.</p></section><section id="Deklaracii_dlya_bibliotek_s_mnojestvom_tochek_vhoda" class="content__section"><h2 class="content__heading">Декларации для библиотек с множеством точек входа</h2>
<p>При разработке библиотеки имеющий множество самостоятельных частей более разумно создавать каждую часть в виде отдельной точки входа. Это позволит использующим её приложениям за счет подключения только необходимых частей минимизировать вес конечной сборки, что становится возможно благодаря механизму <em>Tree Shaking</em>.</p>
<p>Для этого рассмотрим проект состоящий из самодостаточного модуля <code class="content__code_inline">bird.ts</code>, который делает ре-экспорт модуля <code class="content__code_inline">Raven.ts</code>, а также самодостаточного модуля <code class="content__code_inline">fish.ts</code> реэкспортирующего модуль <code class="content__code_inline">Shark.ts</code>. Кроме этого оба модуля доступны в точке входа <code class="content__code_inline">index.lib.ts</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>
</span><span>   </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> src</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">/</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> to</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span class="token" style="color:#690">string</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span>decorate</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> to</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span>error</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">-</span><span>decorate</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span><span>
</span><span>      </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> index</span><span class="token" style="color:#999">.</span><span class="token property-access">lib</span><span class="token" style="color:#999">.</span><span class="token property-access">ts</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Стоит сказать, что конфигурационные файлы ничем не отличаются от рассмотренных в теме создания деклараций для библиотек с одной точкой входа, поэтому их описание будет опущено.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл to-string-decorate.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token" style="color:#DD4A68">toStringDecorate</span><span class="token" style="color:#999">(</span><span> type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">[object </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">${</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation" style="color:#07a">type</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">}</span><span class="token template-string" style="color:#690">]</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">//Файл to-error-decorate.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token" style="color:#DD4A68">toErrorDecorate</span><span class="token" style="color:#999">(</span><span> message</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">,</span><span> id</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#905">0</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token control-flow" style="color:#07a">return</span><span> </span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token template-string" style="color:#690">error:</span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">${</span><span class="token template-string interpolation"> id </span><span class="token template-string interpolation" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">===</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation" style="color:#905">0</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation" style="color:#690">&#x27;&#x27;</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span class="token template-string interpolation"> id </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">}</span><span class="token template-string" style="color:#690">, </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">${</span><span class="token template-string interpolation"> message </span><span class="token template-string interpolation interpolation-punctuation" style="color:#999">}</span><span class="token template-string" style="color:#690">.</span><span class="token template-string template-punctuation" style="color:#690">`</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл index.lib.ts</span><span>
</span>
<!-- -->
<span></span><span class="token doc-comment" style="color:slategray">/** re-export */</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports">toStringDecorate</span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./to-string-decorate&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports">toErrorDecorate</span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./to-error-decorate&#x27;</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>После компиляции проекта в директорию <em>dist</em> сгенерируются следующие файлы -</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл to-string-decorate.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token" style="color:#DD4A68">toStringDecorate</span><span class="token" style="color:#999">(</span><span>type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл to-error-decorate.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token" style="color:#DD4A68">toErrorDecorate</span><span class="token" style="color:#999">(</span><span>message</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">,</span><span> id</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл index.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token doc-comment" style="color:slategray">/** re-export */</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports">toStringDecorate</span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./to-string-decorate&#x27;</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token exports" style="color:#999">{</span><span class="token exports">toErrorDecorate</span><span class="token exports" style="color:#999">}</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&#x27;./to-error-decorate&#x27;</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Сразу следует сказать, что с подобным описанием декларация не будет правильно функционировать, поэтому её придется подправить руками до следующего вида.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл to-string-decorate.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token" style="color:#DD4A68">toStringDecorate</span><span class="token" style="color:#999">(</span><span>type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token" style="color:#07a">namespace</span><span> stringDecorate</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл to-error-decorate.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token" style="color:#DD4A68">toErrorDecorate</span><span class="token" style="color:#999">(</span><span>message</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">,</span><span> id</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">?</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">number</span><span class="token" style="color:#999">)</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token" style="color:#07a">namespace</span><span> errorDecorate</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл index.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:slategray">/// &lt;reference path=&quot;./to-string-decorate.d.ts&quot; /&gt;</span><span>
</span><span></span><span class="token" style="color:slategray">/// &lt;reference path=&quot;./to-error-decorate.d.ts&quot; /&gt;</span><span>
</span>
<span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;zoo&quot;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> </span><span class="token" style="color:#999">{</span><span>stringDecorate</span><span class="token" style="color:#999">,</span><span> errorDecorate</span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Обычно, как отдельную часть принято экспортировать только самодостаточные модули, такие как функции или классы. Но кроме того могут потребоваться объекты содержащие константы или, что-то незначительное, без чего отдельный модуль не сможет функционировать. Если такие объекты используются всеми самостоятельными модулями, то их можно также вынести в отдельный самостоятельный модуль. В случае, когда самодостаточному модулю для полноценной работы требуются зависимости, которые больше никем не используются, то такой модуль нужно оформлять так же, как обычную точку входа. Другими словами он должен содержать ре-экспорт всего необходимого. А кроме того экспортировать все как глобальный <code class="content__code_inline">namespace</code> с помощью синтаксиса:</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token" style="color:#07a">namespace</span><span> identifier</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Данный синтаксис объединяет все объявленные экспорты в глобальное пространство имен с указанным идентификатором. Затем объявленные пространства имен нужно импортировать в точку входа с помощью директивы с тройным слешем <code class="content__code_inline">/// &lt;reference path=””/&gt;</code>, после чего экспортировать из объявленного модуля.</p></section><section id="Sozdanie_deklaracii_vruchnuu" class="content__section"><h2 class="content__heading">Создание деклараций вручную</h2>
<p>Описывать незначительные декларации самостоятельно (вручную) приходится довольно часто. Потребность возникает при необходимости задекларировать импортируемые файлами <code class="content__code_inline">.ts</code> нестандартные для него расширения файлов. Дело в том, что компилятор <em>TypeScript</em> понимает только импорт расширения <code class="content__code_inline">.ts</code>/<code class="content__code_inline">.tsx</code>/<code class="content__code_inline">.d.ts</code>/<code class="content__code_inline">.json</code>, а с активной опцией <code class="content__code_inline">--allowJS</code>, еще и <code class="content__code_inline">.js</code>/<code class="content__code_inline">.jsx</code>. Но работая с таким сборщиком как в <em>webpack</em> или используя <em>css-in-js</em>, придется импортировать в код файлы с таким расширением, как <code class="content__code_inline">.html</code>, <code class="content__code_inline">.css</code>, и т.д. В таких случаях приходится создавать декларации файлов вручную.</p>
<p>Самостоятельно объявление деклараций начинается с создания директории предназначенной для их хранения. В нашем случае это будет директория <em>types</em> расположенная в корне проекта. Декларации можно складывать прямо в неё, но будет правильно считается создавать под каждую декларацию отдельную поддиректорию носящую имя модуля нуждающегося в ней. Поэтому создадим поддиректорию с именем <code class="content__code_inline">/css</code>, а уже в ней создадим файл <code class="content__code_inline">index.d.ts</code>. Откроем этот файл и напишем в нем декларацию определяющую расширение <code class="content__code_inline">.css</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл ./types/css/index.d.ts</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;*.css&quot;</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#07a">const</span><span> content</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">any</span><span class="token" style="color:#999">;</span><span>
</span><span>  </span><span class="token module" style="color:#07a">export</span><span> </span><span class="token module" style="color:#07a">default</span><span> content</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>В тех случаях, когда модуль определяет тип <code class="content__code_inline">any</code>, более уместно использовать при объявлении сокращенный вариант, который предполагает тип <code class="content__code_inline">any</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">module</span><span> </span><span class="token" style="color:#690">&quot;*.css&quot;</span><span class="token" style="color:#999">;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Осталось только подключить декларацию в конфигурационном файле и ошибок при импорте расширения <code class="content__code_inline">.css</code> не возникнет.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// Файл tsconfig.json</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:#999">{</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;compilerOptions&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>      </span><span class="token" style="color:#690">&quot;target&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;es2015&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>      </span><span class="token" style="color:#690">&quot;module&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;none&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>      </span><span class="token" style="color:#690">&quot;rootDir&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&quot;./src&quot;</span><span class="token" style="color:#999">,</span><span>
</span><span>      </span><span class="token" style="color:#690">&quot;typeRoots&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">[</span><span>
</span><span>          </span><span class="token" style="color:#690">&quot;./types&quot;</span><span>
</span><span>      </span><span class="token" style="color:#999">]</span><span>
</span><span>  </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">,</span><span>
</span><span>  </span><span class="token" style="color:#690">&quot;exclude&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#999">[</span><span>
</span><span>      </span><span class="token" style="color:#690">&quot;./node_modules&quot;</span><span>
</span><span>  </span><span class="token" style="color:#999">]</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Будет не лишним упомянуть, что самостоятельное создание деклараций, помимо нестандартных расширений, также часто требуется при необходимости расширения типов описывающих внешние библиотеки. Например, если при работе с библиотекой <em>React</em> возникнет необходимость в использовании пользовательских свойств определенных спецификацией <em>html</em>, то придется расширять объявляемый в её модуле тип <code class="content__code_inline">HTMLAttributes</code>.</p></section><section id="Direktiva_s_troinym_sleshem_(triple-slash_directives)" class="content__section"><h2 class="content__heading">Директива с тройным слешем (triple-slash directives)</h2>
<p>До этого момента было рассмотрено создание библиотек представленных одним или больше количеством самостоятельных модулей. Акцент в этом предложении необходимо сделать на слове <em>самостоятельных</em>, поскольку они не были зависимы от каких-либо других модулей (деклараций). Если разрабатываемая библиотека представляет из себя множество зависящих друг от друга модулей или она зависит от деклараций устанавливаемых с помощью директивы <code class="content__code_inline">@types</code>, то генерируемые декларации также будут нуждаться в зависимостях. Для этих случаев существует директива <code class="content__code_inline">/// &lt;reference types=””/&gt;</code>. Данная директива указывается в начале файла и предназначена для подключения деклараций, путь до которых указывается с помощью атрибута <code class="content__code_inline">types</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">/// &lt;reference types=&quot;react&quot; /&gt;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Кроме того, с помощью данной директивы можно указать версию используемой библиотеки.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">/// &lt;reference lib=&quot;es2015&quot; /&gt;</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Подобный функционал будет полезен разработчикам деклараций <code class="content__code_inline">.d.ts</code>, которые зависят от конкретной версии <em>ECMAScript</em>.</p></section><section id="Importirovanie_deklaracii_(import)" class="content__section"><h2 class="content__heading">Импортирование декларации (import)</h2>
<p>Помимо типов, описанных в глобальных декларациях, в аннотациях типов также можно использовать типы из деклараций импортированных с помощью директивы <code class="content__code_inline">import</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// file declaration-excluded-from-global-scope/animal.d.ts</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// file src/index.js</span><span>
</span>
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span> </span><span class="token module" style="color:#07a">as</span><span> </span><span class="token" style="color:#905">DTS</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;declaration-excluded-from-global-scope/animal&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<span></span><span class="token" style="color:slategray">// импорт декларации на уровне модуля</span><span>
</span>
<span></span><span class="token" style="color:#07a">let</span><span> v0</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">DTS</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">IAnimal</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span> type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&#x27;&#x27;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span></span><span class="token" style="color:#07a">let</span><span> v1</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">DTS</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">IAnimal</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span> type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">5</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error</span><span>
</span>
<!-- -->
<span></span><span class="token" style="color:slategray">// инлайн импорт</span><span>
</span>
<span></span><span class="token" style="color:#07a">let</span><span> v2</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token module" style="color:#07a">import</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;declaration-excluded-from-global-scope/animal&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">IAnimal</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span> type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&#x27;&#x27;</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span></span><span class="token" style="color:#07a">let</span><span> v3</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token module" style="color:#07a">import</span><span class="token" style="color:#999">(</span><span class="token" style="color:#690">&#x27;declaration-excluded-from-global-scope/animal&#x27;</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">.</span><span class="token property-access maybe-class-name">IAnimal</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span> </span><span class="token" style="color:#999">{</span><span> type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">5</span><span> </span><span class="token" style="color:#999">}</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<p>Этот механизм также позволяет указывать аннотацию типов непосредственно в файлах с расширением <code class="content__code_inline">.js</code>.</p>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// file declaration-excluded-from-global-scope/animal.d.ts</span><span>
</span>
<span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">declare</span><span> </span><span class="token" style="color:#07a">interface</span><span> </span><span class="token maybe-class-name" style="color:#DD4A68">IAnimal</span><span> </span><span class="token" style="color:#999">{</span><span>
</span><span>  type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">string</span><span class="token" style="color:#999">;</span><span>
</span><span></span><span class="token" style="color:#999">}</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// file lib/index.js</span><span>
</span>
<span></span><span class="token doc-comment" style="color:slategray">/**
</span><span class="token doc-comment" style="color:slategray">*
</span><span class="token doc-comment" style="color:slategray">* </span><span class="token doc-comment" style="color:#07a">@param</span><span class="token doc-comment" style="color:slategray"> </span><span class="token doc-comment" style="color:#999">{</span><span class="token doc-comment" style="color:slategray">import(&quot;./declaration-excluded-from-global-scope/animal&quot;).IAnimal</span><span class="token doc-comment" style="color:#999">}</span><span class="token doc-comment" style="color:slategray"> animal
</span><span class="token doc-comment" style="color:slategray">*/</span><span>
</span><span></span><span class="token module" style="color:#07a">export</span><span> </span><span class="token" style="color:#07a">function</span><span> </span><span class="token" style="color:#DD4A68">printAnimalInfo</span><span class="token" style="color:#999">(</span><span>animal</span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">{</span><span> animal</span><span class="token" style="color:#999">.</span><span class="token property-access">type</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// autocomplete }</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div>
<div class="content__code"><div class="content__code-panel_top content__code-panel_lang_ts"><span class="content_code-label_lang">ts</span></div><pre class="content__pre"><div style="color:black;background:node;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ts" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:slategray">// file src/index.js</span><span>
</span>
<span></span><span class="token module" style="color:#07a">import</span><span> </span><span class="token imports" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">*</span><span class="token imports"> </span><span class="token imports module" style="color:#07a">as</span><span class="token imports"> </span><span class="token imports maybe-class-name">AnimalUtils</span><span> </span><span class="token module" style="color:#07a">from</span><span> </span><span class="token" style="color:#690">&quot;lib/index.js&quot;</span><span class="token" style="color:#999">;</span><span>
</span>
<!-- -->
<span></span><span class="token maybe-class-name">AnimalUtils</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">printAnimalInfo</span><span class="token" style="color:#999">(</span><span> </span><span class="token" style="color:#999">{</span><span> type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#690">&#x27;&#x27;</span><span> </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Ok</span><span>
</span><span></span><span class="token maybe-class-name">AnimalUtils</span><span class="token" style="color:#999">.</span><span class="token method property-access" style="color:#DD4A68">printAnimalInfo</span><span class="token" style="color:#999">(</span><span> </span><span class="token" style="color:#999">{</span><span> type</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">:</span><span> </span><span class="token" style="color:#905">5</span><span> </span><span class="token" style="color:#999">}</span><span> </span><span class="token" style="color:#999">)</span><span class="token" style="color:#999">;</span><span> </span><span class="token" style="color:slategray">// Error</span></code></div></pre><div class="content__code-panel_bottom content__code-panel_lang_ts"></div></div></section><aside class="content-box__page__content-bar_post"><nav class="post-content-bar__nav"><a href="Sborka_s_ispolzovaniem_ssylok_na_proekty" class="ant-btn ant-btn-lg ant-btn-block post-content-bar__nav__btn post-content-bar__nav__btn_prev"><div class="post-content-bar__nav__btn_padding-fix"><span role="img" aria-label="arrow-left" class="anticon anticon-arrow-left post-content-bar__nav__btn__icon_prev"><svg viewBox="64 64 896 896" focusable="false" data-icon="arrow-left" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"></path></svg></span><span class="post-content-bar__nav__btn__label">Сборка с использованием ссылок на проекты</span></div></a><a href="Publikaciya_TypeScript" class="ant-btn ant-btn-lg ant-btn-block post-content-bar__nav__btn post-content-bar__nav__btn_next"><div class="post-content-bar__nav__btn_padding-fix"><span class="post-content-bar__nav__btn__label">Публикация TypeScript</span><span role="img" aria-label="arrow-right" class="anticon anticon-arrow-right post-content-bar__nav__btn__icon_next"><svg viewBox="64 64 896 896" focusable="false" data-icon="arrow-right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M869 487.8L491.2 159.9c-2.9-2.5-6.6-3.9-10.5-3.9h-88.5c-7.4 0-10.8 9.2-5.2 14l350.2 304H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h585.1L386.9 854c-5.6 4.9-2.2 14 5.2 14h91.5c1.9 0 3.8-.7 5.2-2L869 536.2a32.07 32.07 0 000-48.4z"></path></svg></span></div></a></nav></aside></main><div class="content-box__page-nav content-box__page-nav_right"><div class="page-nav__bar page-nav__bar_right"><span style="display:inline-block;cursor:not-allowed" class="page-nav__btn ant-tooltip-disabled-compatible-wrapper"><button disabled="" style="pointer-events:none" type="button" class="ant-btn ant-btn-primary ant-btn-icon-only"><span role="img" aria-label="up" class="anticon anticon-up"><svg viewBox="64 64 896 896" focusable="false" data-icon="up" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"></path></svg></span></button></span><button type="button" class="ant-btn ant-btn-primary ant-btn-icon-only page-nav__btn page-nav__btn_next-page"><span role="img" aria-label="right" class="anticon anticon-right"><svg viewBox="64 64 896 896" focusable="false" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"></path></svg></span></button><span style="display:inline-block;cursor:not-allowed" class="page-nav__btn ant-tooltip-disabled-compatible-wrapper"><button disabled="" style="pointer-events:none" type="button" class="ant-btn ant-btn-primary ant-btn-icon-only"><span role="img" aria-label="down" class="anticon anticon-down"><svg viewBox="64 64 896 896" focusable="false" data-icon="down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"></path></svg></span></button></span></div></div></div></div><div class="slide-layer__last-empty"></div></div><footer class="app-footer"><div class="app-footer__empty"></div><div class="app-footer_contacts app-footer__section"></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"urlResolver":{"image":"https://raw.githubusercontent.com/nauchikus/typescript-definitive-guide/master/book/ru/chapters/060.(Сборка) Декларации/images/"},"sectionInfoAll":[{"key":"Декларации","elementId":"Deklaracii","markdown":"# Декларации\n\nДекларации это очень важная часть _TypeScript_ благодаря которой магия статической типизации проецируется на динамический _JavaScript_. Поэтому декларациям будет посвящена вся данная глава, рекомендуемая тем, кто только собирается писать свою первую типизированную библиотеку, которую планируется распространять с помощью _npm_ репозитория."},{"key":"Декларации_0","elementId":"Chto_takoe_deklaraciya_(Declaration)","markdown":"## Что такое декларация (Declaration)\n\nПоскольку при разработке программ на _TypeScript_ используются библиотеки написанные на _JavaScript_, компилятор _tsc_, чьей главной задачей является проверка типов, чувствует себя будто у него завязаны глаза. Несмотря на то, что с каждой новой версией вывод типов все лучше и лучше учится разбирать _JavaScript_, до идеала ещё далеко. Кроме того, разбор _JavaScript_ кода добавляет нагрузку на процессор, драгоценного время которого при разработке современных приложений, порой и так не достаточно.\n\n_TypeScript_ решил эту проблему за счет подключения к проекту заранее сгенерированных им или создаваемых вручную разработчиками деклараций. Декларации размещаются в файлах с расширением `.d.ts` и состоят только из объявлений типов полностью повторяющих программу до момента компиляции при которой она была лишена всех признаков типизации.\n\n`````ts\nФайл Animal.ts\n\n\nexport default class Animal {\n   public name: string = 'animal';\n\n   public voice(): void {}\n}\n`````\n\n`````ts\nФайл Animal.d.ts\n\n\ndeclare module \"Animal\" {\n   export default class Animal {\n       name: string;\n       voice(): void;\n   }\n}\n`````\n\nЕще не забыты дни, когда для часто используемых библиотек приходилось писать декларации вручную, при чем они часто содержали ошибки. Кроме этого, декларации не успевали обновляться под постоянно развивающиеся библиотеки. Сейчас такие проблемы кажутся уже нереальными, но несмотря на это, до сих пор приходится прибегать к использованию менеджера деклараций, который был создан в те самые далекие времена."},{"key":"Декларации_1","elementId":"Ustanovka_deklaracii_s_pomoshchu_@types","markdown":"## Установка деклараций с помощью @types\n\nЕсли декларация распространяется отдельно от библиотеки, то она скорее всего, попадет в огромный репозиторий на _github_ под названием _DefinitelyTyped_ содержащий огромное количество деклараций. Чтобы было проще ориентироваться в этом множестве, помимо сайта [\"TypeSearch\"](https://microsoft.github.io/TypeSearch/) выступающего в роли поисковика, был создан менеджер деклараций под названием _Typed_. Но о нем мы говорить не будем поскольку он применяется при работе с _TypeScript_ версии меньше чем _v2.0_, поэтому речь пойдет о его развитии в образе команды пакетного менеджера _npm_, а именно _@types_.\n\nДля того, что бы установить требующуюся декларацию, в терминале необходимо выполнить команду, часть которой состоит из директивы `@types`, после которой через косую черту `/` следует имя библиотеки.\n\n`````sh\nnpm i -D @types/name\n`````\nДля примера, воспользуемся проектом созданным в теме посвященной настройки рабочего окружения и для демонстрации работы директивы `@types` установим всем известную библиотеку _React_.\n\nПервым делом установим саму библиотеку _React_ выполнив в терминале, запущенным из-под директории проекта, следующую команду.\n\n`````sh\nnpm i -D react\n`````\n\nОткрыв директорию `/node_modules/` можно убедиться, что библиотека _React_ успешно установлена, поэтому сразу же попытаемся импортировать её в файл `index.js` расположенным в директории _src_, предварительно изменив его расширение на требуемое для работы с _React_ — `.tsx`.\n\n`````ts\n// @filename: src/index.js\n\n\nimport React, {Component} from 'react'; // Error\n`````\n\nНесмотря на установленную на предыдущем шаге библиотеку _React_, при попытке импортировать её модули возникла ошибка. Возникла она потому, что компилятору _TypeScript_ ничего не известно о библиотеке _React_, поскольку декларация описывающая типы поставляется отдельно от неё. Чтобы _tsc_ понял, что от него хотят, требуется дополнительно установить декларацию при помощи команды `@types` пакетного менеджера `npm`.\n\n`````sh\nnpm i -D @types/react\n`````\n\nОшибка, возникающая при импорте модулей _React_ исчезла, а если заглянуть в директорию `_/node_modules/`, то можно увидеть новую примечательную поддиректорию `/@types` предназначенную для хранения устанавливаемых с помощью опции `@types` декларации.\n\nНо для полноты картины и этого недостаточно. Для того, что бы добавить наш компонент в dom-дерево, необходимо установить _ReactDOM_, который уже давно развивается отдельной библиотекой.\n\n`````sh\nnpm i -D react-dom\n`````\n\nКроме того, нужно установить необходимую для работы с ним декларацию.\n\n`````sh\nnpm i -D @types/react-dom\n`````\n\nОсталось только активировать опцию `--jsx` в `_tsconfig.json` и скомпилировать проект, как это было показано ранее.\n\n`````ts\nimport React, {Component} from 'react'; // Ok\nimport * as ReactDOM from 'react-dom'; // Ok\n\n\nconst HelloReact = () =\u003e \u003ch1\u003eHello react!\u003c/h1\u003e;\n\nReactDOM.render(\n  \u003cHelloReact /\u003e,\n  document.querySelector('#root')\n);\n`````"},{"key":"Декларации_2","elementId":"Podgotovka_k_sozdaniu_deklaracii","markdown":"## Подготовка к созданию декларации\n\nПомимо того, что декларацию можно написать руками, её также можно сгенерировать автоматически, при условии, что код написан на _TypeScript_. Для того, что бы _tsc_ при компиляции генерировал декларации, нужно активировать опцию компилятора `--declaration`.\n\nБудет не лишним напомнить, что декларацию нужно генерировать только тогда, когда библиотека полностью готова. Другими словами, активировать опцию `--declaration` нужно в конфигурационном файле _production_ сборки. Кроме того, в декларации нуждается только код, который будет собран в подключаемую библиотеку. Поэтому точкой входа в библиотеку должен быть файл, который содержит только импорты нужных модулей. Но разработка библиотеки невозможна без её запуска, а значит и точки входа в которой будет создан и инициализирован её экземпляр. Поэтому, что бы избежать чувства «что-то пошло не так», необходимо помнить, что при создании библиотеки требующей декларацию, в проекте может быть несколько точек входа. Точкой входа самого компилятора, служит конфигурационный файл который ему был установлен при запуске. Это означает, что если проект находится в директории `src`, то в декларации путь будет указан как `src/libName` вместо требуемого `lib`.\n\n`````ts\n// Ожидается\n\ndeclare module \"libName\" {\n  //...\n}\n`````\n\n`````ts\n// Есть\n\ndeclare module \"src/libName\" {\n  //...\n}\n`````\n\nЭто в свою очередь означает, что при импорте модулей придется учитывать лишнюю директорию.\n\n`````ts\n// Ожидается\n\nimport {libName} from 'libName';\n`````\n\n`````ts\n// Есть\n\nimport {libName} from 'src/libName';\n`````\n\nЭто проблему можно решить, разместив конфигурационный файл в директории исходного кода, в нашем случае это директория `src`. Кто-то не придаст этому значение, кому-то это может показаться неэстетичным. Поэтому при рассмотрении генерации деклараций с помощью _tsc_, конфигурационный файл будет лежать непосредственно в директории `src`. Но при рассмотрении генерации деклараций с помощью сторонних библиотек, будет освещен альтернативный вариант.\n\nНо и это ещё не все. Представьте, что Вы создаете библиотеку _React_, которая в коде представляется одноимённым классом расположенном в файле `React.ts`. При этом модуль, который будет представлять вашу библиотеку должен называться `react`, что в свою очередь обязывает задать имя файлу являющегося точкой входа как `react.js. Ну и, что спросите вы? Если вы ещё не знаете ответ на этот вопрос, то будете удивлены, узнав, что существуют операционные системы, как, например, _Windows_, которые расценивают пути до файлов _React.ts_ и _react.ts_ идентичными. Простыми словами если в директории присутствует файл с идентификатором _Identifier_, то ОС просто не позволит создать одноимённый файл, даже если его символы будут отличаться регистром. Именно об этом и будет сказано в ошибке, возникающей когда _TypeScript_ обнаружит одноимённые файлы в одной директории. Кроме того, если ваша операционная система позволяет создавать файлы чьи идентификаторы отличаются только регистром, помните, что разработчик работающий с вами в одной команде не сможет даже установить проект себе на машину, если его операционная система работает по другим правилам.\n\nПоэтому решений у этой проблемы, на самом деле, всего два. Задавать идентификаторы отличающиеся не только регистром. Или же размещать файлы таким образом, что бы их идентификаторы не пересекались в одной директории. Но при этом нужно помнить, что структура модулей также изменится.\n\nИ поскольку _TypeScript_ является компилируемым языком, не будет лишним напомнить правила именования директории в которую будет компилироваться результат. В случае разработки приложения, директорию содержащую скомпилированный результат принято называть _dest_ (сокращение от слова _destination_). При разработке внешней библиотеки или фреймворка, директорию для собранных файлов принято называть _dist_ (сокращение от слова _distributive_)."},{"key":"Декларации_3","elementId":"Raznovidnosti_deklaracii","markdown":"## Разновидности деклараций\n\nНа самом деле это глава должна называться «разновидности библиотек», так как именно о них и пойдет речь. Дело в том, что совсем недавно вершиной хорошего тона считалось объединение всего кода в один файл. Это же правило соблюдалось и при создании библиотек. Но сейчас все кардинально поменялось, и дело вот в чем.\n\nВ мире _JavaScript_ существует большое количество библиотек, чей размер по меркам клиентских приложений превышает разумный. При этом отказ от них будет означать, что вам самому придется тратить драгоценное время на реализацию части их функционала. Это побудило создателей сборщиков наделять свои творения механизмом называющимся _Tree Shaking_.\n\n_Tree Shaking_ — это механизм позволяющий включать в сборку исключительно используемый код. Простыми словами, данный механизм позволяет взять только используемую часть от всей библиотеки. В перспективе это должно быть спасением, но на деле оказалось не совсем так.\n\nДело в том, что на данный момент _Tree Shaking_ работает только если библиотека разбита на множество модулей. К примеру такие именитые библиотеки, как _lodash_ или _rxjs_, для каждой отдельной функции создают отдельную точку входа, что при их использовании позволят значительно сократить размер конечного кода. Обозначим подобные библиотеки, как библиотеки с множеством точек входа. Кроме того, существуют библиотеки сопоставимые с монолитом, поскольку при использовании их малой части в конечную сборку они попадают целиком. Обозначим такие библиотеки, как библиотеки с единственной точкой входа."},{"key":"Декларации_4","elementId":"Deklaracii_i_oblast_vidimosti","markdown":"## Декларации и область видимости\n\nВажным моментом при создании деклараций для библиотек является понимание того, как их трактует компилятор. Дело в том, что все доступные компилятору декларации находятся в общей для всех области видимости. Это означает, что они так же, как переменные, функции и классы способны затенять или другими словами, перекрывать друг друга. Кроме того, идентификатор файла не играет никакой роли, поскольку компилятор рассматривает только определение деклараций с помощью ключевого слова `declare`. Проще говоря, два файла имеющие отличные идентификаторы, но идентичные объявления, будут затенять друг друга.\n\n`````ts\n// Файл ./types/petAnimal.d.ts\n\n\ndeclare module \"Pig\" { // Error\n  export default class Pig {}\n}\ndeclare module \"Goat\" { // Error\n  export default class Goat {}\n}\ndeclare module \"petAnimal\" { // Ok\n  export { default as Pig } from \"Pig\";\n  export { default as Goat } from \"Goat\";\n}\n`````\n\n`````ts\n// Файл ./types/wildAnimal.d.ts\n\n\ndeclare module \"Pig\" { // Error\n  export default class Pig {}\n}\ndeclare module \"Goat\" { // Error\n  export default class Goat {}\n}\ndeclare module \"wildAnimal\" { // Ok\n  export { default as Pig } from \"Pig\";\n  export { default as Goat } from \"Goat\";\n}\n`````\n\n`````ts\n// Файл index.js\n\n\nimport Pig from ‘Pig’; // From which library should import module?\n`````\n\nПогружение в область видимости стоит начать с понимания процесса компилятора стоящего за  установлением принадлежности к декларации в случаях, когда она распространяется не через менеджер `@types`. Прежде всего компилятор ищет в файле `package.json` свойство `types` и при его отсутствии или пустом значении `“”` переходит к поиску файла `index.d.ts` в корне директории. Если свойство `types` ссылается на конкретную декларацию, то точкой входа считается она. В противном случае файл `index.d.ts`. Стоит учесть, что при разработке будет возможно только взаимодействовать с модулями подключенными к точке входа. Кроме того, ограничить область видимости можно при помощи конструкций объявленных при помощи ключевых слов `module` или `namespace`. Единственное о чем сейчас стоит упомянуть, что области определяемые обеими конструкциями нужно расценивать как обычные модули, поскольку они могут включать только одно объявление экспорта по умолчанию (`export default`).\n\nЕсли не уделить должного внимания области видимости при создании деклараций для подключаемых библиотек у разработчиков которые будут использовать подобные декларации с другими декларациями имеющими идентичное определение, могут возникнуть ошибки на этапе компиляции. Решений у этой проблемы всего два — сокрытие определений и уточнение определений. Способ к которому стоит прибегнуть зависит от вида разрабатываемой библиотеки."},{"key":"Декларации_5","elementId":"Deklaracii_dlya_bibliotek_s_odnoi_tochkoi_vhoda","markdown":"## Декларации для библиотек с одной точкой входа\n\nВ проекте созданном в теме посвященной настройке рабочего пространства, в директории `src` создайте две точки входа, одну для разработки `index.js`, а другую для _prod-версии_, имя которой должно соответствовать имени библиотеки, в нашем случае это будет `index.lib.ts`.\n\nПо умолчанию точкой входа, как _npm_ пакета, так и декларации, является файл с именем `index`. Поэтому, если в проект библиотеки имеет несколько точек входа, то важно не забыть указать имя файла с помощью свойства `types` `package.json`. Если для сборки используется _webpack_, то будет значительно проще изменить имя на `index` во время компиляции.\n\nКроме того, создайте два файла: `IAnimal.ts` и `Zoo.ts`. Также в директории `/src` создайте директорию `/animal`, в которой будут размещены два файла: `Bird.ts` и `Fish.ts`. В итоге должна получится следующая структура:\n\n`````ts\n* /\n   * src\n      * utils\n         * string-util.ts\n      * animal\n         * Bird.ts\n         * Fish.ts\n      * IAnimal.ts\n      * Zoo.ts\n      * index.js\n      * index.lib.ts\n      * tsconfig.prod.ts\n`````\n\n`````ts\n// Файл IAnimal.ts\n\n\nexport interface IAnimal {\n name: string;\n}\n`````\n\n`````ts\n// Файл utils/string-util.ts\n\n\nexport function toString( text: string ): string {\n  return `[object ${ text }]`;\n}\n`````\n\n`````ts\n// Файл animals/Bird.ts\n\n\nimport { IAnimal } from \"../IAnimal\";\nimport * as StringUtil from \"../utils/string-util\"\n\nexport default class Bird implements IAnimal {\n  constructor(readonly name: string) {};\n\n  public toString(): string {\n      return StringUtil.toString(this.constructor.name);\n  }\n}\n`````\n\n`````ts\n// Файл animals/Fish.ts\n\n\nimport { IAnimal } from \"../IAnimal\";\nimport * as StringUtil from \"../utils/string-util\"\n\nexport default class Fish implements IAnimal {\n  constructor(readonly name: string) {};\n\n  public toString(): string {\n      return StringUtil.toString(this.constructor.name);\n  }\n}\n`````\n\n`````ts\n// Файл Zoo.ts\n\n\nimport { IAnimal } from \"./IAnimal\";\n\nexport default class Zoo {\n private animalAll: IAnimal[ ] = [ ];\n\n public get length(): number {\n     return this.animalAll.length;\n }\n\n public add(animal: IAnimal): void {\n     this.animalAll.push(animal);\n }\n public getAnimalByIndex(index: number): IAnimal {\n     return this.animalAll[index];\n }\n}\n`````\n\n`````ts\n// Файл index.js\n\n\nimport Bird from \"./animals/Bird\";\nimport Fish from \"./animals/Fish\";\n\nimport Zoo from './Zoo';\n\n\nconst zoo: Zoo = new Zoo();\n\nzoo.add( new Bird('raven') );\nzoo.add( new Fish('shark') );\n\nfor( let i = 0; i \u003c zoo.length; i++ ){\n console.log( `Animal name: ${ zoo.getAnimalByIndex(i).name }.` );\n}\n`````\n\n`````ts\n// Файл index.lib.ts\n\n\n/** imports */\n\nimport { IAnimal } from \"./IAnimal\";\nimport ZooCollection from './Zoo';\n\n/** re-exports */\n\nexport {IAnimal} from './IAnimal'; // type\n\nexport {default as Bird} from './animals/Bird'; // type\nexport {default as Fish} from './animals/Fish'; // type\n\nexport {default as Zoo} from './Zoo'; // type\n\nexport const zoo: Zoo = new Zoo(); // instance\n`````\n\nВ коде нет ничего необычного, поэтому комментариев не будет. Если кому-то содержимое файла `index.lib.ts` показалось необычным, то стоит отметить, что это обычный ре-экспорт модулей _JavaScript_, который никакого отношения к _TypeScript_ не имеет. Повторю, файл `index.lib.ts` является точкой входа создаваемой библиотеки, поэтому он должен экспортировать все то, что может потребоваться при работе с ней. Конкретно в этом случае экспортировать _utils_ наружу не предполагается, поэтому они не были реэкспортированы.\n\nТакже стоит обратить внимание на конфигурационные файлы _TypeScript_, которые взаимно добавляют точки входа друг друга в исключение. Кроме того, конфигурационный файл _dev-сборки_ исключает также конфигурационный файл _prod-сборки_.\n\n`````ts\n// Файл /src/tsconfig.prod.json\n\n\n{\n   \"compilerOptions\": {\n     \"target\": \"es6\",\n     \"module\": \"umd\",\n     \"rootDir\": \"./\",\n     \"declaration\": true\n   },\n   \"exclude\": [\n     \"/node_modules\",\n     \"./index.js\"\n   ]\n }\n`````\n\n`````ts\n//  Файл /tsconfig.json\n\n\n{\n\"compilerOptions\": {\n  \"target\": \"es6\",\n  \"module\": \"umd\",\n  \"rootDir\": \"./src\"\n},\n\"exclude\": [\n  \"/node_modules\",\n  \"./src/index.lib.ts\",\n  \"./src/tsconfig.prod.json\"\n]\n}\n`````\n\n`````ts\n// Файл package.json\n\n\n{\n\"name\": \"zoo\",\n\"version\": \"1.0.0\",\n\"description\": \"\",\n\"main\": \"index.js\",\n\"scripts\": {\n  \"build\": \"./node_modules/.bin/tsc --project ./tsconfig.json --watch\",\n  \"build:prod\": \"./node_modules/.bin/tsc --project ./src/tsconfig.prod.json\"\n},\n\"author\": \"\",\n\"license\": \"ISC\",\n\"devDependencies\": {\n  \"typescript\": \"^2.5.2\"\n}\n}\n`````\n\nОсталось только запустить _prod-сборку_ и если все было сделано правильно, в директории _dist_ появятся скомпилированные файлы с расширением `.js` (конечный код) и `.d.ts` (представляющие декларации необходимые для работы как самого компилятора _TypeScript_, так и автодополнения _ide_).\n\n`````ts\n// Файл IAnimal.d.ts\n\n\nexport interface IAnimal {\n  name: string;\n}\n`````\n\n`````ts\n// Файл utils/string-util.d.ts\n\n\nexport declare function toString(text: string): string;\n`````\n\n`````ts\n// Файл animals/Bird.d.ts\n\n\nimport { IAnimal } from \"../IAnimal\";\nexport default class Bird implements IAnimal {\n  readonly name: string;\n  constructor(name: string);\n  toString(): string;\n}\n`````\n\n`````ts\n// Файл animals/Fish.d.ts\n\n\nimport { IAnimal } from \"../IAnimal\";\nexport default class Fish implements IAnimal {\n  readonly name: string;\n  constructor(name: string);\n  toString(): string;\n}\n`````\n\n`````ts\n// Файл Zoo.d.ts\n\n\nimport { IAnimal } from \"./IAnimal\";\nexport default class Zoo {\n  private animalAll;\n  readonly length: number;\n  add(animal: IAnimal): void;\n  getAnimalByIndex(index: number): IAnimal;\n}\n`````\n\n`````ts\n// Файл index.d.ts\n\n\nimport Zoo from './Zoo';\n/** re-exports */\nexport { IAnimal } from './IAnimal';\nexport { default as Bird } from './animals/Bird';\nexport { default as Fish } from './animals/Fish';\nexport { default as Zoo } from './Zoo';\n/** exports */\nexport declare const zoo: Zoo;\n`````\n\nТакже стоит сказать, что сгенерированная декларация не может рассматриваться как единоверная. Очень часто можно увидеть декларации собранные в одном файле и сгруппированные по логическим признакам с помощью `namespace` или так называемых `ghost module`.\n\n`````ts\n/**ghost module */\n\ndeclare module Zoo {\n  interface IAnimal {\n      name: string;\n  }\n\n  class Bird implements IAnimal {\n      readonly name: string;\n      constructor(name: string);\n      toString(): string;\n  }\n  class Fish implements IAnimal {\n      readonly name: string;\n      constructor(name: string);\n      toString(): string;\n  }\n\n  class Zoo {\n      private animalAll;\n      readonly length: number;\n      add(animal: IAnimal): void;\n      getAnimalByIndex(index: number): IAnimal;\n  }\n\n  const zoo: Zoo;\n}\n`````\n\n`````ts\n/** module */\n\ndeclare module \"zoo\" {\n  export = Zoo;\n}\n`````\n\nСудить, какой из этих вариантов лучше, я не возьмусь, так как на мой взгляд, в данный момент, они оба не являются исчерпывающими. Возможно в будущем появятся новые правила для создания деклараций или редакторы будут по другому обрабатывать эти.\n\nТакже стоит обратить внимание, что в случае компиляции при помощи _tsc_, если в конечной директории присутствуют файлы, чьи имена совпадают с именами генерируемых при компиляции файлов, несмотря на их замену, ошибка все равно возникнет. Другими словами, если процесс сборки запускается не в первый раз, то нужно удалить файлы оставшиеся от предыдущей компиляции."},{"key":"Декларации_6","elementId":"Deklaracii_dlya_bibliotek_s_mnojestvom_tochek_vhoda","markdown":"## Декларации для библиотек с множеством точек входа\n\nПри разработке библиотеки имеющий множество самостоятельных частей более разумно создавать каждую часть в виде отдельной точки входа. Это позволит использующим её приложениям за счет подключения только необходимых частей минимизировать вес конечной сборки, что становится возможно благодаря механизму _Tree Shaking_.\n\nДля этого рассмотрим проект состоящий из самодостаточного модуля `bird.ts`, который делает ре-экспорт модуля `Raven.ts`, а также самодостаточного модуля `fish.ts` реэкспортирующего модуль `Shark.ts`. Кроме этого оба модуля доступны в точке входа `index.lib.ts`.\n\n`````ts\n* /\n   * src/\n      * to-string-decorate.ts\n      * to-error-decorate.ts\n      * index.lib.ts\n`````\n\nСтоит сказать, что конфигурационные файлы ничем не отличаются от рассмотренных в теме создания деклараций для библиотек с одной точкой входа, поэтому их описание будет опущено.\n\n`````ts\n// Файл to-string-decorate.ts\n\n\nexport function toStringDecorate( type: string ): string {\n  return `[object ${ type }]`;\n}\n`````\n\n`````ts\n//Файл to-error-decorate.ts\n\n\nexport function toErrorDecorate( message: string, id: number = 0 ): string {\n  return `error:${ id === 0 ? '' : id }, ${ message }.`;\n}\n`````\n\n`````ts\n// Файл index.lib.ts\n\n\n/** re-export */\n\nexport {toStringDecorate} from './to-string-decorate';\nexport {toErrorDecorate} from './to-error-decorate';\n`````\n\nПосле компиляции проекта в директорию _dist_ сгенерируются следующие файлы -\n\n`````ts\n// Файл to-string-decorate.d.ts\n\n\nexport declare function toStringDecorate(type: string): string;\n`````\n\n`````ts\n// Файл to-error-decorate.d.ts\n\n\nexport declare function toErrorDecorate(message: string, id?: number): string;\n`````\n\n`````ts\n// Файл index.d.ts\n\n\n/** re-export */\n\nexport {toStringDecorate} from './to-string-decorate';\nexport {toErrorDecorate} from './to-error-decorate';\n`````\n\nСразу следует сказать, что с подобным описанием декларация не будет правильно функционировать, поэтому её придется подправить руками до следующего вида.\n\n`````ts\n// Файл to-string-decorate.d.ts\n\n\nexport declare function toStringDecorate(type: string): string;\n\nexport as namespace stringDecorate;\n`````\n\n`````ts\n// Файл to-error-decorate.d.ts\n\n\nexport declare function toErrorDecorate(message: string, id?: number): string;\n\nexport as namespace errorDecorate;\n`````\n\n`````ts\n// Файл index.d.ts\n\n\n/// \u003creference path=\"./to-string-decorate.d.ts\" /\u003e\n/// \u003creference path=\"./to-error-decorate.d.ts\" /\u003e\n\ndeclare module \"zoo\" {\n  export default {stringDecorate, errorDecorate};\n}\n`````\n\nОбычно, как отдельную часть принято экспортировать только самодостаточные модули, такие как функции или классы. Но кроме того могут потребоваться объекты содержащие константы или, что-то незначительное, без чего отдельный модуль не сможет функционировать. Если такие объекты используются всеми самостоятельными модулями, то их можно также вынести в отдельный самостоятельный модуль. В случае, когда самодостаточному модулю для полноценной работы требуются зависимости, которые больше никем не используются, то такой модуль нужно оформлять так же, как обычную точку входа. Другими словами он должен содержать ре-экспорт всего необходимого. А кроме того экспортировать все как глобальный `namespace` с помощью синтаксиса:\n\n`````ts\nexport as namespace identifier\n`````\n\nДанный синтаксис объединяет все объявленные экспорты в глобальное пространство имен с указанным идентификатором. Затем объявленные пространства имен нужно импортировать в точку входа с помощью директивы с тройным слешем `/// \u003creference path=””/\u003e`, после чего экспортировать из объявленного модуля."},{"key":"Декларации_7","elementId":"Sozdanie_deklaracii_vruchnuu","markdown":"## Создание деклараций вручную\n\nОписывать незначительные декларации самостоятельно (вручную) приходится довольно часто. Потребность возникает при необходимости задекларировать импортируемые файлами `.ts` нестандартные для него расширения файлов. Дело в том, что компилятор _TypeScript_ понимает только импорт расширения `.ts`/`.tsx`/`.d.ts`/`.json`, а с активной опцией `--allowJS`, еще и `.js`/`.jsx`. Но работая с таким сборщиком как в _webpack_ или используя _css-in-js_, придется импортировать в код файлы с таким расширением, как `.html`, `.css`, и т.д. В таких случаях приходится создавать декларации файлов вручную.\n\nСамостоятельно объявление деклараций начинается с создания директории предназначенной для их хранения. В нашем случае это будет директория _types_ расположенная в корне проекта. Декларации можно складывать прямо в неё, но будет правильно считается создавать под каждую декларацию отдельную поддиректорию носящую имя модуля нуждающегося в ней. Поэтому создадим поддиректорию с именем `/css`, а уже в ней создадим файл `index.d.ts`. Откроем этот файл и напишем в нем декларацию определяющую расширение `.css`.\n\n`````ts\n// Файл ./types/css/index.d.ts\n\n\ndeclare module \"*.css\" {\n  const content: any;\n  export default content;\n}\n`````\n\nВ тех случаях, когда модуль определяет тип `any`, более уместно использовать при объявлении сокращенный вариант, который предполагает тип `any`.\n\n`````ts\ndeclare module \"*.css\";\n`````\n\nОсталось только подключить декларацию в конфигурационном файле и ошибок при импорте расширения `.css` не возникнет.\n\n`````ts\n// Файл tsconfig.json\n\n\n{\n  \"compilerOptions\": {\n      \"target\": \"es2015\",\n      \"module\": \"none\",\n      \"rootDir\": \"./src\",\n      \"typeRoots\": [\n          \"./types\"\n      ]\n  },\n  \"exclude\": [\n      \"./node_modules\"\n  ]\n}\n`````\n\nБудет не лишним упомянуть, что самостоятельное создание деклараций, помимо нестандартных расширений, также часто требуется при необходимости расширения типов описывающих внешние библиотеки. Например, если при работе с библиотекой _React_ возникнет необходимость в использовании пользовательских свойств определенных спецификацией _html_, то придется расширять объявляемый в её модуле тип `HTMLAttributes`."},{"key":"Декларации_8","elementId":"Direktiva_s_troinym_sleshem_(triple-slash_directives)","markdown":"## Директива с тройным слешем (triple-slash directives)\n\nДо этого момента было рассмотрено создание библиотек представленных одним или больше количеством самостоятельных модулей. Акцент в этом предложении необходимо сделать на слове _самостоятельных_, поскольку они не были зависимы от каких-либо других модулей (деклараций). Если разрабатываемая библиотека представляет из себя множество зависящих друг от друга модулей или она зависит от деклараций устанавливаемых с помощью директивы `@types`, то генерируемые декларации также будут нуждаться в зависимостях. Для этих случаев существует директива `/// \u003creference types=””/\u003e`. Данная директива указывается в начале файла и предназначена для подключения деклараций, путь до которых указывается с помощью атрибута `types`.\n\n`````ts\n/// \u003creference types=\"react\" /\u003e\n`````\n\nКроме того, с помощью данной директивы можно указать версию используемой библиотеки.\n\n`````ts\n/// \u003creference lib=\"es2015\" /\u003e\n`````\n\nПодобный функционал будет полезен разработчикам деклараций `.d.ts`, которые зависят от конкретной версии _ECMAScript_."},{"key":"Декларации_9","elementId":"Importirovanie_deklaracii_(import)","markdown":"## Импортирование декларации (import)\n\nПомимо типов, описанных в глобальных декларациях, в аннотациях типов также можно использовать типы из деклараций импортированных с помощью директивы `import`.\n\n`````ts\n// file declaration-excluded-from-global-scope/animal.d.ts\n\nexport declare interface IAnimal {\n  type: string;\n}\n`````\n\n`````ts\n// file src/index.js\n\nimport * as DTS from \"declaration-excluded-from-global-scope/animal\";\n\n// импорт декларации на уровне модуля\n\nlet v0: DTS.IAnimal = { type: '' }; // Ok\nlet v1: DTS.IAnimal = { type: 5 }; // Error\n\n\n// инлайн импорт\n\nlet v2: import('declaration-excluded-from-global-scope/animal').IAnimal = { type: '' }; // Ok\nlet v3: import('declaration-excluded-from-global-scope/animal').IAnimal = { type: 5 }; // Error\n`````\n\nЭтот механизм также позволяет указывать аннотацию типов непосредственно в файлах с расширением `.js`.\n\n`````ts\n// file declaration-excluded-from-global-scope/animal.d.ts\n\nexport declare interface IAnimal {\n  type: string;\n}\n`````\n\n`````ts\n// file lib/index.js\n\n/**\n*\n* @param {import(\"./declaration-excluded-from-global-scope/animal\").IAnimal} animal\n*/\nexport function printAnimalInfo(animal){ animal.type; // autocomplete }\n`````\n\n`````ts\n// file src/index.js\n\nimport * as AnimalUtils from \"lib/index.js\";\n\n\nAnimalUtils.printAnimalInfo( { type: '' } ); // Ok\nAnimalUtils.printAnimalInfo( { type: 5 } ); // Error\n`````"}],"githubFileInfo":{"lastUpdate":1633879471000,"contributorAll":[{"name":"nauchikus","avatar":"https://avatars.githubusercontent.com/u/31518738?v=4","bio":"@TechnoFanatic(\"🍬\")\r\n","githubUrl":"https://github.com/nauchikus"}]},"pageNav":{"isPrevPage":true,"isNextPage":true,"prevPage":{"title":"Сборка с использованием ссылок на проекты","path":"Sborka_s_ispolzovaniem_ssylok_na_proekty"},"nextPage":{"title":"Публикация TypeScript","path":"Publikaciya_TypeScript"}},"contentNavData":{"key":"Декларации","level":0,"index":60,"contentIndex":0,"section":"Сборка","title":"Декларации","path":"Deklaracii","elementId":"Deklaracii","children":[{"key":"Декларации_0","index":0,"contentIndex":1,"level":1,"section":"Сборка","title":"Что такое декларация (Declaration)","path":"Chto_takoe_deklaraciya_(Declaration)","elementId":"Chto_takoe_deklaraciya_(Declaration)"},{"key":"Декларации_1","index":1,"contentIndex":2,"level":1,"section":"Сборка","title":"Установка деклараций с помощью @types","path":"Ustanovka_deklaracii_s_pomoshchu_@types","elementId":"Ustanovka_deklaracii_s_pomoshchu_@types"},{"key":"Декларации_2","index":2,"contentIndex":3,"level":1,"section":"Сборка","title":"Подготовка к созданию декларации","path":"Podgotovka_k_sozdaniu_deklaracii","elementId":"Podgotovka_k_sozdaniu_deklaracii"},{"key":"Декларации_3","index":3,"contentIndex":4,"level":1,"section":"Сборка","title":"Разновидности деклараций","path":"Raznovidnosti_deklaracii","elementId":"Raznovidnosti_deklaracii"},{"key":"Декларации_4","index":4,"contentIndex":5,"level":1,"section":"Сборка","title":"Декларации и область видимости","path":"Deklaracii_i_oblast_vidimosti","elementId":"Deklaracii_i_oblast_vidimosti"},{"key":"Декларации_5","index":5,"contentIndex":6,"level":1,"section":"Сборка","title":"Декларации для библиотек с одной точкой входа","path":"Deklaracii_dlya_bibliotek_s_odnoi_tochkoi_vhoda","elementId":"Deklaracii_dlya_bibliotek_s_odnoi_tochkoi_vhoda"},{"key":"Декларации_6","index":6,"contentIndex":7,"level":1,"section":"Сборка","title":"Декларации для библиотек с множеством точек входа","path":"Deklaracii_dlya_bibliotek_s_mnojestvom_tochek_vhoda","elementId":"Deklaracii_dlya_bibliotek_s_mnojestvom_tochek_vhoda"},{"key":"Декларации_7","index":7,"contentIndex":8,"level":1,"section":"Сборка","title":"Создание деклараций вручную","path":"Sozdanie_deklaracii_vruchnuu","elementId":"Sozdanie_deklaracii_vruchnuu"},{"key":"Декларации_8","index":8,"contentIndex":9,"level":1,"section":"Сборка","title":"Директива с тройным слешем (triple-slash directives)","path":"Direktiva_s_troinym_sleshem_(triple-slash_directives)","elementId":"Direktiva_s_troinym_sleshem_(triple-slash_directives)"},{"key":"Декларации_9","index":9,"contentIndex":10,"level":1,"section":"Сборка","title":"Импортирование декларации (import)","path":"Importirovanie_deklaracii_(import)","elementId":"Importirovanie_deklaracii_(import)"}]}},"__N_SSG":true},"page":"/book/chapters/[chapterId]","query":{"chapterId":"Deklaracii"},"buildId":"cbe9-89I59uFf1Y2O6Od-","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>